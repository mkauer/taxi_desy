(function(a){if(typeof define==="function"&&define.amd){define(["JSRootCore","d3"],a)}else{if(typeof exports==="object"&&typeof module!=="undefined"){var b=require("./JSRootCore.js");a(b,require("./d3.min.js"));if(b.nodejs){b.Painter.readStyleFromURL("?interactive=0&tooltip=0&nomenu&noprogress&notouch&toolbar=0&webgl=0")}}else{if(typeof JSROOT=="undefined"){throw new Error("JSROOT is not defined","JSRootPainter.js")}if(typeof d3!="object"){throw new Error("d3 is not defined","JSRootPainter.js")}if(typeof JSROOT.Painter=="object"){throw new Error("JSROOT.Painter already defined","JSRootPainter.js")}a(JSROOT,d3)}}}(function(a,b){a.sources.push("2d");if(typeof define==="function"&&define.amd){a.loadScript("$$$style/JSRootPainter.css")}a.DrawFuncs={lst:[],cache:{}};a.addDrawFunc=function(c,d,e){if((arguments.length==1)&&(typeof arguments[0]=="object")){a.DrawFuncs.lst.push(arguments[0]);return arguments[0]}var f={name:c,func:d,opt:e};a.DrawFuncs.lst.push(f);return f};a.ToolbarIcons={camera:{path:"M 152.00,304.00c0.00,57.438, 46.562,104.00, 104.00,104.00s 104.00-46.562, 104.00-104.00s-46.562-104.00-104.00-104.00S 152.00,246.562, 152.00,304.00z M 480.00,128.00L 368.00,128.00 c-8.00-32.00-16.00-64.00-48.00-64.00L 192.00,64.00 c-32.00,0.00-40.00,32.00-48.00,64.00L 32.00,128.00 c-17.60,0.00-32.00,14.40-32.00,32.00l0.00,288.00 c0.00,17.60, 14.40,32.00, 32.00,32.00l 448.00,0.00 c 17.60,0.00, 32.00-14.40, 32.00-32.00L 512.00,160.00 C 512.00,142.40, 497.60,128.00, 480.00,128.00z M 256.00,446.00c-78.425,0.00-142.00-63.574-142.00-142.00c0.00-78.425, 63.575-142.00, 142.00-142.00c 78.426,0.00, 142.00,63.575, 142.00,142.00 C 398.00,382.426, 334.427,446.00, 256.00,446.00z M 480.00,224.00l-64.00,0.00 l0.00-32.00 l 64.00,0.00 L 480.00,224.00 z"},disk:{path:"M384,0H128H32C14.336,0,0,14.336,0,32v448c0,17.656,14.336,32,32,32h448c17.656,0,32-14.344,32-32V96L416,0H384z M352,160   V32h32v128c0,17.664-14.344,32-32,32H160c-17.664,0-32-14.336-32-32V32h128v128H352z M96,288c0-17.656,14.336-32,32-32h256   c17.656,0,32,14.344,32,32v192H96V288z"},question:{path:"M256,512c141.375,0,256-114.625,256-256S397.375,0,256,0S0,114.625,0,256S114.625,512,256,512z M256,64   c63.719,0,128,36.484,128,118.016c0,47.453-23.531,84.516-69.891,110.016C300.672,299.422,288,314.047,288,320   c0,17.656-14.344,32-32,32c-17.664,0-32-14.344-32-32c0-40.609,37.25-71.938,59.266-84.031   C315.625,218.109,320,198.656,320,182.016C320,135.008,279.906,128,256,128c-30.812,0-64,20.227-64,64.672   c0,17.664-14.336,32-32,32s-32-14.336-32-32C128,109.086,193.953,64,256,64z M256,449.406c-18.211,0-32.961-14.75-32.961-32.969   c0-18.188,14.75-32.953,32.961-32.953c18.219,0,32.969,14.766,32.969,32.953C288.969,434.656,274.219,449.406,256,449.406z"},undo:{path:"M450.159,48.042c8.791,9.032,16.983,18.898,24.59,29.604c7.594,10.706,14.146,22.207,19.668,34.489  c5.509,12.296,9.82,25.269,12.92,38.938c3.113,13.669,4.663,27.834,4.663,42.499c0,14.256-1.511,28.863-4.532,43.822  c-3.009,14.952-7.997,30.217-14.953,45.795c-6.955,15.577-16.202,31.52-27.755,47.826s-25.88,32.9-42.942,49.807  c-5.51,5.444-11.787,11.67-18.834,18.651c-7.033,6.98-14.496,14.366-22.39,22.168c-7.88,7.802-15.955,15.825-24.187,24.069  c-8.258,8.231-16.333,16.203-24.252,23.888c-18.3,18.13-37.354,37.016-57.191,56.65l-56.84-57.445  c19.596-19.472,38.54-38.279,56.84-56.41c7.75-7.685,15.772-15.604,24.108-23.757s16.438-16.163,24.33-24.057  c7.894-7.893,15.356-15.33,22.402-22.312c7.034-6.98,13.312-13.193,18.821-18.651c22.351-22.402,39.165-44.648,50.471-66.738  c11.279-22.09,16.932-43.567,16.932-64.446c0-15.785-3.217-31.005-9.638-45.671c-6.422-14.665-16.229-28.504-29.437-41.529  c-3.282-3.282-7.358-6.395-12.217-9.325c-4.871-2.938-10.381-5.503-16.516-7.697c-6.121-2.201-12.815-3.992-20.058-5.373  c-7.242-1.374-14.9-2.064-23.002-2.064c-8.218,0-16.802,0.834-25.788,2.507c-8.961,1.674-18.053,4.429-27.222,8.271  c-9.189,3.842-18.456,8.869-27.808,15.089c-9.358,6.219-18.521,13.819-27.502,22.793l-59.92,60.271l93.797,94.058H0V40.91  l93.27,91.597l60.181-60.532c13.376-15.018,27.222-27.248,41.536-36.697c14.308-9.443,28.608-16.776,42.89-21.992  c14.288-5.223,28.505-8.74,42.623-10.557C294.645,0.905,308.189,0,321.162,0c13.429,0,26.389,1.185,38.84,3.562  c12.478,2.377,24.2,5.718,35.192,10.029c11.006,4.311,21.126,9.404,30.374,15.265C434.79,34.724,442.995,41.119,450.159,48.042z"},arrow_right:{path:"M30.796,226.318h377.533L294.938,339.682c-11.899,11.906-11.899,31.184,0,43.084c11.887,11.899,31.19,11.893,43.077,0  l165.393-165.386c5.725-5.712,8.924-13.453,8.924-21.539c0-8.092-3.213-15.84-8.924-21.551L338.016,8.925  C332.065,2.975,324.278,0,316.478,0c-7.802,0-15.603,2.968-21.539,8.918c-11.899,11.906-11.899,31.184,0,43.084l113.391,113.384  H30.796c-16.822,0-30.463,13.645-30.463,30.463C0.333,212.674,13.974,226.318,30.796,226.318z"},arrow_up:{path:"M295.505,629.446V135.957l148.193,148.206c15.555,15.559,40.753,15.559,56.308,0c15.555-15.538,15.546-40.767,0-56.304  L283.83,11.662C276.372,4.204,266.236,0,255.68,0c-10.568,0-20.705,4.204-28.172,11.662L11.333,227.859  c-7.777,7.777-11.666,17.965-11.666,28.158c0,10.192,3.88,20.385,11.657,28.158c15.563,15.555,40.762,15.555,56.317,0  l148.201-148.219v493.489c0,21.993,17.837,39.82,39.82,39.82C277.669,669.267,295.505,651.439,295.505,629.446z"},arrow_diag:{path:"M279.875,511.994c-1.292,0-2.607-0.102-3.924-0.312c-10.944-1.771-19.333-10.676-20.457-21.71L233.97,278.348  L22.345,256.823c-11.029-1.119-19.928-9.51-21.698-20.461c-1.776-10.944,4.031-21.716,14.145-26.262L477.792,2.149  c9.282-4.163,20.167-2.165,27.355,5.024c7.201,7.189,9.199,18.086,5.024,27.356L302.22,497.527  C298.224,506.426,289.397,511.994,279.875,511.994z M118.277,217.332l140.534,14.294c11.567,1.178,20.718,10.335,21.878,21.896  l14.294,140.519l144.09-320.792L118.277,217.332z"},auto_zoom:{path:"M505.441,242.47l-78.303-78.291c-9.18-9.177-24.048-9.171-33.216,0c-9.169,9.172-9.169,24.045,0.006,33.217l38.193,38.188  H280.088V80.194l38.188,38.199c4.587,4.584,10.596,6.881,16.605,6.881c6.003,0,12.018-2.297,16.605-6.875  c9.174-9.172,9.174-24.039,0.011-33.217L273.219,6.881C268.803,2.471,262.834,0,256.596,0c-6.229,0-12.202,2.471-16.605,6.881  l-78.296,78.302c-9.178,9.172-9.178,24.045,0,33.217c9.177,9.171,24.051,9.171,33.21,0l38.205-38.205v155.4H80.521l38.2-38.188  c9.177-9.171,9.177-24.039,0.005-33.216c-9.171-9.172-24.039-9.178-33.216,0L7.208,242.464c-4.404,4.403-6.881,10.381-6.881,16.611  c0,6.227,2.477,12.207,6.881,16.61l78.302,78.291c4.587,4.581,10.599,6.875,16.605,6.875c6.006,0,12.023-2.294,16.61-6.881  c9.172-9.174,9.172-24.036-0.005-33.211l-38.205-38.199h152.593v152.063l-38.199-38.211c-9.171-9.18-24.039-9.18-33.216-0.022  c-9.178,9.18-9.178,24.059-0.006,33.222l78.284,78.302c4.41,4.404,10.382,6.881,16.611,6.881c6.233,0,12.208-2.477,16.611-6.881  l78.302-78.296c9.181-9.18,9.181-24.048,0-33.205c-9.174-9.174-24.054-9.174-33.21,0l-38.199,38.188v-152.04h152.051l-38.205,38.199  c-9.18,9.175-9.18,24.037-0.005,33.211c4.587,4.587,10.596,6.881,16.604,6.881c6.01,0,12.024-2.294,16.605-6.875l78.303-78.285  c4.403-4.403,6.887-10.378,6.887-16.611C512.328,252.851,509.845,246.873,505.441,242.47z"},statbox:{path:"M28.782,56.902H483.88c15.707,0,28.451-12.74,28.451-28.451C512.331,12.741,499.599,0,483.885,0H28.782   C13.074,0,0.331,12.741,0.331,28.451C0.331,44.162,13.074,56.902,28.782,56.902zM483.885,136.845H28.782c-15.708,0-28.451,12.741-28.451,28.451c0,15.711,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.74,28.451-28.451C512.331,149.586,499.599,136.845,483.885,136.845zM483.885,273.275H28.782c-15.708,0-28.451,12.731-28.451,28.452c0,15.707,12.744,28.451,28.451,28.451H483.88   c15.707,0,28.451-12.744,28.451-28.451C512.337,286.007,499.599,273.275,483.885,273.275zM256.065,409.704H30.492c-15.708,0-28.451,12.731-28.451,28.451c0,15.707,12.744,28.451,28.451,28.451h225.585   c15.707,0,28.451-12.744,28.451-28.451C284.516,422.436,271.785,409.704,256.065,409.704z"},circle:{path:"M256,256 m-150,0 a150,150 0 1,0 300,0 a150,150 0 1,0 -300,0"},three_circles:{path:"M256,85 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,255 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0  M256,425 m-70,0 a70,70 0 1,0 140,0 a70,70 0 1,0 -140,0 "},diamand:{path:"M256,0L384,256L256,511L128,256z"},rect:{path:"M80,80h352v352h-352z"},CreateSVG:function(f,e,d,h){var c=f.append("svg:svg").attr("class","svg_toolbar_btn").attr("width",d+"px").attr("height",d+"px").attr("viewBox","0 0 512 512").style("overflow","hidden");if("recs" in e){var g={};for(var i=0;i<e.recs.length;++i){a.extend(g,e.recs[i]);c.append("rect").attr("x",g.x).attr("y",g.y).attr("width",g.w).attr("height",g.h).attr("fill",g.f)}}else{c.append("svg:path").attr("d",e.path)}c.append("svg:rect").attr("x",0).attr("y",0).attr("width",512).attr("height",512).style("opacity",0).style("fill","none").style("pointer-events","visibleFill").append("svg:title").text(h);return c}};a.DrawOptions=function(c){this.opt=c&&(typeof c=="string")?c.toUpperCase().trim():"";this.part=""};a.DrawOptions.prototype.empty=function(){return this.opt.length===0};a.DrawOptions.prototype.check=function(d,c){var f=this.opt.indexOf(d);if(f<0){return false}this.opt=this.opt.substr(0,f)+this.opt.substr(f+d.length);this.part="";if(!c){return true}var e=f;while((e<this.opt.length)&&(this.opt[e]!==" ")&&(this.opt[e]!==",")&&(this.opt[e]!==";")){e++}if(e>f){this.part=this.opt.substr(f,e-f);this.opt=this.opt.substr(0,f)+this.opt.substr(e)}return true};a.DrawOptions.prototype.partAsInt=function(e,c){var d=this.part.replace(/^\D+/g,"");d=d?parseInt(d,10):Number.NaN;return isNaN(d)?(c||0):d+(e||0)};a.Painter={};a.Painter.createMenu=function(c,d){document.body.style.cursor="wait";a.AssertPrerequisites("jq2d",function(){document.body.style.cursor="auto";a.Painter.createMenu(c,d)})};a.Painter.closeMenu=function(d){var c=document.getElementById(d||"root_ctx_menu");if(c){c.parentNode.removeChild(c);return true}return false};a.Painter.readStyleFromURL=function(e){var k=a.GetUrlOption("optimize",e);if(k==""){a.gStyle.OptimizeDraw=2}else{if(k!==null){a.gStyle.OptimizeDraw=parseInt(k);if(isNaN(a.gStyle.OptimizeDraw)){a.gStyle.OptimizeDraw=2}}}var g=a.GetUrlOption("interactive",e);if((g=="")||(g=="1")){g="11111"}else{if(g=="0"){g="00000"}}if((g!==null)&&(g.length==5)){a.gStyle.Tooltip=parseInt(g[0]);a.gStyle.ContextMenu=(g[1]!="0");a.gStyle.Zooming=(g[2]!="0");a.gStyle.MoveResize=(g[3]!="0");a.gStyle.DragAndDrop=(g[4]!="0")}var j=a.GetUrlOption("tooltip",e);if(j!==null){a.gStyle.Tooltip=parseInt(j)}var m=a.GetUrlOption("mathjax",e);if((m!==null)&&(m!="0")){a.gStyle.MathJax=1}if(a.GetUrlOption("nomenu",e)!=null){a.gStyle.ContextMenu=false}if(a.GetUrlOption("noprogress",e)!=null){a.gStyle.ProgressBox=false}if(a.GetUrlOption("notouch",e)!=null){a.touches=false}a.gStyle.fOptStat=a.GetUrlOption("optstat",e,a.gStyle.fOptStat);a.gStyle.fOptFit=a.GetUrlOption("optfit",e,a.gStyle.fOptFit);a.gStyle.fStatFormat=a.GetUrlOption("statfmt",e,a.gStyle.fStatFormat);a.gStyle.fFitFormat=a.GetUrlOption("fitfmt",e,a.gStyle.fFitFormat);var l=a.GetUrlOption("toolbar",e);if(l!==null){if(l==="popup"){a.gStyle.ToolBar="popup"}else{a.gStyle.ToolBar=(l!=="0")&&(l!=="false")}}var f=a.GetUrlOption("palette",e);if(f!==null){f=parseInt(f);if(!isNaN(f)&&(f>0)&&(f<113)){a.gStyle.Palette=f}}var d=a.GetUrlOption("embed3d",e);if(d!==null){a.gStyle.Embed3DinSVG=parseInt(d)}var c=a.GetUrlOption("webgl",e);if((c==="0")||(c==="false")){a.gStyle.NoWebGL=true}else{if(c==="ie"){a.gStyle.NoWebGL=!a.browser.isIE}}var h=a.GetUrlOption("geosegm",e);if(h!==null){a.gStyle.GeoGradPerSegm=Math.max(2,parseInt(h))}var i=a.GetUrlOption("geocomp",e);if(i!==null){a.gStyle.GeoCompressComp=(i!=="0")&&(i!=="false")}};a.Painter.Coord={kCARTESIAN:1,kPOLAR:2,kCYLINDRICAL:3,kSPHERICAL:4,kRAPIDITY:5};a.Painter.root_colors=[];a.Painter.createRootColors=function(){var d=["white","black","red","green","blue","yellow","magenta","cyan","rgb(89,212,84)","rgb(89,84,217)","white"];d[110]="white";var g=[{col:11,str:"c1b7ad4d4d4d6666668080809a9a9ab3b3b3cdcdcde6e6e6f3f3f3cdc8accdc8acc3c0a9bbb6a4b3a697b8a49cae9a8d9c8f83886657b1cfc885c3a48aa9a1839f8daebdc87b8f9a768a926983976e7b857d9ad280809caca6c0d4cf88dfbb88bd9f83c89a7dc08378cf5f61ac8f94a6787b946971d45a549300ff7b00ff6300ff4b00ff3300ff1b00ff0300ff0014ff002cff0044ff005cff0074ff008cff00a4ff00bcff00d4ff00ecff00fffd00ffe500ffcd00ffb500ff9d00ff8500ff6d00ff5500ff3d00ff2600ff0e0aff0022ff003aff0052ff006aff0082ff009aff00b1ff00c9ff00e1ff00f9ff00ffef00ffd700ffbf00ffa700ff8f00ff7700ff6000ff4800ff3000ff1800ff0000"},{col:201,str:"5c5c5c7b7b7bb8b8b8d7d7d78a0f0fb81414ec4848f176760f8a0f14b81448ec4876f1760f0f8a1414b84848ec7676f18a8a0fb8b814ecec48f1f1768a0f8ab814b8ec48ecf176f10f8a8a14b8b848ecec76f1f1"},{col:390,str:"ffffcdffff9acdcd9affff66cdcd669a9a66ffff33cdcd339a9a33666633ffff00cdcd009a9a00666600333300"},{col:406,str:"cdffcd9aff9a9acd9a66ff6666cd66669a6633ff3333cd33339a3333663300ff0000cd00009a00006600003300"},{col:422,str:"cdffff9affff9acdcd66ffff66cdcd669a9a33ffff33cdcd339a9a33666600ffff00cdcd009a9a006666003333"},{col:590,str:"cdcdff9a9aff9a9acd6666ff6666cd66669a3333ff3333cd33339a3333660000ff0000cd00009a000066000033"},{col:606,str:"ffcdffff9affcd9acdff66ffcd66cd9a669aff33ffcd33cd9a339a663366ff00ffcd00cd9a009a660066330033"},{col:622,str:"ffcdcdff9a9acd9a9aff6666cd66669a6666ff3333cd33339a3333663333ff0000cd00009a0000660000330000"},{col:791,str:"ffcd9acd9a669a66339a6600cd9a33ffcd66ff9a00ffcd33cd9a00ffcd00ff9a33cd66006633009a3300cd6633ff9a66ff6600ff6633cd3300ff33009aff3366cd00336600339a0066cd339aff6666ff0066ff3333cd0033ff00cdff9a9acd66669a33669a009acd33cdff669aff00cdff339acd00cdff009affcd66cd9a339a66009a6633cd9a66ffcd00ff6633ffcd00cd9a00ffcd33ff9a00cd66006633009a3333cd6666ff9a00ff9a33ff6600cd3300ff339acdff669acd33669a00339a3366cd669aff0066ff3366ff0033cd0033ff339aff0066cd00336600669a339acd66cdff009aff33cdff009acd00cdffcd9aff9a66cd66339a66009a9a33cdcd66ff9a00ffcd33ff9a00cdcd00ff9a33ff6600cd33006633009a6633cd9a66ff6600ff6633ff3300cd3300ffff339acd00666600339a0033cd3366ff669aff0066ff3366cd0033ff0033ff9acdcd669a9a33669a0066cd339aff66cdff009acd009aff33cdff009a"},{col:920,str:"cdcdcd9a9a9a666666333333"}];for(var f=0;f<g.length;++f){var e=g[f];for(var h=0;h<e.str.length;h+=6){var c=parseInt(e.col)+parseInt(h/6);d[c]="rgb("+parseInt("0x"+e.str.slice(h,h+2))+","+parseInt("0x"+e.str.slice(h+2,h+4))+","+parseInt("0x"+e.str.slice(h+4,h+6))+")"}}a.Painter.root_colors=d};a.Painter.MakeColorRGB=function(d){if((d==null)||(d._typename!="TColor")){return null}var c=Math.round(d.fRed*255)+","+Math.round(d.fGreen*255)+","+Math.round(d.fBlue*255);if((d.fAlpha===undefined)||(d.fAlpha==1)){c="rgb("+c+")"}else{c="rgba("+c+","+d.fAlpha.toFixed(3)+")"}switch(c){case"rgb(255,255,255)":c="white";break;case"rgb(0,0,0)":c="black";break;case"rgb(255,0,0)":c="red";break;case"rgb(0,255,0)":c="green";break;case"rgb(0,0,255)":c="blue";break;case"rgb(255,255,0)":c="yellow";break;case"rgb(255,0,255)":c="magenta";break;case"rgb(0,255,255)":c="cyan";break}return c};a.Painter.adoptRootColors=function(f){if(!f||!f.arr){return}for(var g=0;g<f.arr.length;++g){var e=f.arr[g];if(!e||(e._typename!="TColor")){continue}var d=e.fNumber;if((d<0)||(d>4096)){continue}var c=a.Painter.MakeColorRGB(e);if(c==null){continue}if(a.Painter.root_colors[d]!=c){a.Painter.root_colors[d]=c}}};a.Painter.root_line_styles=["","","3,3","1,2","3,4,1,4","5,3,1,3","5,3,1,3,1,3,1,3","5,5","5,3,1,3,1,3","20,5","20,10,1,10","1,3"];a.Painter.root_markers=[0,100,8,7,0,9,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,103,105,104,0,3,4,2,1,106,6,7,5,102,101];a.Painter.createAttMarker=function(f,d){var e=a.Painter.root_colors[f.fMarkerColor];if(!d||(d<0)){d=f.fMarkerStyle}var c={x0:0,y0:0,color:e,style:d,size:8,scale:1,stroke:true,fill:true,marker:"",ndig:0,used:true,changed:false};c.Change=function(h,k,j){this.changed=true;if(h!==undefined){this.color=h}if((k!==undefined)&&(k>=0)){this.style=k}if(j!==undefined){this.size=j}else{j=this.size}this.x0=this.y0=0;this.reset_pos=function(){this.lastx=this.lasty=null};if((this.style===1)||(this.style===777)){this.fill=false;this.marker="h1";this.size=1;this.create=function(o,t){var r=Math.round(o),s=Math.round(t),q="M"+r+","+s+"h1";var p=(this.lastx===null)?q:("m"+(r-this.lastx)+","+(s-this.lasty)+"h1");this.lastx=r+1;this.lasty=s;return(p.length<q.length)?p:q};this.reset_pos();return true}var l=((this.style>0)&&(this.style<a.Painter.root_markers.length))?a.Painter.root_markers[this.style]:100;var g=l%100;this.fill=(l>=100);switch(this.style){case 1:this.size=1;this.scale=1;break;case 6:this.size=2;this.scale=1;break;case 7:this.size=3;this.scale=1;break;default:this.size=j;this.scale=8}j=this.size*this.scale;this.ndig=(j>7)?0:((j>2)?1:2);if(g==6){this.ndig++}var m=(j/2).toFixed(this.ndig),i=j.toFixed(this.ndig);switch(g){case 0:this.x0=-j/2;this.marker="a"+m+","+m+" 0 1,0 "+i+",0a"+m+","+m+" 0 1,0 -"+i+",0z";break;case 1:var n=(j/3).toFixed(c.ndig);this.x0=this.y0=j/6;this.marker="h"+n+"v-"+n+"h-"+n+"v-"+n+"h-"+n+"v"+n+"h-"+n+"v"+n+"h"+n+"v"+n+"h"+n+"z";break;case 2:this.x0=-j/2;this.marker="l"+m+",-"+m+"l"+m+","+m+"l-"+m+","+m+"z";break;case 3:this.x0=this.y0=-j/2;this.marker="v"+i+"h"+i+"v-"+i+"z";break;case 4:this.y0=j/2;this.marker="l-"+m+",-"+i+"h"+i+"z";break;case 5:this.y0=-j/2;this.marker="l-"+m+","+i+"h"+i+"z";break;case 6:this.y0=-j/2;this.marker="l"+(j/3).toFixed(c.ndig)+","+i+"l-"+(5/6*j).toFixed(c.ndig)+",-"+(5/8*j).toFixed(c.ndig)+"h"+i+"l-"+(5/6*j).toFixed(c.ndig)+","+(5/8*j).toFixed(c.ndig)+"z";break;case 7:this.x0=this.y0=-j/2;this.marker="l"+i+","+i+"m0,-"+i+"l-"+i+","+i+"m0,-"+m+"h"+i+"m-"+m+",-"+m+"v"+i;break;case 8:this.y0=-j/2;this.marker="v"+i+"m-"+m+",-"+m+"h"+i;break;case 9:this.x0=this.y0=-j/2;this.marker="l"+i+","+i+"m0,-"+i+"l-"+i+","+i;break;default:this.x0=-j/2;this.marker="l"+m+",-"+m+"l"+m+","+m+"l-"+m+","+m+"z";break}this.create=function(o,p){return"M"+(o+this.x0).toFixed(this.ndig)+","+(p+this.y0).toFixed(this.ndig)+this.marker};return true};c.Apply=function(g){g.style("stroke",this.stroke?this.color:"none");g.style("fill",this.fill?this.color:"none")};c.func=c.Apply.bind(c);c.Change(e,d,f.fMarkerSize);c.changed=false;return c};a.Painter.createAttLine=function(i,g,f){var e="black",c=0,h=0;if(typeof i=="string"){e=i;if(e!=="none"){c=1}}else{if(typeof i=="object"){if("fLineColor" in i){e=a.Painter.root_colors[i.fLineColor]}if("fLineWidth" in i){c=i.fLineWidth}if("fLineStyle" in i){h=i.fLineStyle}}else{if((i!==undefined)&&!isNaN(i)){e=a.Painter.root_colors[i]}}}if(g!==undefined){c=g}var d={used:true,color:e,width:c,dash:a.Painter.root_line_styles[h]};if(c==0){d.color="none"}if(f){d.excl_side=0;d.excl_width=0;if(Math.abs(d.width)>99){d.excl_side=(d.width<0)?-1:1;d.excl_width=Math.floor(d.width/100)*5;d.width=d.width%100}d.ChangeExcl=function(j,k){if(k!==undefined){this.excl_width=k}if(j!==undefined){this.excl_side=j;if((this.excl_width===0)&&(this.excl_side!==0)){this.excl_width=20}}this.changed=true}}if((d.color===undefined)&&(d.width>0)){d.color="lightgrey"}d.Apply=function(j){this.used=true;if(this.color=="none"){j.style("stroke",null).style("stroke-width",null).style("stroke-dasharray",null)}else{j.style("stroke",this.color).style("stroke-width",this.width);if(this.dash&&(this.dash.length>0)){j.style("stroke-dasharray",this.dash)}}};d.Change=function(j,k,l){if(j!==undefined){this.color=j}if(k!==undefined){this.width=k}if(l!==undefined){this.dash=l}this.changed=true};d.func=d.Apply.bind(d);return d};a.Painter.clearCuts=function(c){var f=c.indexOf("[");var e=c.indexOf("]");if((f>=0)&&(e>=0)&&(f<e)){for(var d=f;d<=e;++d){c[d]=" "}}return c};a.Painter.root_fonts=new Array("Arial","Times New Roman","bTimes New Roman","biTimes New Roman","Arial","oArial","bArial","boArial","Courier New","oCourier New","bCourier New","boCourier New","Symbol","Times New Roman","Wingdings","Symbol","Verdana");a.Painter.getFontDetails=function(f,d){var c={name:"Arial",size:Math.round(d||11),weight:null,style:null},e=a.Painter.root_fonts[Math.floor(f/10)]||"";while(e.length>0){if(e[0]==="b"){c.weight="bold"}else{if(e[0]==="i"){c.style="italic"}else{if(e[0]==="o"){c.style="oblique"}else{break}}}e=e.substr(1)}if(e=="Symbol"){c.weight=c.style=null}c.name=e;c.SetFont=function(g){g.attr("font-family",this.name).attr("font-size",this.size).attr("xml:space","preserve");if(this.weight){g.attr("font-weight",this.weight)}if(this.style){g.attr("font-style",this.style)}};c.asStyle=function(g){return(g?g:this.size)+"px "+this.name};c.stringWidth=function(i,h){var j=i.append("svg:text").attr("xml:space","preserve").style("opacity",0).text(h);this.SetFont(j);var g=j.node().getBBox().width;j.remove();return g};c.func=c.SetFont.bind(c);return c};a.Painter.chooseTimeFormat=function(d,c){if(d<0.5){return c?"%S.%L":"%M:%S.%L"}if(d<30){return c?"%Mm%S":"%H:%M:%S"}d/=60;if(d<30){return c?"%Hh%M":"%d/%m %H:%M"}d/=60;if(d<12){return c?"%d-%Hh":"%d/%m/%y %Hh"}d/=24;if(d<15.218425){return c?"%d/%m":"%d/%m/%y"}d/=30.43685;if(d<6){return"%d/%m/%y"}d/=12;if(d<2){return c?"%m/%y":"%d/%m/%y"}return"%Y"};a.Painter.getTimeFormat=function(c){var d=c.fTimeFormat.indexOf("%F");if(d>=0){return c.fTimeFormat.substr(0,d)}return c.fTimeFormat};a.Painter.getTimeOffset=function(e){var n=e.fTimeFormat.indexOf("%F");if(n<0){return a.gStyle.fTimeOffset*1000}var m=e.fTimeFormat.substr(n+2);if(m.indexOf("1995-01-01 00:00:00s0")==0){return 788918400000}if((m=="0")||(m=="")){return 0}function h(q,p,o){var s=m.indexOf(q);if(s<0){s="";return p}var r=parseInt(m.substr(0,s));m=m.substr(s+1);if(isNaN(r)||(r<p)||(r>o)){s="";return p}return r}var k=h("-",1970,2300),j=h("-",1,12)-1,l=h(" ",1,31),f=h(":",0,23),g=h(":",0,59),i=h("s",0,59),c=h(" ",0,999);var d=new Date(Date.UTC(k,j,l,f,g,i,c));return d.getTime()};a.Painter.superscript_symbols_map={"1":"\xB9","2":"\xB2","3":"\xB3",o:"\xBA","0":"\u2070",i:"\u2071","4":"\u2074","5":"\u2075","6":"\u2076","7":"\u2077","8":"\u2078","9":"\u2079","+":"\u207A","-":"\u207B","=":"\u207C","(":"\u207D",")":"\u207E",n:"\u207F",a:"\xAA",v:"\u2C7D",h:"\u02B0",j:"\u02B2",r:"\u02B3",w:"\u02B7",y:"\u02B8",l:"\u02E1",s:"\u02E2",x:"\u02E3"};a.Painter.subscript_symbols_map={"0":"\u2080","1":"\u2081","2":"\u2082","3":"\u2083","4":"\u2084","5":"\u2085","6":"\u2086","7":"\u2087","8":"\u2088","9":"\u2089","+":"\u208A","-":"\u208B","=":"\u208C","(":"\u208D",")":"\u208E",a:"\u2090",e:"\u2091",o:"\u2092",x:"\u2093","ə":"\u2094",h:"\u2095",k:"\u2096",l:"\u2097",m:"\u2098",n:"\u2099",p:"\u209A",s:"\u209B",t:"\u209C",j:"\u2C7C"};a.Painter.translateSuperscript=function(e){var c="";for(var d=0;d<e.length;++d){c+=(this.superscript_symbols_map[e[d]]||e[d])}return c};a.Painter.translateSubscript=function(d){var c="";for(var e=0;e<d.length;++e){c+=(this.subscript_symbols_map[d[e]]||d[e])}return c};a.Painter.formatExp=function(c){var e=c.toLowerCase().replace("e+","x10@").replace("e-","x10@-"),f=e.indexOf("@"),d=a.Painter.translateSuperscript(e.substr(f+1)),e=e.substr(0,f);return((e==="1x10")?"10":e)+d};a.Painter.symbols_map={"#alpha":"\u03B1","#beta":"\u03B2","#chi":"\u03C7","#delta":"\u03B4","#varepsilon":"\u03B5","#phi":"\u03C6","#gamma":"\u03B3","#eta":"\u03B7","#iota":"\u03B9","#varphi":"\u03C6","#kappa":"\u03BA","#lambda":"\u03BB","#mu":"\u03BC","#nu":"\u03BD","#omicron":"\u03BF","#pi":"\u03C0","#theta":"\u03B8","#rho":"\u03C1","#sigma":"\u03C3","#tau":"\u03C4","#upsilon":"\u03C5","#varomega":"\u03D6","#omega":"\u03C9","#xi":"\u03BE","#psi":"\u03C8","#zeta":"\u03B6","#Alpha":"\u0391","#Beta":"\u0392","#Chi":"\u03A7","#Delta":"\u0394","#Epsilon":"\u0395","#Phi":"\u03A6","#Gamma":"\u0393","#Eta":"\u0397","#Iota":"\u0399","#vartheta":"\u03D1","#Kappa":"\u039A","#Lambda":"\u039B","#Mu":"\u039C","#Nu":"\u039D","#Omicron":"\u039F","#Pi":"\u03A0","#Theta":"\u0398","#Rho":"\u03A1","#Sigma":"\u03A3","#Tau":"\u03A4","#Upsilon":"\u03A5","#varsigma":"\u03C2","#Omega":"\u03A9","#Xi":"\u039E","#Psi":"\u03A8","#Zeta":"\u0396","#varUpsilon":"\u03D2","#epsilon":"\u03B5","#sqrt":"\u221A","#leq":"\u2264","#/":"\u2044","#infty":"\u221E","#voidb":"\u0192","#club":"\u2663","#diamond":"\u2666","#heart":"\u2665","#spade":"\u2660","#leftrightarrow":"\u2194","#leftarrow":"\u2190","#uparrow":"\u2191","#rightarrow":"\u2192","#downarrow":"\u2193","#circ":"\u02C6","#pm":"\xB1","#doublequote":"\u2033","#geq":"\u2265","#times":"\xD7","#propto":"\u221D","#partial":"\u2202","#bullet":"\u2022","#divide":"\xF7","#neq":"\u2260","#equiv":"\u2261","#approx":"\u2248","#3dots":"\u2026","#cbar":"\u007C","#topbar":"\xAF","#downleftarrow":"\u21B5","#aleph":"\u2135","#Jgothic":"\u2111","#Rgothic":"\u211C","#voidn":"\u2118","#otimes":"\u2297","#oplus":"\u2295","#oslash":"\u2205","#cap":"\u2229","#cup":"\u222A","#supseteq":"\u2287","#supset":"\u2283","#notsubset":"\u2284","#subseteq":"\u2286","#subset":"\u2282","#int":"\u222B","#in":"\u2208","#notin":"\u2209","#angle":"\u2220","#nabla":"\u2207","#oright":"\xAE","#ocopyright":"\xA9","#trademark":"\u2122","#prod":"\u220F","#surd":"\u221A","#upoint":"\u22C5","#corner":"\xAC","#wedge":"\u2227","#vee":"\u2228","#Leftrightarrow":"\u21D4","#Leftarrow":"\u21D0","#Uparrow":"\u21D1","#Rightarrow":"\u21D2","#Downarrow":"\u21D3","#LT":"\x3C","#void1":"\xAE","#copyright":"\xA9","#void3":"\u2122","#sum":"\u2211","#arctop":"","#lbar":"","#arcbottom":"","#void8":"","#bottombar":"\u230A","#arcbar":"","#ltbar":"","#AA":"\u212B","#aa":"\u00E5","#void06":"","#GT":"\x3E","#forall":"\u2200","#exists":"\u2203","#bar":"","#vec":"","#dot":"\u22C5","#hat":"\xB7","#ddot":"","#acute":"acute","#grave":"","#check":"\u2713","#tilde":"\u02DC","#slash":"\u2044","#hbar":"\u0127","#box":"","#Box":"","#parallel":"","#perp":"\u22A5","#odot":"","#left":"","#right":""};a.Painter.translateLaTeX=function(e){var f=e,d;var c=f.match(/\^{(.*?)}/gi);if(c){for(d=0;d<c.length;++d){f=f.replace(c[d],a.Painter.translateSuperscript(c[d].substr(2,c[d].length-3)))}}c=f.match(/\_{(.*?)}/gi);if(c){for(d=0;d<c.length;++d){f=f.replace(c[d],a.Painter.translateSubscript(c[d].substr(2,c[d].length-3)))}}c=f.match(/\#sqrt{(.*?)}/gi);if(c){for(d=0;d<c.length;++d){f=f.replace(c[d],c[d].replace(" ","").replace("#sqrt{","#sqrt").replace("}",""))}}for(d in a.Painter.symbols_map){f=f.replace(new RegExp(d,"g"),a.Painter.symbols_map[d])}if((f.indexOf("#splitline{")==0)&&(f[f.length-1]=="}")){var g=f.indexOf("}{");if((g>0)&&(g===f.lastIndexOf("}{"))){f=f.replace("}{","\n ").slice(11,f.length-1)}}return f.replace(/\^2/gi,"\xB2").replace(/\^3/gi,"\xB3")};a.Painter.isAnyLatex=function(c){return(c.indexOf("#")>=0)||(c.indexOf("\\")>=0)||(c.indexOf("{")>=0)};a.Painter.math_symbols_map={"#LT":"\\langle","#GT":"\\rangle","#club":"\\clubsuit","#spade":"\\spadesuit","#heart":"\\heartsuit","#diamond":"\\diamondsuit","#voidn":"\\wp","#voidb":"f","#copyright":"(c)","#ocopyright":"(c)","#trademark":"TM","#void3":"TM","#oright":"R","#void1":"R","#3dots":"\\ldots","#lbar":"\\mid","#void8":"\\mid","#divide":"\\div","#Jgothic":"\\Im","#Rgothic":"\\Re","#doublequote":'"',"#plus":"+","#diamond":"\\diamondsuit","#voidn":"\\wp","#voidb":"f","#copyright":"(c)","#ocopyright":"(c)","#trademark":"TM","#void3":"TM","#oright":"R","#void1":"R","#3dots":"\\ldots","#lbar":"\\mid","#void8":"\\mid","#divide":"\\div","#Jgothic":"\\Im","#Rgothic":"\\Re","#doublequote":'"',"#plus":"+","#minus":"-","#/":"/","#upoint":".","#aa":"\\mathring{a}","#AA":"\\mathring{A}","#omicron":"o","#Alpha":"A","#Beta":"B","#Epsilon":"E","#Zeta":"Z","#Eta":"H","#Iota":"I","#Kappa":"K","#Mu":"M","#Nu":"N","#Omicron":"O","#Rho":"P","#Tau":"T","#Chi":"X","#varomega":"\\varpi","#corner":"?","#ltbar":"?","#bottombar":"?","#notsubset":"?","#arcbottom":"?","#cbar":"?","#arctop":"?","#topbar":"?","#arcbar":"?","#downleftarrow":"?","#splitline":"\\genfrac{}{}{0pt}{}","#it":"\\textit","#bf":"\\textbf","#frac":"\\frac","#left{":"\\lbrace","#right}":"\\rbrace","#left\\[":"\\lbrack","#right\\]":"\\rbrack","#\\[\\]{":"\\lbrack"," } ":"\\rbrack","#\\[":"\\lbrack","#\\]":"\\rbrack","#{":"\\lbrace","#}":"\\rbrace"," ":"\\;"};a.Painter.translateMath=function(f,e,d){if(e!=2){for(var c in a.Painter.math_symbols_map){f=f.replace(new RegExp(c,"g"),a.Painter.math_symbols_map[c])}for(var c in a.Painter.symbols_map){f=f.replace(new RegExp(c,"g"),"\\"+c.substr(1))}}else{f=f.replace(/\\\^/g,"\\hat")}if(typeof d!="string"){return"\\("+f+"\\)"}return"\\(\\color{"+d+"}"+f+"\\)"};a.Painter.BuildSvgPath=function(i,t,p,d){var f=i.indexOf("bezier")>=0;if(d===undefined){d=f?2:0}if(p===undefined){p=0}function e(u,n){return(n.gry-u.gry)/(n.grx-u.grx)}function l(w){var v=0,u=w.length-1,n=[],z=w[0],y=w[1],x=n[0]=e(z,y);while(++v<u){n[v]=(x+(x=e(z=y,y=w[v+1])))/2}n[v]=x;return n}function c(z){var A,v,u,y,n=l(z),x=-1,w=z.length-1;while(++x<w){A=e(z[x],z[x+1]);if(Math.abs(A)<0.000001){n[x]=n[x+1]=0}else{v=n[x]/A;u=n[x+1]/A;y=v*v+u*u;if(y>9){y=A*3/Math.sqrt(y);n[x]=y*v;n[x+1]=y*u}}}x=-1;while(++x<=w){y=(z[Math.min(w,x+1)].grx-z[Math.max(0,x-1)].grx)/(6*(1+n[x]*n[x]));z[x].dgrx=y||0;z[x].dgry=n[x]*y||0}}var k={},s=t[0],h,j=Math.max(s.gry,p+5),o=Math.round(s.grx),m=Math.round(s.gry),r,q;k.path=((i[0]=="L")?"L":"M")+s.grx.toFixed(d)+","+s.gry.toFixed(d);if(f||i.indexOf("calc")>=0){c(t)}if(f){k.path+="c"+s.dgrx.toFixed(d)+","+s.dgry.toFixed(d)+","}for(var g=1;g<t.length;++g){h=s;s=t[g];if(f){if(g>1){k.path+="s"}k.path+=(s.grx-s.dgrx-h.grx).toFixed(d)+","+(s.gry-s.dgry-h.gry).toFixed(d)+","+(s.grx-h.grx).toFixed(d)+","+(s.gry-h.gry).toFixed(d);j=Math.max(j,h.gry)}else{r=Math.round(s.grx-o);q=Math.round(s.gry-m);k.path+="l"+r+","+q;o+=r;m+=q;j=Math.max(j,m)}}if(p>0){k.close="L"+s.grx.toFixed(d)+","+j.toFixed(d)+"L"+t[0].grx.toFixed(d)+","+j.toFixed(d)+"Z"}return k};a.TBasePainter=function(){this.divid=null};a.TBasePainter.prototype.AccessTopPainter=function(d){var c=this.select_main().node(),e=c?c.firstChild:null;if(!e){return null}if(d===true){e.painter=this}else{if(d===false){delete e.painter}}return e.painter};a.TBasePainter.prototype.Cleanup=function(){this.layout_main("simple");this.AccessTopPainter(false);this.divid=null;if(this._hpainter&&typeof this._hpainter.ClearPainter==="function"){this._hpainter.ClearPainter(this)}delete this._hitemname;delete this._hdrawopt;delete this._hpainter};a.TBasePainter.prototype.DrawingReady=function(c){this._ready_called_=true;if(this._ready_callback_!==undefined){if(!this._return_res_painter){c=this}else{delete this._return_res_painter}while(this._ready_callback_.length){a.CallBack(this._ready_callback_.shift(),c)}delete this._ready_callback_}return this};a.TBasePainter.prototype.WhenReady=function(c){if(typeof c!=="function"){return}if("_ready_called_" in this){return a.CallBack(c,this)}if(this._ready_callback_===undefined){this._ready_callback_=[]}this._ready_callback_.push(c)};a.TBasePainter.prototype.GetObject=function(){return null};a.TBasePainter.prototype.MatchObjectType=function(c){return false};a.TBasePainter.prototype.UpdateObject=function(c){return false};a.TBasePainter.prototype.RedrawPad=function(c){};a.TBasePainter.prototype.RedrawObject=function(d){if(!this.UpdateObject(d)){return false}var c=document.body.style.cursor;document.body.style.cursor="wait";this.RedrawPad();document.body.style.cursor=c;return true};a.TBasePainter.prototype.CheckResize=function(c){return false};a.TBasePainter.prototype.select_main=function(e){if(!this.divid){return b.select(null)}var g=this.divid;if((typeof g=="string")&&(g[0]!="#")){g="#"+g}var c=b.select(g);if(c.empty()||(e==="origin")){return c}var f=c.property("use_enlarge"),d=c.property("layout");if(d&&(d!=="simple")){switch(e){case"header":c=c.select(".canvas_header");break;case"footer":c=c.select(".canvas_footer");break;default:c=c.select(".canvas_main")}}else{if(typeof e==="string"){return b.select(null)}}if(!e&&!c.empty()&&f){c=b.select("#jsroot_enlarge_div")}return c};a.TBasePainter.prototype.layout_main=function(g){g=g||"simple";var f=this.select_main("origin");if(f.empty()||(f.property("layout")===g)){return false}var d=this.select_main(),c=[];while(d.node().firstChild){c.push(d.node().removeChild(d.node().firstChild))}if(g==="simple"){f.html("");d=f}else{var h=f.html("").append("div").attr("class","jsroot").style("display","flex").style("flex-direction","column").style("width","100%").style("height","100%");var j=h.append("div").attr("class","canvas_header").style("width","100%");d=h.append("div").style("flex",1).style("width","100%").style("position","relative").attr("class","canvas_main");var i=h.append("div").attr("class","canvas_footer").style("width","100%")}for(var e=0;e<c.length;++e){d.node().appendChild(c[e])}f.property("layout",g);return c.length>0};a.TBasePainter.prototype.check_main_resize=function(o,c,i){var g=this.enlarge_main("state"),e=this.select_main("origin"),f=this.select_main(),h=5;if(g!=="on"){if(c&&c.width&&c.height){e.style("width",c.width+"px").style("height",c.height+"px")}}var m=this.get_visible_rect(e,true);var j=e.attr("can_resize"),n=false;if(j=="height"){if(i&&Math.abs(m.width*i-m.height)>0.1*m.width){n=true}}if(((m.height<=h)||(m.width<=h))&&j&&j!=="false"){n=true}if(n&&(g!=="on")){if(m.width>h){i=i||0.66;e.style("height",Math.round(m.width*i)+"px")}else{if(j!=="height"){e.style("width","200px").style("height","100px")}}}var l=this.get_visible_rect(f),d=f.property("draw_height"),k=f.property("draw_width");l.changed=false;if(d&&k&&(d>0)&&(k>0)){if((d!==l.height)||(k!==l.width)){if((o>1)||(l.width/k<0.66)||(l.width/k>1.5)||(l.height/d<0.66)&&(l.height/d>1.5)){l.changed=true}}}else{l.changed=true}return l};a.TBasePainter.prototype.enlarge_main=function(i){var c=this.select_main(true),f=this.select_main("origin");if(c.empty()||!a.gStyle.CanEnlarge||(f.property("can_enlarge")===false)){return false}if(i===undefined){return true}if(i==="verify"){return true}var h=f.property("use_enlarge")?"on":"off";if(i==="state"){return h}if(i==="toggle"){i=(h==="off")}var g=b.select("#jsroot_enlarge_div");if((i===true)&&(h!=="on")){if(!g.empty()){return false}g=b.select(document.body).append("div").attr("id","jsroot_enlarge_div");var e=this.get_visible_rect(c),d=this.get_visible_rect(g);if((d.width<=e.width)||(d.height<=e.height)){if(d.width*d.height<e.width*e.height){console.log("Enlarged area "+d.width+"x"+d.height+" smaller then original drawing "+e.width+"x"+e.height);g.remove();return false}}while(c.node().childNodes.length>0){g.node().appendChild(c.node().firstChild)}f.property("use_enlarge",true);return true}if((i===false)&&(h!=="off")){while(g.node()&&g.node().childNodes.length>0){c.node().appendChild(g.node().firstChild)}g.remove();f.property("use_enlarge",false);return true}return false};a.TBasePainter.prototype.GetStyleValue=function(d,c){if(!d||d.empty()){return 0}var e=d.style(c);if(!e||(typeof e!=="string")){return 0}e=parseFloat(e.replace("px",""));return isNaN(e)?0:Math.round(e)};a.TBasePainter.prototype.get_visible_rect=function(f,c){if(a.nodejs){return{width:parseInt(f.attr("width")),height:parseInt(f.attr("height"))}}var e=f.node().getBoundingClientRect(),d={width:Math.round(e.width),height:Math.round(e.height)};if(!c){d.width-=this.GetStyleValue(f,"padding-left")+this.GetStyleValue(f,"padding-right");d.height-=this.GetStyleValue(f,"padding-top")-this.GetStyleValue(f,"padding-bottom")}return d};a.TBasePainter.prototype.SetDivId=function(c){if(arguments.length>0){this.divid=c}this.AccessTopPainter(true)};a.TBasePainter.prototype.SetItemName=function(c,d,e){if(typeof c==="string"){this._hitemname=c}else{delete this._hitemname}if(typeof d==="string"){this._hdrawopt=d}this._hpainter=e};a.TBasePainter.prototype.GetItemName=function(){return("_hitemname" in this)?this._hitemname:null};a.TBasePainter.prototype.GetItemDrawOpt=function(){return("_hdrawopt" in this)?this._hdrawopt:""};a.TBasePainter.prototype.CanZoomIn=function(d,e,c){return false};a.TObjectPainter=function(c){a.TBasePainter.call(this);this.draw_g=null;this.pad_name="";this.main=null;this.draw_object=((c!==undefined)&&(typeof c=="object"))?c:null};a.TObjectPainter.prototype=Object.create(a.TBasePainter.prototype);a.TObjectPainter.prototype.Cleanup=function(){this.RemoveDrawG();this.pad_name="";this.main=null;this.draw_object=null;delete this.fillatt;delete this.lineatt;delete this.markeratt;delete this.bins;a.TBasePainter.prototype.Cleanup.call(this)};a.TObjectPainter.prototype.GetObject=function(){return this.draw_object};a.TObjectPainter.prototype.MatchObjectType=function(c){if((c===undefined)||(c===null)||(this.draw_object===null)){return false}if(typeof c==="string"){return this.draw_object._typename===c}return(typeof c==="object")&&(this.draw_object._typename===c._typename)};a.TObjectPainter.prototype.SetItemName=function(c,d,f){a.TBasePainter.prototype.SetItemName.call(this,c,d,f);if(this.no_default_title||(c=="")){return}var e=this.svg_canvas();if(!e.empty()){e.select("title").text(c)}else{this.select_main().attr("title",c)}};a.TObjectPainter.prototype.UpdateObject=function(c){if(!this.MatchObjectType(c)){return false}a.extend(this.GetObject(),c);return true};a.TObjectPainter.prototype.GetTipName=function(c){var d=this.GetItemName();if(d===null){d=""}if((d.length===0)&&("fName" in this.GetObject())){d=this.GetObject().fName}if(d.lenght>20){d=d.substr(0,17)+"..."}if((d.length>0)&&(c!==undefined)){d+=c}return d};a.TObjectPainter.prototype.pad_painter=function(c){var d=c?this.svg_pad():this.svg_canvas();return d.empty()?null:d.property("pad_painter")};a.TObjectPainter.prototype.CheckResize=function(c){var d=this.pad_painter();if(!d){return false}d.CheckCanvasResize(c);return true};a.TObjectPainter.prototype.RemoveDrawG=function(){if(this.draw_g!=null){this.draw_g.remove();this.draw_g=null}};a.TObjectPainter.prototype.RecreateDrawG=function(c,d){if(this.draw_g){this.draw_g.selectAll("*").remove()}else{if(c){if(typeof d!="string"){d="text_layer"}if(d[0]=="."){d=d.substr(1)}this.draw_g=this.svg_layer(d).append("svg:g")}else{if(typeof d!="string"){d=".main_layer"}if(d[0]!="."){d="."+d}this.draw_g=this.svg_frame().select(d).append("svg:g")}}if(this.draw_object!==null){this.draw_g.attr("objname",encodeURI(this.draw_object.fName||"name"));this.draw_g.attr("objtype",encodeURI(this.draw_object._typename||"type"))}return this.draw_g};a.TObjectPainter.prototype.svg_canvas=function(){return this.select_main().select(".root_canvas")};a.TObjectPainter.prototype.svg_pad=function(d){var e=this.svg_canvas();if(d===undefined){d=this.pad_name}if(d&&!e.empty()){e=e.select(".subpads_layer").select("[pad="+d+"]")}return e};a.TObjectPainter.prototype.svg_layer=function(e,d){var c=this.svg_pad(d);if(c.empty()){return c}var g=c.node().firstChild;while(g!==null){var f=b.select(g);if(f.classed(e)){return f}g=g.nextSibling}return b.select(null)};a.TObjectPainter.prototype.CurrentPadName=function(d){var c=this.svg_canvas();if(c.empty()){return""}var e=c.property("current_pad");if(d!==undefined){c.property("current_pad",d)}return e};a.TObjectPainter.prototype.root_pad=function(){var c=this.pad_painter(true);return c?c.pad:null};a.TObjectPainter.prototype.ConvertToNDC=function(d,e,c){if(c){return e}var f=this.root_pad();if(!f){return e}if(d=="y"){if(f.fLogy){e=(e>0)?a.log10(e):f.fUymin}return(e-f.fY1)/(f.fY2-f.fY1)}if(f.fLogx){e=(e>0)?a.log10(e):f.fUxmin}return(e-f.fX1)/(f.fX2-f.fX1)};a.TObjectPainter.prototype.AxisToSvg=function(e,f,d){var c=this.main_painter();if(c&&!d){f=(e=="y")?c.gry(f)+c.frame_y():c.grx(f)+c.frame_x()}else{if(!d){f=this.ConvertToNDC(e,f)}f=(e=="y")?(1-f)*this.pad_height():f*this.pad_width()}return Math.round(f)};a.TObjectPainter.prototype.svg_frame=function(){return this.svg_pad().select(".root_frame")};a.TObjectPainter.prototype.frame_painter=function(){var d=this.svg_frame();var c=d.empty()?null:d.property("frame_painter");return c?c:null};a.TObjectPainter.prototype.pad_width=function(c){var e=this.svg_pad(c);var d=this.svg_pad(c).property("draw_width");return isNaN(d)?0:d};a.TObjectPainter.prototype.pad_height=function(c){var d=this.svg_pad(c).property("draw_height");return isNaN(d)?0:d};a.TObjectPainter.prototype.frame_x=function(){var c=parseInt(this.svg_frame().attr("x"));return isNaN(c)?0:c};a.TObjectPainter.prototype.frame_y=function(){var c=parseInt(this.svg_frame().attr("y"));return isNaN(c)?0:c};a.TObjectPainter.prototype.frame_width=function(){var c=parseInt(this.svg_frame().attr("width"));return isNaN(c)?0:c};a.TObjectPainter.prototype.frame_height=function(){var c=parseInt(this.svg_frame().attr("height"));return isNaN(c)?0:c};a.TObjectPainter.prototype.embed_3d=function(){if(a.BatchMode){return 3}if(a.gStyle.Embed3DinSVG<2){return a.gStyle.Embed3DinSVG}if(a.browser.isFirefox){return a.gStyle.Embed3DinSVG}return 1};a.TObjectPainter.prototype.access_3d_kind=function(d){var c=this.svg_pad(this.this_pad_name);if(c.empty()){return -1}var e=c.property("can3d");if(d!==undefined){c.property("can3d",d)}return((e===null)||(e===undefined))?-1:e};a.TObjectPainter.prototype.size_for_3d=function(k){if(k===undefined){k=this.embed_3d()}var e=this.svg_pad(this.this_pad_name),c="draw3d_"+(this.this_pad_name||this.pad_name||"canvas");if(e.empty()){var i=this.get_visible_rect(this.select_main());if((i.height<10)&&(i.width>10)){i.height=Math.round(0.66*i.width);this.select_main().style("height",i.height+"px")}i.x=0;i.y=0;i.clname=c;i.can3d=-1;return i}var f=e;if(k===0){f=this.svg_canvas()}var l={x:0,y:0,width:100,height:100,clname:c,can3d:k};if(this.frame_painter()!==null){f=this.svg_frame();l.x=f.property("draw_x");l.y=f.property("draw_y")}l.width=f.property("draw_width");l.height=f.property("draw_height");if((this.frame_painter()===null)&&(k>0)){l.x=Math.round(l.x+l.width*a.gStyle.fPadLeftMargin);l.y=Math.round(l.y+l.height*a.gStyle.fPadTopMargin);l.width=Math.round(l.width*(1-a.gStyle.fPadLeftMargin-a.gStyle.fPadRightMargin));l.height=Math.round(l.height*(1-a.gStyle.fPadTopMargin-a.gStyle.fPadBottomMargin))}var j=this.pad_width(this.this_pad_name),d=j-l.x-l.width,g=this.pad_height(this.this_pad_name),h=g-l.y-l.height;if((d>=0)&&(h>=0)){l.x=Math.round(l.x*0.3);l.y=Math.round(l.y*0.9);l.width=j-l.x-Math.round(d*0.3);l.height=g-l.y-Math.round(h*0.5)}if(k===1){this.CalcAbsolutePosition(this.svg_pad(this.this_pad_name),l)}return l};a.TObjectPainter.prototype.clear_3d_canvas=function(){var d=this.access_3d_kind(null);if(d<0){return}var c=this.size_for_3d(d);if(c.can3d===0){b.select(this.svg_canvas().node().nextSibling).remove();this.svg_canvas().style("display",null)}else{if(this.svg_pad(this.this_pad_name).empty()){return}this.apply_3d_size(c).remove();this.svg_frame().style("display",null)}};a.TObjectPainter.prototype.add_3d_canvas=function(d,f){if(!f||(d.can3d<-1)){return}if(d.can3d===-1){var c=this.select_main().node();if(c!==null){c.appendChild(f);f.painter=this}return}this.access_3d_kind(d.can3d);if(d.can3d===0){this.svg_canvas().style("display","none");this.svg_canvas().node().parentNode.appendChild(f)}else{if(this.svg_pad(this.this_pad_name).empty()){return}this.svg_frame().style("display","none");var e=this.apply_3d_size(d);e.attr("title","").node().appendChild(f)}};a.TObjectPainter.prototype.apply_3d_size=function(l,c){if(l.can3d<0){return b.select(null)}var d;if(l.can3d>1){var i=this.svg_layer("special_layer");d=i.select("."+l.clname);if(c){return d}if(l.can3d===3){if(d.empty()){d=i.append("g").attr("class",l.clname)}d.attr("transform","translate("+l.x+","+l.y+")")}else{if(d.empty()){d=i.append("foreignObject").attr("class",l.clname)}d.attr("x",l.x).attr("y",l.y).attr("width",l.width).attr("height",l.height).attr("viewBox","0 0 "+l.width+" "+l.height).attr("preserveAspectRatio","xMidYMid")}}else{var e=this.svg_canvas().node().parentNode;d=b.select(e).select("."+l.clname);if(c){return d}this.svg_canvas().property("redraw_by_resize",true);if(d.empty()){d=b.select(e).append("div").attr("class",l.clname+" jsroot_noselect")}var k=e.getBoundingClientRect();while(e){if(e===document){e=null;break}try{if(getComputedStyle(e).position!=="static"){break}}catch(f){break}e=e.parentNode}var j=e?e.getBoundingClientRect():{top:0,left:0};var h=Math.round(k.left-j.left),g=Math.round(k.top-j.top);d.style("position","absolute").style("left",(l.x+h)+"px").style("top",(l.y+g)+"px").style("width",l.width+"px").style("height",l.height+"px")}return d};a.TObjectPainter.prototype.main_painter=function(f,d){var e=this.main;if(!e){var c=this.svg_pad(d);if(c.empty()){e=this.AccessTopPainter()}else{e=c.property("mainpainter")}if(!e){e=null}if(!f){this.main=e}}return e};a.TObjectPainter.prototype.is_main_painter=function(){return this===this.main_painter()};a.TObjectPainter.prototype.SetDivId=function(g,f,e){if(g!==undefined){this.divid=g}if(!f){f=0}this.create_canvas=false;var d=this.svg_canvas();if(d.empty()&&(f>0)&&(f!==5)){a.Painter.drawCanvas(g,null,((f==2)||(f==4))?"noframe":"");d=this.svg_canvas();this.create_canvas=true}if(d.empty()){if((f<0)||(f===5)||this.iscan){return}this.AccessTopPainter(true);return}this.pad_name=e;if(this.pad_name===undefined){this.pad_name=this.CurrentPadName()}if(f<0){return}if(this.svg_frame().select(".main_layer").empty()&&((f==1)||(f==3))){a.Painter.drawFrame(g,null);if(this.svg_frame().empty()){return alert("Fail to draw dummy TFrame")}}var c=this.svg_pad();if(c.empty()){return}if(c.property("pad_painter")!==this){c.property("pad_painter").painters.push(this)}if(((f===1)||(f===4)||(f===5))&&!c.property("mainpainter")){c.property("mainpainter",this)}};a.TObjectPainter.prototype.CalcAbsolutePosition=function(c,d){while(!c.empty()&&!c.classed("root_canvas")){if(c.classed("root_frame")||c.classed("root_pad")){d.x+=c.property("draw_x");d.y+=c.property("draw_y")}c=b.select(c.node().parentNode)}return d};a.TObjectPainter.prototype.createAttFill=function(e,f,c,d){var g={color:"none",colorindx:0,pattern:0,used:true,kind:2,changed:false};if(d!==undefined){g.kind=d}g.Apply=function(h){this.used=true;h.style("fill",this.color);if("opacity" in this){h.style("opacity",this.opacity)}if("antialias" in this){h.style("antialias",this.antialias)}};g.func=g.Apply.bind(g);g.empty=function(){return(this.color=="none")};g.Change=function(j,m,i){this.changed=true;if((j!==undefined)&&!isNaN(j)){this.colorindx=j}if((m!==undefined)&&!isNaN(m)){this.pattern=m;delete this.opacity;delete this.antialias}if(this.pattern<1001){this.color="none";return true}if((this.pattern===1001)&&(this.colorindx===0)&&(this.kind===1)){this.color="none";return true}this.color=a.Painter.root_colors[this.colorindx];if(typeof this.color!="string"){this.color="none"}if(this.pattern===1001){return true}if((this.pattern>=4000)&&(this.pattern<=4100)){this.opacity=(this.pattern-4000)/100;return true}if((i===undefined)||i.empty()||(this.pattern<3000)||(this.pattern>3025)){return false}var n="pat_"+this.pattern+"_"+this.colorindx;var h=i.select(".canvas_defs");if(h.empty()){h=i.insert("svg:defs",":first-child").attr("class","canvas_defs")}var k=this.color;this.color="url(#"+n+")";this.antialias=false;if(!h.select("."+n).empty()){return true}var l=h.append("svg:pattern").attr("id",n).attr("class",n).attr("patternUnits","userSpaceOnUse");switch(this.pattern){case 3001:l.attr("width",2).attr("height",2);l.append("svg:rect").attr("x",0).attr("y",0).attr("width",1).attr("height",1);l.append("svg:rect").attr("x",1).attr("y",1).attr("width",1).attr("height",1);break;case 3002:l.attr("width",4).attr("height",2);l.append("svg:rect").attr("x",1).attr("y",0).attr("width",1).attr("height",1);l.append("svg:rect").attr("x",3).attr("y",1).attr("width",1).attr("height",1);break;case 3003:l.attr("width",4).attr("height",4);l.append("svg:rect").attr("x",2).attr("y",1).attr("width",1).attr("height",1);l.append("svg:rect").attr("x",0).attr("y",3).attr("width",1).attr("height",1);break;case 3005:l.attr("width",8).attr("height",8);l.append("svg:line").attr("x1",0).attr("y1",0).attr("x2",8).attr("y2",8);break;case 3006:l.attr("width",4).attr("height",4);l.append("svg:line").attr("x1",1).attr("y1",0).attr("x2",1).attr("y2",3);break;case 3007:l.attr("width",4).attr("height",4);l.append("svg:line").attr("x1",0).attr("y1",1).attr("x2",3).attr("y2",1);break;case 3010:l.attr("width",10).attr("height",10);l.append("svg:line").attr("x1",0).attr("y1",2).attr("x2",10).attr("y2",2);l.append("svg:line").attr("x1",0).attr("y1",7).attr("x2",10).attr("y2",7);l.append("svg:line").attr("x1",2).attr("y1",0).attr("x2",2).attr("y2",2);l.append("svg:line").attr("x1",7).attr("y1",2).attr("x2",7).attr("y2",7);l.append("svg:line").attr("x1",2).attr("y1",7).attr("x2",2).attr("y2",10);break;case 3021:case 3022:l.attr("width",10).attr("height",10);l.append("svg:line").attr("x1",0).attr("y1",5).attr("x2",5).attr("y2",5);l.append("svg:line").attr("x1",5).attr("y1",5).attr("x2",5).attr("y2",0);l.append("svg:line").attr("x1",5).attr("y1",10).attr("x2",10).attr("y2",10);l.append("svg:line").attr("x1",10).attr("y1",10).attr("x2",10).attr("y2",5);break;default:l.attr("width",8).attr("height",8);l.append("svg:line").attr("x1",8).attr("y1",0).attr("x2",0).attr("y2",8);break}l.selectAll("line").style("stroke",k).style("stroke-width",1);l.selectAll("rect").style("fill",k);return true};if((e!==null)&&(typeof e=="object")){if("fFillStyle" in e){f=e.fFillStyle}if("fFillColor" in e){c=e.fFillColor}}g.Change(c,f,this.svg_canvas());g.changed=false;return g};a.TObjectPainter.prototype.ForEachPainter=function(d){var c=this.AccessTopPainter();if(c){return d(c)}var e=this.pad_painter(true);if(e){e.ForEachPainterInPad(d)}};a.TObjectPainter.prototype.RedrawPad=function(){var c=this.pad_painter(true);if(c){c.Redraw()}};a.TObjectPainter.prototype.SwitchTooltip=function(c){var d=this.frame_painter();if(d){d.ProcessTooltipEvent(null,c)}if(this.control&&(typeof this.control.SwitchTooltip=="function")){this.control.SwitchTooltip(c)}};a.TObjectPainter.prototype.AddDrag=function(p){if(!a.gStyle.MoveResize){return}var d=this;var c=function(){return Number(d.draw_g.attr("width"))};var r=function(){return Number(d.draw_g.attr("height"))};var s=0,q=0,k=1,e=1,j=null;function n(t){if("buttons" in t){return t.buttons===2}else{if("which" in t){return t.which===3}else{if("button" in t){return t.button===2}}}return false}var g=this.draw_g.select(".resize_corner1");if(g.empty()){g=this.draw_g.append("path").attr("class","resize_corner1").attr("d","M2,2 h15 v-5 h-20 v20 h5 Z")}var f=this.draw_g.select(".resize_corner2");if(f.empty()){f=this.draw_g.append("path").attr("class","resize_corner2").attr("d","M-2,-2 h-15 v5 h20 v-20 h-5 Z")}g.style("opacity",0).style("cursor","nw-resize");f.style("opacity",0).style("cursor","se-resize").attr("transform","translate("+c()+","+r()+")");var i=null;function h(){i.style("cursor","auto");var x=Number(d.draw_g.attr("x")),w=Number(d.draw_g.attr("y")),A=Number(i.attr("x")),z=Number(i.attr("y")),t=Number(i.attr("width")),u=Number(i.attr("height"));if(p.minwidth&&t<p.minwidth){t=p.minwidth}if(p.minheight&&u<p.minheight){u=p.minheight}var v=(t!==c())||(u!==r()),y=(A!==x)||(z!==w);d.draw_g.attr("x",A).attr("y",z).attr("transform","translate("+A+","+z+")").attr("width",t).attr("height",u);i.remove();i=null;d.SwitchTooltip(true);f.attr("transform","translate("+t+","+u+")");if(v||y){if(v&&("resize" in p)){p.resize(t,u)}if(y&&("move" in p)){p.move(A,z,A-oldxx,z-w)}if(v||y){if("obj" in p){p.obj.fX1NDC=A/d.pad_width();p.obj.fX2NDC=(A+t)/d.pad_width();p.obj.fY1NDC=1-(z+u)/d.pad_height();p.obj.fY2NDC=1-z/d.pad_height();p.obj.modified_NDC=true}if("redraw" in p){p.redraw()}}}return v||y}var l="",o,m;if(a._test_d3_===3){l="drag";o=b.behavior.drag().origin(Object);m=b.behavior.drag().origin(Object)}else{o=b.drag().subject(Object);m=b.drag().subject(Object)}o.on(l+"start",function(){if(n(b.event.sourceEvent)){return}a.Painter.closeMenu();d.SwitchTooltip(false);b.event.sourceEvent.preventDefault();b.event.sourceEvent.stopPropagation();s=0;q=0;k=d.pad_width()-c();e=d.pad_height()-r();j=new Date();i=b.select(d.draw_g.node().parentNode).append("rect").classed("zoom",true).attr("x",d.draw_g.attr("x")).attr("y",d.draw_g.attr("y")).attr("width",c()).attr("height",r()).style("cursor","move").style("pointer-events","none")}).on("drag",function(){if(i==null){return}b.event.sourceEvent.preventDefault();var t=Number(i.attr("x")),w=Number(i.attr("y"));var v=b.event.dx,u=b.event.dy;if((s<0)&&(v>0)){s+=v;v=0;if(s>0){v=s;s=0}}if((s>0)&&(v<0)){s+=v;v=0;if(s<0){v=s;s=0}}if((q<0)&&(u>0)){q+=u;u=0;if(q>0){u=q;q=0}}if((q>0)&&(u<0)){q+=u;u=0;if(q<0){u=q;q=0}}if(t+v<0){s+=(t+v);t=0}else{if(t+v>k){s+=(t+v-k);t=k}else{t+=v}}if(w+u<0){q+=(w+u);w=0}else{if(w+u>e){q+=(w+u-e);w=e}else{w+=u}}i.attr("x",t).attr("y",w);b.event.sourceEvent.stopPropagation()}).on(l+"end",function(){if(i==null){return}b.event.sourceEvent.preventDefault();if(h()===false){if(p.ctxmenu&&((new Date()).getTime()-j.getTime()>600)){var t=f.node().getBoundingClientRect();d.ShowContextMenu("main",{clientX:t.left,clientY:t.top})}}});m.on(l+"start",function(){if(n(b.event.sourceEvent)){return}b.event.sourceEvent.stopPropagation();b.event.sourceEvent.preventDefault();d.SwitchTooltip(false);s=0;q=0;k=d.pad_width();e=d.pad_height();i=b.select(d.draw_g.node().parentNode).append("rect").classed("zoom",true).attr("x",d.draw_g.attr("x")).attr("y",d.draw_g.attr("y")).attr("width",c()).attr("height",r()).style("cursor",b.select(this).style("cursor"))}).on("drag",function(){if(i==null){return}b.event.sourceEvent.preventDefault();var v=Number(i.attr("width")),A=Number(i.attr("height")),t=Number(i.attr("x")),B=Number(i.attr("y"));var z=b.event.dx,u=b.event.dy;if((s<0)&&(z>0)){s+=z;z=0;if(s>0){z=s;s=0}}if((s>0)&&(z<0)){s+=z;z=0;if(s<0){z=s;s=0}}if((q<0)&&(u>0)){q+=u;u=0;if(q>0){u=q;q=0}}if((q>0)&&(u<0)){q+=u;u=0;if(q<0){u=q;q=0}}if(b.select(this).classed("resize_corner1")){if(t+z<0){s+=(t+z);v+=t;t=0}else{if(v-z<0){s-=(v-z);t+=v;v=0}else{t+=z;v-=z}}if(B+u<0){q+=(B+u);A+=B;B=0}else{if(A-u<0){q-=(A-u);B+=A;A=0}else{B+=u;A-=u}}}else{if(t+v+z>k){s+=(t+v+z-k);v=k-t}else{if(v+z<0){s+=(v+z);v=0}else{v+=z}}if(B+A+u>e){q+=(B+A+u-e);A=e-B}else{if(A+u<0){q+=(A+u);A=0}else{A+=u}}}i.attr("x",t).attr("y",B).attr("width",v).attr("height",A);b.event.sourceEvent.stopPropagation()}).on(l+"end",function(){if(i==null){return}b.event.sourceEvent.preventDefault();h()});if(!p.only_resize){this.draw_g.style("cursor","move").call(o)}g.call(m);f.call(m)};a.TObjectPainter.prototype.startTouchMenu=function(e){var c=b.touches(this.svg_frame().node());if(c.length!=1){return}if(!e||(e=="")){e="main"}var d="touch_"+e;b.event.preventDefault();b.event.stopPropagation();this[d]={dt:new Date(),pos:c[0]};this.svg_frame().on("touchcancel",this.endTouchMenu.bind(this,e)).on("touchend",this.endTouchMenu.bind(this,e))};a.TObjectPainter.prototype.endTouchMenu=function(d){var c="touch_"+d;if(!(c in this)){return}b.event.preventDefault();b.event.stopPropagation();var f=new Date().getTime()-this[c].dt.getTime();this.svg_frame().on("touchcancel",null).on("touchend",null);if(f>500){var e=this.svg_frame().node().getBoundingClientRect();this.ShowContextMenu(d,{clientX:e.left+this[c].pos[0],clientY:e.top+this[c].pos[1]})}delete this[c]};a.TObjectPainter.prototype.AddColorMenuEntry=function(e,d,j,i,c){if(j===undefined){return}e.add("sub:"+d,function(){var m=(typeof j!=="string");var l=prompt("Enter color "+(m?"(only id number)":"(name or id)"),j);if(l==null){return}var n=parseInt(l);if(!isNaN(n)&&(a.Painter.root_colors[n]!==undefined)){l=a.Painter.root_colors[n]}else{if(m){return}}i.bind(this)(m?n:l)});var k=(typeof j!=="string");for(var f=-1;f<11;++f){if((f<0)&&k){continue}if((f==10)&&(c!==1)){continue}var g=(f<0)?"none":a.Painter.root_colors[f];if((f==0)&&(c==1)){g="none"}var h="<svg width='100' height='18' style='margin:0px;background-color:"+g+"'><text x='4' y='12' style='font-size:12px' fill='"+(f==1?"white":"black")+"'>"+g+"</text></svg>";e.addchk((j==(k?f:g)),h,(k?f:g),i)}e.add("endsub:")};a.TObjectPainter.prototype.AddSizeMenuEntry=function(d,c,g,i,f,k,h){if(k===undefined){return}d.add("sub:"+c,function(){var l=k.toFixed(4);if(f>=0.1){l=k.toFixed(2)}if(f>=1){l=k.toFixed(0)}var m=prompt("Enter value of "+c,l);if(m==null){return}var m=parseFloat(m);if(!isNaN(m)){h.bind(this)((f>=1)?Math.round(m):m)}});for(var e=g;e<=i;e+=f){var j=e.toFixed(2);if(f>=0.1){j=e.toFixed(1)}if(f>=1){j=e.toFixed(0)}d.addchk((Math.abs(k-e)<f/2),j,e,h)}d.add("endsub:")};a.LongPollSocket=function(c){this.path=c;this.connid=null;this.req=null;this.nextrequest=function(i,g){var e=this.path;if(g==="connect"){e+="?connect";this.connid="connect"}else{if(g==="close"){if((this.connid===null)||(this.connid==="close")){return}e+="?connection="+this.connid+"&close";this.connid="close"}else{if((this.connid===null)||(typeof this.connid!=="number")){return console.error("No connection")}else{e+="?connection="+this.connid;if(g==="dummy"){e+="&dummy"}}}}if(i){var f="&post=";for(var d=0;d<i.length;++d){f+=i.charCodeAt(d).toString(16)}e+=f}var h=a.NewHttpRequest(e,"text",function(j){if(j===null){j=this.response}if(this.handle.req===this){this.handle.req=null;if(j=="<<nope>>"){j=""}}this.handle.processreq(j)});h.handle=this;if(g==="dummy"){this.req=h}h.send()};this.processreq=function(d){if(d===null){if(typeof this.onerror==="function"){this.onerror("receive data with connid "+(this.connid||"---"))}this.connid=null;return}if(this.connid==="connect"){this.connid=parseInt(d);console.log("Get new longpoll connection with id "+this.connid);if(typeof this.onopen=="function"){this.onopen()}}else{if(this.connid==="close"){if(typeof this.onclose=="function"){this.onclose()}return}else{if((typeof this.onmessage==="function")&&d){this.onmessage({data:d})}}}if(!this.req){this.nextrequest("","dummy")}};this.send=function(d){this.nextrequest(d)};this.close=function(){this.nextrequest("","close")};this.nextrequest("","connect");return this};a.TObjectPainter.prototype.OpenWebsocket=function(d){delete this._websocket;var i=window.location.href,h=null;if(!d){i=i.replace("http://","ws://");i=i.replace("https://","wss://");var j=i.indexOf("draw.htm");if(j<0){return}i=i.substr(0,j)+"root.websocket";console.log("open websocket "+i);h=new WebSocket(i)}else{var j=i.indexOf("draw.htm");if(j<0){return}i=i.substr(0,j)+"root.longpoll";console.log("open longpoll "+i);h=a.LongPollSocket(i)}this._websocket=h;var c=this,g=0,e=0,f=0;h.onopen=function(){console.log("websocket initialized");h.send("READY")};h.onmessage=function(t){var u=t.data;if(typeof u!="string"){return console.log("msg",u)}if(u.substr(0,4)=="SNAP"){var q=a.parse(u.substr(4));if(typeof c.RedrawSnap==="function"){c.RedrawSnap(q,function(){h.send("READY")})}else{h.send("READY")}}else{if(u.substr(0,4)=="JSON"){var r=a.parse(u.substr(4));var n=new Date().getTime();c.RedrawObject(r);var m=new Date().getTime();g+=1;e+=(m-n);if(g>10){console.log("Redraw ",Math.round(e/g));g=e=0}h.send("READY")}else{if(u.substr(0,4)=="MENU"){var s=a.parse(u.substr(4));console.log("get MENUS ",typeof s,"nitems",s.length,u.length-4);h.send("READY");if(typeof c._getmenu_callback=="function"){c._getmenu_callback(s)}}else{if(u.substr(0,7)=="GETIMG:"){console.log("d",u);u=u.substr(7);var l=u.indexOf(":"),k=u.substr(0,l),o=u.substr(l+1);h.send("READY");console.log("GET REQUEST FOR FILE",o,k);var v=c.FindSnap(k);if(v){v.SaveAsPng(v.iscan,"image.svg",function(p){console.log("SVG IMAGE CREATED",p?p.length:"");if(p){h.send("GETIMG:"+o+":"+p)}})}}else{if(u){console.log("urecognized msg",u)}}}}}};h.onclose=function(){console.log("websocket closed");delete c._websocket;window.close()};h.onerror=function(k){console.log("err "+k)}};a.TObjectPainter.prototype.FillObjectExecMenu=function(g,e){var f=this.pad_painter();if(!this.snapid||!f||!f._websocket||f._getmenu_callback){return a.CallBack(e)}function c(h){console.log("execute method "+h+" for object "+this.snapid);var i=this.pad_painter();if(i&&i._websocket&&this.snapid){i._websocket.send("OBJEXEC:"+this.snapid+":"+h)}}function d(k,j,h){if(!f._getmenu_callback){return}delete f._getmenu_callback;if(h&&h.length){k.add("separator");k.add("sub:Online");for(var l=0;l<h.length;++l){var i=h[l];if("chk" in i){k.addchk(i.chk,i.name,i.exec,c)}else{k.add(i.name,i.exec,c)}}k.add("endsub:")}a.CallBack(j)}f._getmenu_callback=d.bind(this,g,e);f._websocket.send("GETMENU:"+this.snapid);setTimeout(f._getmenu_callback,2000)};a.TObjectPainter.prototype.DeleteAtt=function(){delete this.lineatt;delete this.fillatt;delete this.markeratt};a.TObjectPainter.prototype.FillAttContextMenu=function(h,g){if(!g){g=""}if(this.lineatt&&this.lineatt.used){h.add("sub:"+g+"Line att");this.AddSizeMenuEntry(h,"width",1,10,1,this.lineatt.width,function(k){this.lineatt.Change(undefined,parseInt(k));this.Redraw()}.bind(this));this.AddColorMenuEntry(h,"color",this.lineatt.color,function(k){this.lineatt.Change(k);this.Redraw()}.bind(this));h.add("sub:style",function(){var k=prompt("Enter line style id (1-solid)",1);if(k==null){return}k=parseInt(k);if(isNaN(k)||(a.Painter.root_line_styles[k]===undefined)){return}this.lineatt.Change(undefined,undefined,a.Painter.root_line_styles[k]);this.Redraw()}.bind(this));for(var j=1;j<11;++j){var f=a.Painter.root_line_styles[j];var d="<svg width='100' height='18'><text x='1' y='12' style='font-size:12px'>"+j+"</text><line x1='30' y1='8' x2='100' y2='8' stroke='black' stroke-width='3' stroke-dasharray='"+f+"'></line></svg>";h.addchk((this.lineatt.dash==f),d,f,function(k){this.lineatt.Change(undefined,undefined,k);this.Redraw()}.bind(this))}h.add("endsub:");h.add("endsub:");if(("excl_side" in this.lineatt)&&(this.lineatt.excl_side!==0)){h.add("sub:Exclusion");h.add("sub:side");for(var e=-1;e<=1;++e){h.addchk((this.lineatt.excl_side==e),e,e,function(k){this.lineatt.ChangeExcl(parseInt(k));this.Redraw()}.bind(this))}h.add("endsub:");this.AddSizeMenuEntry(h,"width",10,100,10,this.lineatt.excl_width,function(k){this.lineatt.ChangeExcl(undefined,parseInt(k));this.Redraw()}.bind(this));h.add("endsub:")}}if(this.fillatt&&this.fillatt.used){h.add("sub:"+g+"Fill att");this.AddColorMenuEntry(h,"color",this.fillatt.colorindx,function(k){this.fillatt.Change(parseInt(k),undefined,this.svg_canvas());this.Redraw()}.bind(this),this.fillatt.kind);h.add("sub:style",function(){var k=prompt("Enter fill style id (1001-solid, 3000..3010)",this.fillatt.pattern);if(k==null){return}k=parseInt(k);if(isNaN(k)){return}this.fillatt.Change(undefined,k,this.svg_canvas());this.Redraw()}.bind(this));var c=[1,1001,3001,3002,3003,3004,3005,3006,3007,3010,3021,3022];var i=a.clone(this.fillatt);if(i.colorindx<=0){i.colorindx=1}for(var j=0;j<c.length;++j){i.Change(undefined,c[j],this.svg_canvas());var d="<svg width='100' height='18'><text x='1' y='12' style='font-size:12px'>"+c[j].toString()+"</text><rect x='40' y='0' width='60' height='18' stroke='none' fill='"+i.color+"'></rect></svg>";h.addchk(this.fillatt.pattern==c[j],d,c[j],function(k){this.fillatt.Change(undefined,parseInt(k),this.svg_canvas());this.Redraw()}.bind(this))}h.add("endsub:");h.add("endsub:")}if(this.markeratt&&this.markeratt.used){h.add("sub:"+g+"Marker att");this.AddColorMenuEntry(h,"color",this.markeratt.color,function(k){this.markeratt.Change(k);this.Redraw()}.bind(this));this.AddSizeMenuEntry(h,"size",0.5,6,0.5,this.markeratt.size,function(k){this.markeratt.Change(undefined,undefined,parseFloat(k));this.Redraw()}.bind(this));h.add("sub:style");var c=[1,2,3,4,5,6,7,8,21,22,23,24,25,26,27,28,29,30,31,32,33,34];var i=a.clone(this.markeratt);for(var j=0;j<c.length;++j){i.Change(undefined,c[j],1.7);i.reset_pos();var d="<svg width='60' height='18'><text x='1' y='12' style='font-size:12px'>"+c[j].toString()+"</text><path stroke='black' fill='"+(i.fill?"black":"none")+"' d='"+i.create(40,8)+"'></path></svg>";h.addchk(this.markeratt.style==c[j],d,c[j],function(k){this.markeratt.Change(undefined,parseInt(k));this.Redraw()}.bind(this))}h.add("endsub:");h.add("endsub:")}};a.TObjectPainter.prototype.TextAttContextMenu=function(g,e){var f=this.GetObject();if(!f||!("fTextColor" in f)){return}g.add("sub:"+(e?e:"Text"));this.AddColorMenuEntry(g,"color",f.fTextColor,function(j){this.GetObject().fTextColor=parseInt(j);this.Redraw()}.bind(this));var i=[11,12,13,21,22,23,31,32,33],d=["left","centered","right"],c=["bottom","centered","top"];g.add("sub:align");for(var h=0;h<i.length;++h){g.addchk(i[h]==f.fTextAlign,i[h],i[h],function(j){this.GetObject().fTextAlign=parseInt(j);this.Redraw()}.bind(this))}g.add("endsub:");g.add("sub:font");for(var h=1;h<16;++h){g.addchk(h==Math.floor(f.fTextFont/10),h,h,function(j){this.GetObject().fTextFont=parseInt(j)*10+2;this.Redraw()}.bind(this))}g.add("endsub:");g.add("endsub:")};a.TObjectPainter.prototype.FillContextMenu=function(d){var c=this.GetTipName();if(this.GetObject()&&("_typename" in this.GetObject())){c=this.GetObject()._typename+"::"+c}d.add("header:"+c);this.FillAttContextMenu(d);if(d.size()>0){d.add("Inspect",function(){a.draw(this.divid,this.GetObject(),"inspect")})}return d.size()>0};a.TObjectPainter.prototype.GetShowStatusFunc=function(){var c=this.pad_painter(),d=a.Painter.ShowStatus;if(c&&(typeof c.ShowStatus==="function")){d=c.ShowStatus}if(d&&(this.enlarge_main("state")==="on")){d=null}return d};a.TObjectPainter.prototype.ShowObjectStatus=function(){var d=this.GetObject(),c=this.GetShowStatusFunc();if(d&&c){c(this.GetItemName()||d.fName,d.fTitle||d._typename,d._typename)}};a.TObjectPainter.prototype.FindInPrimitives=function(f){var d=this.pad_painter(true);if((d===null)||(d.pad===null)){return null}if(d.pad.fPrimitives!==null){for(var e=0;e<d.pad.fPrimitives.arr.length;++e){var c=d.pad.fPrimitives.arr[e];if(("fName" in c)&&(c.fName===f)){return c}}}return null};a.TObjectPainter.prototype.FindPainterFor=function(d,g,h){var c=this.pad_painter(true);var f=(c===null)?null:c.painters;if(f===null){return null}for(var i=0;i<f.length;++i){var e=f[i].GetObject();if(!e){continue}if(d&&(e===d)){return f[i]}if(!g&&!h){continue}if(g&&(e.fName!==g)){continue}if(h&&(e._typename!==h)){continue}return f[i]}return null};a.TObjectPainter.prototype.ConfigureUserTooltipCallback=function(d,c){if((d===undefined)||(typeof d!=="function")){delete this.UserTooltipCallback;return}if(c===undefined){c=500}this.UserTooltipCallback=d;this.UserTooltipTimeout=c};a.TObjectPainter.prototype.IsUserTooltipCallback=function(){return typeof this.UserTooltipCallback=="function"};a.TObjectPainter.prototype.ProvideUserTooltip=function(c){if(!this.IsUserTooltipCallback()){return}if(this.UserTooltipTimeout<=0){return this.UserTooltipCallback(c)}if(typeof this.UserTooltipTHandle!="undefined"){clearTimeout(this.UserTooltipTHandle);delete this.UserTooltipTHandle}if(c==null){return this.UserTooltipCallback(c)}this.UserTooltipTHandle=setTimeout(function(e){delete this.UserTooltipTHandle;this.UserTooltipCallback(e)}.bind(this,c),this.UserTooltipTimeout)};a.TObjectPainter.prototype.Redraw=function(){};a.TObjectPainter.prototype.StartTextDrawing=function(e,c,g,f){if(!g){g=this.draw_g}var d=a.Painter.getFontDetails(e,c);g.call(d.func);g.property("draw_text_completed",false).property("text_font",d).property("mathjax_use",false).property("normaltext_use",false).property("text_factor",0).property("max_text_width",0).property("max_font_size",f)};a.TObjectPainter.prototype.TextScaleFactor=function(d,c){if(!c){c=this.draw_g}if(d&&(d>c.property("text_factor"))){c.property("text_factor",d)}};a.TObjectPainter.prototype.GetBoundarySizes=function(e){if(e===null){console.warn("empty node in GetBoundarySizes");return{width:0,height:0}}var d=e.getBoundingClientRect();if(parseFloat(d.width)>0){d=e.getBBox()}var c={width:parseInt(d.width),height:parseInt(d.height)};if("left" in d){c.x=parseInt(d.left);c.y=parseInt(d.right)}else{if("x" in d){c.x=parseInt(d.x);c.y=parseInt(d.y)}}return c};a.TObjectPainter.prototype.FinishTextDrawing=function(l,i){if(!l){l=this.draw_g}if(l.property("draw_text_completed")){a.CallBack(i);return l.property("max_text_width")}if(i){l.node().text_callback=i}var k=null;if(l.property("mathjax_use")){var g=0;k=l.selectAll(".math_svg");k.each(function(){var f=b.select(this);if(f.node().parentNode!==l.node()){return}if(f.select("svg").empty()){g++}});if(g){return}}var j=this,c=0,h=l.property("text_factor"),d=l.property("text_font"),e=d.size;if((h>0)&&((h<0.9)||(h>1))){d.size=Math.floor(d.size/h);if(l.property("max_font_size")&&(d.size>l.property("max_font_size"))){d.size=l.property("max_font_size")}l.call(d.func);e=d.size}else{}if(k){k.each(function(){var q=b.select(this);if(q.node().parentNode!==l.node()){return}var r=q.select("svg");if(r.empty()){console.log("MathJax SVG ouptut error");return}function m(s){if(!s||(typeof s!=="string")){return null}if(s.indexOf("ex")!==s.length-2){return null}s=parseFloat(s.substr(0,s.length-2));return isNaN(s)?null:s*e*0.5}var o=m(r.attr("width")),f=m(r.attr("height")),n=r.attr("style");if(n&&n.indexOf("vertical-align:")==0&&n.indexOf("ex;")==n.length-3){n=m(n.substr(16,n.length-17))}else{n=null}o=(!o||(o<=0.5))?1:Math.round(o);f=(!f||(f<=0.5))?1:Math.round(f);r.attr("width",o).attr("height",f).attr("style",null);q.property("_valign",n);if(!a.nodejs){var p=j.GetBoundarySizes(q.node());o=1.05*p.width;f=1.05*p.height}if(q.property("_scale")){c=Math.max(c,o/q.property("_width"),f/q.property("_height"))}})}if(k){k.each(function(){var A=b.select(this);if(A.node().parentNode!==l.node()){return}var w=A.property("_valign"),n=A.select("svg"),x=parseInt(n.attr("width")),t=parseInt(n.attr("height"));if(!isNaN(t)&&!isNaN(x)){if(c>0){x=x/c;t=t/c;n.attr("width",Math.round(x)).attr("height",Math.round(t))}}else{var r=j.GetBoundarySizes(A.node());x=r.width||x||100;t=r.height||t||10}if((c>0)&&w){w=w/c}if(w===null){w=(e-t)/2}var u=A.property("_align"),p=A.property("_rotate"),o=A.property("_width"),y=A.property("_height"),v={x:A.property("_x"),y:A.property("_y")};var f={x:1,y:1},s="x",q="y";if(p==180){f.x=f.y=-1}else{if((p==270)||(p==90)){f.x=(p===270)?-1:1;f.y=-f.x;s="y";q="x"}}if(!A.property("_scale")){o=y=0}if(u[0]=="middle"){v[s]+=f.x*(o-x)/2}else{if(u[0]=="end"){v[s]+=f.x*(o-x)}}if(u[1]=="middle"){v[q]+=f.y*(y-t)/2}else{if(u[1]=="bottom"){v[q]+=f.y*(y-t)}else{if(u[1]=="bottom-base"){v[q]+=f.y*(y-t-w)}}}var z="translate("+v.x+","+v.y+")";if(p!==0){z+=" rotate("+p+",0,0)"}A.attr("transform",z).attr("visibility",null)})}l.selectAll(".hidden_text").attr("opacity","1").classed("hidden_text",false);if(!i){i=l.node().text_callback}l.node().text_callback=null;l.property("draw_text_completed",true);a.CallBack(i);return l.property("max_text_width")};a.TObjectPainter.prototype.DrawText=function(r,m,k,n,A,i,C,o,D){if(!D){D=this.draw_g}var t;if(typeof r=="string"){t=r.split(";");if(t.length==1){t.push("middle")}}else{t=["start","middle"];if((r/10)>=3){t[0]="end"}else{if((r/10)>=2){t[0]="middle"}}if((r%10)==0){t[1]="bottom"}else{if((r%10)==1){t[1]="bottom-base"}else{if((r%10)==3){t[1]="top"}}}}var E=(n>0)&&(A>0);if(o==null){o=1}if(o<2){if(!a.Painter.isAnyLatex(i)){o=0}}var v=((a.gStyle.MathJax<1)&&(o!==2))||(o<1),q=D.property("text_font");if(v){if(o>0){i=a.Painter.translateLaTeX(i)}var d=m.toFixed(1),c=k.toFixed(1),j="",f=false;if(n>0){if(t[0]=="middle"){d=(m+n*0.5).toFixed(1)}else{if(t[0]=="end"){d=(m+n).toFixed(1)}}}if(A>0){if(t[1].indexOf("bottom")===0){c=(k+A).toFixed(1)}else{if(t[1]=="top"){j=".8em"}else{c=(k+A/2+1).toFixed(1);if(a.browser.isIE){j=".4em"}else{f=true}}}}else{if(t[1]=="top"){j=".8em"}else{if(t[1]=="middle"){if(a.browser.isIE){j=".4em"}else{f=true}}}}var g="translate("+d+","+c+")";if(!E&&(A<0)){g+=" rotate("+(-A)+",0,0)"}var p=D.append("text").attr("text-anchor",t[0]).attr("x",0).attr("y",0).attr("fill",C?C:null).attr("transform",g).text(i);if(j){p.attr("dy",j)}if(f){p.attr("dominant-baseline","middle")}D.property("normaltext_use",true);var l=!a.nodejs?this.GetBoundarySizes(p.node()):{height:Math.round(q.size*1.2),width:Math.round(i.length*q.size*0.4)};if(E){p.classed("hidden_text",true).attr("opacity","0")}if(l.width>D.property("max_text_width")){D.property("max_text_width",l.width)}if((n>0)&&E){this.TextScaleFactor(1.05*l.width/n,D)}if((A>0)&&E){this.TextScaleFactor(1*l.height/A,D)}return l.width}n=Math.round(n);A=Math.round(A);m=Math.round(m);k=Math.round(k);var u=0;if(!E&&A<0){u=Math.abs(A);A=0}var z=a.Painter.translateMath(i,o,C),s=D.append("svg:g").attr("class","math_svg").attr("visibility","hidden").property("_x",m).property("_y",k).property("_width",n).property("_height",A).property("_scale",E).property("_rotate",u).property("_align",t);D.property("mathjax_use",true);if(a.nodejs){if(!a.nodejs_mathjax){a.nodejs_mathjax=require("mathjax-node");a.nodejs_mathjax.config({TeX:{extensions:["color.js"]},SVG:{mtextFontInherit:true,minScaleAdjust:100,matchFontHeight:true,useFontCache:false}});a.nodejs_mathjax.start()}if((z.indexOf("\\(")==0)&&(z.lastIndexOf("\\)")==z.length-2)){z=z.substr(2,z.length-4)}a.nodejs_mathjax.typeset({jsroot_painter:this,jsroot_drawg:D,jsroot_fog:s,ex:q.size,math:z,useFontCache:false,useGlobalCache:false,format:"TeX",svg:true},function(w,h){if(!w.errors){h.jsroot_fog.html(w.svg)}else{console.log("MathJax error",h.math);h.jsroot_fog.html("<svg></svg>")}h.jsroot_painter.FinishTextDrawing(h.jsroot_drawg)});return 0}var e=document.createElement("p");b.select(e).style("visibility","hidden").style("overflow","hidden").style("position","absolute").style("font-size",q.size+"px").style("font-family",q.name).html("<mtext>"+z+"</mtext>");document.body.appendChild(e);s.property("_element",e);var B=this;a.AssertPrerequisites("mathjax",function(){MathJax.Hub.Typeset(e,["FinishMathjax",B,D,s]);MathJax.Hub.Queue(["FinishMathjax",B,D,s])});return 0};a.TObjectPainter.prototype.FinishMathjax=function(c,e,g){if(e.node().parentNode!==c.node()){return}var d=e.property("_element");if(!d){return}var f=b.select(d).select("svg");if(f.empty()){return}e.property("_element",null);f.remove();document.body.removeChild(d);e.append(function(){return f.node()});this.FinishTextDrawing(c)};a.TFramePainter=function(c){a.TObjectPainter.call(this,c);this.tooltip_enabled=true;this.tooltip_allowed=(a.gStyle.Tooltip>0)};a.TFramePainter.prototype=Object.create(a.TObjectPainter.prototype);a.TFramePainter.prototype.Shrink=function(d,c){this.fX1NDC+=d;this.fX2NDC-=c};a.TFramePainter.prototype.UpdateAttributes=function(d){var e=this.root_pad(),c=this.GetObject();if((this.fX1NDC===undefined)||(d&&!this.modified_NDC)){if(!e){a.extend(this,a.gStyle.FrameNDC)}else{a.extend(this,{fX1NDC:e.fLeftMargin,fX2NDC:1-e.fRightMargin,fY1NDC:e.fBottomMargin,fY2NDC:1-e.fTopMargin})}}if(this.fillatt===undefined){if(c){this.fillatt=this.createAttFill(c)}else{if(e){this.fillatt=this.createAttFill(null,e.fFrameFillStyle,e.fFrameFillColor)}else{this.fillatt=this.createAttFill(null,1001,0)}}}if(this.lineatt===undefined){this.lineatt=a.Painter.createAttLine(c?c:"black")}};a.TFramePainter.prototype.SizeChanged=function(){var d=this.root_pad(),c=this.main_painter();if(d){d.fLeftMargin=this.fX1NDC;d.fRightMargin=1-this.fX2NDC;d.fBottomMargin=this.fY1NDC;d.fTopMargin=1-this.fY2NDC;if(c){c.SetRootPadRange(d)}}this.RedrawPad()};a.TFramePainter.prototype.Redraw=function(){this.UpdateAttributes();var d=this.pad_width(),r=this.pad_height(),k=Math.round(d*this.fX1NDC),p=Math.round(d*(this.fX2NDC-this.fX1NDC)),q=Math.round(r*(1-this.fY2NDC)),j=Math.round(r*(this.fY2NDC-this.fY1NDC));this.draw_g=this.svg_frame();if(this.draw_g.empty()){return console.error("did not found frame layer")}var e=this.draw_g.select("rect"),f=this.draw_g.select(".main_layer");if(f.empty()){this.draw_g.append("svg:title").text("");e=this.draw_g.append("svg:rect");this.draw_g.append("svg:g").attr("class","grid_layer");f=this.draw_g.append("svg:svg").attr("class","main_layer").attr("x",0).attr("y",0).attr("overflow","hidden");this.draw_g.append("svg:g").attr("class","axis_layer");this.draw_g.append("svg:g").attr("class","upper_layer")}this.draw_g.property("frame_painter",this);this.draw_g.attr("x",k).attr("y",q).attr("width",p).attr("height",j).property("draw_x",k).property("draw_y",q).property("draw_width",p).property("draw_height",j).attr("transform","translate("+k+","+q+")");e.attr("x",0).attr("y",0).attr("width",p).attr("height",j).call(this.fillatt.func).call(this.lineatt.func);f.attr("width",p).attr("height",j).attr("viewBox","0 0 "+p+" "+j);this.AddDrag({obj:this,only_resize:true,minwidth:20,minheight:20,redraw:this.SizeChanged.bind(this)});var c=this.draw_g.select(".interactive_rect");if(a.gStyle.Tooltip===0){return c.remove()}var m=this;function o(){var h=b.mouse(c.node());m.ProcessTooltipEvent({x:h[0],y:h[1],touch:false})}function g(){m.ProcessTooltipEvent(null)}function i(){var h=b.touches(c.node());if(!h||h.length!==1){return m.ProcessTooltipEvent(null)}m.ProcessTooltipEvent({x:h[0][0],y:h[0][1],touch:true})}function l(){m.ProcessTooltipEvent(null)}if(c.empty()){c=this.draw_g.append("rect").attr("class","interactive_rect").style("opacity",0).style("fill","none").style("pointer-events","visibleFill").on("mouseenter",o).on("mousemove",o).on("mouseleave",g);if(a.touches){c.on("touchstart",i).on("touchmove",i).on("touchend",l).on("touchcancel",l)}}c.attr("x",0).attr("y",0).attr("width",p).attr("height",j);var n=this.svg_layer("stat_layer").select(".objects_hints");if(!n.empty()&&(a.gStyle.Tooltip>0)){setTimeout(this.ProcessTooltipEvent.bind(this,n.property("last_point")),10)}};a.TFramePainter.prototype.FillContextMenu=function(f){var c=this.main_painter(),e=f.size()==0,d=this.root_pad();if(e){f.add("header:Frame")}else{f.add("separator")}if(c){if(c.zoom_xmin!==c.zoom_xmax){f.add("Unzoom X",c.Unzoom.bind(c,"x"))}if(c.zoom_ymin!==c.zoom_ymax){f.add("Unzoom Y",c.Unzoom.bind(c,"y"))}if(c.zoom_zmin!==c.zoom_zmax){f.add("Unzoom Z",c.Unzoom.bind(c,"z"))}f.add("Unzoom all",c.Unzoom.bind(c,"xyz"));if(d){f.addchk(d.fLogx,"SetLogx",c.ToggleLog.bind(c,"x"));f.addchk(d.fLogy,"SetLogy",c.ToggleLog.bind(c,"y"));if(c.Dimension()==2){f.addchk(d.fLogz,"SetLogz",c.ToggleLog.bind(c,"z"))}}f.add("separator")}f.addchk(this.tooltip_allowed,"Show tooltips",function(){var g=this.frame_painter();if(g){g.tooltip_allowed=!g.tooltip_allowed}});this.FillAttContextMenu(f,e?"":"Frame ");f.add("separator");f.add("Save as frame.png",function(g){var h=this.svg_frame();if(!h.empty()){a.saveSvgAsPng(h.node(),{name:"frame.png"})}});return true};a.saveSvgAsPng=function(d,c,e){a.AssertPrerequisites("savepng",function(){a.saveSvgAsPng(d,c,e)})};a.TFramePainter.prototype.IsTooltipShown=function(){if(a.gStyle.Tooltip<1){return false}return !(this.svg_layer("stat_layer").select(".objects_hints").empty())};a.TFramePainter.prototype.ProcessTooltipEvent=function(ae,t){if(t!==undefined){this.tooltip_enabled=t}var X=[],O=0,D=0,K=0,M=false,aa=11,H=3,I=3,q=1.2,g=this.frame_height(),c=this.frame_width(),N=this.pad_width(),B=this.frame_x(),y=this.pad_painter(true),J=this.pad_height()-this.draw_g.property("draw_y"),ad=a.Painter.getFontDetails(160,aa),V=this.GetShowStatusFunc(),ag=!this.tooltip_allowed||!this.tooltip_enabled;if((ae===undefined)||(ag&&!V)){ae=null}if(ae&&ag){ae.disabled=true}if(y){X=y.GetTooltips(ae)}if(ae&&ae.touch){aa=15}for(var Y=0;Y<X.length;++Y){var G=X[Y];if(!G){continue}if(!G.lines||(G.lines.length===0)){X[Y]=null;continue}for(var ab=0;ab<Y;++ab){var m=X[ab],L=false;if(!m||(m.lines.length!==G.lines.length)){continue}for(var Z=0;Z<G.lines.length&&!L;++Z){if(m.lines[Z]!==G.lines[Z]){L=true}}if(!L){X[Y]=null;break}}if(!X[Y]){continue}O++;for(var Z=0;Z<G.lines.length;++Z){D=Math.max(D,G.lines[Z].length)}G.height=Math.round(G.lines.length*aa*q+2*H-aa*(q-1));if((G.color1!==undefined)&&(G.color1!=="none")){if((K!==0)&&(K!==G.color1)){M=true}K=G.color1}}var j=this.svg_layer("stat_layer"),h=j.select(".objects_hints");if(V){var Q="",z="",f="",af="";if(ae){f=Math.round(ae.x)+","+Math.round(ae.y)}var G=null,T=10000000000,v=null;if(X&&X.length>0){for(var ab=0;ab<X.length;++ab){if(!X[ab]){continue}if(!G){G=X[ab]}if(X[ab].exact&&(!G||!G.exact)){G=X[ab];break}if(!ae||(X[ab].x===undefined)||(X[ab].y===undefined)){continue}var e=(ae.x-X[ab].x)*(ae.x-X[ab].x)+(ae.y-X[ab].y)*(ae.y-X[ab].y);if(e<T){T=e;v=X[ab]}}}if((!G||!G.exact)&&(T<400)){G=v}if(G){z=(G.lines&&G.lines.length>1)?G.lines[0]:G.name;Q=G.title||"";af=G.line;if(!af&&G.lines){af=G.lines.slice(1).join(" ")}}V(z,Q,af,f)}if(!ae||ag||(X.length===0)||(D===0)||(O>15)){h.remove();return}if(h.empty()){h=j.append("svg:g").attr("class","objects_hints").style("pointer-events","none")}h.attr("transform",this.draw_g.attr("transform"));h.property("last_point",ae);var w=h.property("viewmode");if(w===undefined){w=""}var ac=0,C=ae.x+15;if(O>1){var A=0.5,F=0.5;if(w=="left"){F=0.7}else{if(w=="right"){A=0.3}}if(ae.x<=A*c){w="left";C=20}else{if(ae.x>=F*c){w="right";C=c-60}else{C=h.property("startx")}}}else{w="single"}if(w!==h.property("viewmode")){h.property("viewmode",w);h.selectAll("*").remove()}var x=10,u=10,i=-1111,U=-1111;function d(r){for(var l=0;(l<X.length)&&(r<J);++l){var k=X[l];if(!k){continue}if((k.y>=r-5)&&(k.y<=r+k.height+5)){r=k.y+10;l=-1}}return r}for(var Y=0;Y<X.length;++Y){var G=X[Y],E=h.select(".painter_hint_"+Y);if(G===null){E.remove();continue}var P=E.empty();if(P){E=h.append("svg:svg").attr("class","painter_hint_"+Y).attr("opacity",0).style("overflow","hidden").style("pointer-events","none")}if(w=="single"){x=ae.touch?(ae.y-G.height-5):Math.min(ae.y+15,J-G.height-3)}else{u=d(u);if((i===-1111)&&(U===-1111)){i=U=G.x}i=Math.min(i,G.x);U=Math.min(U,G.x)}E.attr("x",C).attr("y",x).property("gapy",u);x+=G.height+5;u+=G.height+5;if(!P){E.selectAll("*").remove()}E.attr("width",60).attr("height",G.height);var W=E.append("rect").attr("x",0).attr("y",0).attr("width",60).attr("height",G.height).attr("fill","lightgrey").style("pointer-events","none");if(O>1){var p=M?G.color1:G.color2;if((p!==undefined)&&(p!=="none")){W.attr("stroke",p).attr("stroke-width",G.exact?3:1)}}if(G.lines!=null){for(var Z=0;Z<G.lines.length;Z++){if(G.lines[Z]!==null){var s=E.append("svg:text").attr("text-anchor","start").attr("x",I).attr("y",H+Z*aa*q).attr("dy",".8em").attr("fill","black").style("pointer-events","none").call(ad.func).text(G.lines[Z]);var o=this.GetBoundarySizes(s.node());ac=Math.max(ac,o.width)}}}function R(){return function(n,l,k){return function(r){return r<0.8?"0":(r-0.8)*5}}}if(P){if(a.gStyle.TooltipAnimation>0){E.transition().duration(a.gStyle.TooltipAnimation).attrTween("opacity",R())}else{E.attr("opacity",1)}}}ac+=2*I;var S=h.selectAll("svg");if((w=="right")&&(C+ac>c-20)){C=c-ac-20;S.attr("x",C)}if((w=="single")&&(C+ac>N-B)&&(C>ac+20)){C-=(ac+20);S.attr("x",C)}if((w!=="single")&&(u<J)&&(u!==x)){if((i<=C+ac+5)&&(U>=C-5)){S.attr("y",function(){return b.select(this).property("gapy")})}}if(ac>10){S.attr("width",ac).select("rect").attr("width",ac)}h.property("startx",C)};a.Painter.drawFrame=function(e,d){var c=new a.TFramePainter(d);c.SetDivId(e,2);c.Redraw();return c.DrawingReady()};a.TPavePainter=function(c){a.TObjectPainter.call(this,c);this.Enabled=true;this.UseContextMenu=true;this.UseTextColor=false;this.FirstRun=1;this.AssignFinishPave()};a.TPavePainter.prototype=Object.create(a.TObjectPainter.prototype);a.TPavePainter.prototype.AssignFinishPave=function(){function c(){if(this.FirstRun<=0){return}this.FirstRun--;if(this.FirstRun!==0){return}delete this.FinishPave;this.DrawingReady()}this.FinishPave=c.bind(this)};a.TPavePainter.prototype.DrawPave=function(i){this.UseTextColor=false;if(!this.Enabled){return this.RemoveDrawG()}var j=this.GetObject();if(j.fInit===0){j.fInit=1;var f=this.root_pad();if(j.fOption.indexOf("NDC")>=0){j.fX1NDC=j.fX1;j.fX2NDC=j.fX2;j.fY1NDC=j.fY1;j.fY2NDC=j.fY2}else{if(f!==null){if(f.fLogx){if(j.fX1>0){j.fX1=a.log10(j.fX1)}if(j.fX2>0){j.fX2=a.log10(j.fX2)}}if(f.fLogy){if(j.fY1>0){j.fY1=a.log10(j.fY1)}if(j.fY2>0){j.fY2=a.log10(j.fY2)}}j.fX1NDC=(j.fX1-f.fX1)/(f.fX2-f.fX1);j.fY1NDC=(j.fY1-f.fY1)/(f.fY2-f.fY1);j.fX2NDC=(j.fX2-f.fX1)/(f.fX2-f.fX1);j.fY2NDC=(j.fY2-f.fY1)/(f.fY2-f.fY1)}else{j.fX1NDC=j.fY1NDC=0.1;j.fX2NDC=j.fY2NDC=0.9}}}var c=Math.round(j.fX1NDC*this.pad_width()),k=Math.round((1-j.fY2NDC)*this.pad_height()),d=Math.round((j.fX2NDC-j.fX1NDC)*this.pad_width()),h=Math.round((j.fY2NDC-j.fY1NDC)*this.pad_height()),e=j.fBorderSize;this.RecreateDrawG(true,this.IsStats()?"stat_layer":"text_layer");this.draw_g.attr("x",c).attr("y",k).attr("width",d).attr("height",h).attr("transform","translate("+c+","+k+")");if((e>1)&&(j.fShadowColor>0)){this.draw_g.append("svg:path").attr("d","M"+d+","+h+" v"+(-h+e)+" h"+e+" v"+h+" h"+(-d)+" v"+(-e)+" Z").style("fill",a.Painter.root_colors[j.fShadowColor]).style("stroke",a.Painter.root_colors[j.fShadowColor]).style("stroke-width","1px")}if(this.lineatt===undefined){this.lineatt=a.Painter.createAttLine(j,e>0?1:0)}if(this.fillatt===undefined){this.fillatt=this.createAttFill(j)}var g=this.draw_g.append("rect").attr("x",0).attr("y",0).attr("width",d).attr("height",h).call(this.fillatt.func).call(this.lineatt.func);if("PaveDrawFunc" in this){this.PaveDrawFunc(d,h,i)}if(a.BatchMode){return}g.style("pointer-events","visibleFill").on("mouseenter",this.ShowObjectStatus.bind(this));this.AddDrag({obj:j,minwidth:10,minheight:20,redraw:this.DrawPave.bind(this),ctxmenu:a.touches&&a.gStyle.ContextMenu&&this.UseContextMenu});if(this.UseContextMenu&&a.gStyle.ContextMenu){this.draw_g.on("contextmenu",this.ShowContextMenu.bind(this))}};a.TPavePainter.prototype.DrawPaveLabel=function(e,c){this.UseTextColor=true;var d=this.GetObject();this.StartTextDrawing(d.fTextFont,c/1.2);this.DrawText(d.fTextAlign,0,0,e,c,d.fLabel,a.Painter.root_colors[d.fTextColor]);this.FinishTextDrawing(null,this.FinishPave)};a.TPavePainter.prototype.DrawPaveText=function(B,q,d){if(d&&this.IsStats()){this.FillStatistic()}var v=this.GetObject(),L=a.Painter.root_colors[v.fTextColor],I=v.fBorderSize,K=0,G=0,p=v.fLines.arr.length,c=[],H=0,s=(v.fLabel.length>0)&&!this.IsStats();if(s){this.FirstRun++}for(var E=0;E<p;++E){var o=v.fLines.arr[E].fTitle;c.push(o);if(E>0){H=Math.max(H,o.length)}if(!this.IsStats()||(E==0)||(o.indexOf("|")<0)){continue}if(K===0){K=E}var A=o.split("|");if(A.length>G){G=A.length}}if((p===1)&&!this.IsStats()&&(c[0].indexOf("#splitline{")===0)&&(c[0][c[0].length-1]=="}")){var g=c[0].indexOf("}{");if((g>0)&&(g==c[0].lastIndexOf("}{"))){c[1]=c[0].substr(g+2,c[0].length-g-3);c[0]=c[0].substr(11,g-11);p=2;this.UseTextColor=true}}var z=q/p,f=false,J=v.fMargin*B;this.StartTextDrawing(v.fTextFont,q/(p*1.2));if(p==1){this.DrawText(v.fTextAlign,0,0,B,q,c[0],L);this.UseTextColor=true}else{for(var E=0;E<p;++E){var u=E*z,D=L;if(!this.UseTextColor&&(E<v.fLines.arr.length)&&(v.fLines.arr[E].fTextColor!==0)){D=a.Painter.root_colors[v.fLines.arr[E].fTextColor]}if(D===undefined){D=L;this.UseTextColor=true}if(this.IsStats()){if((K>0)&&(E>=K)){var A=c[E].split("|");for(var t=0;t<A.length;++t){this.DrawText("middle",B*t/G,u,B/G,z,A[t],D)}}else{if(c[E].indexOf("=")<0){if(E==0){f=true;if(c[E].length>H+5){c[E]=c[E].substr(0,H+2)+"..."}}this.DrawText((E==0)?"middle":"start",J,u,B-2*J,z,c[E],D)}else{var A=c[E].split("="),k=0;for(var t=0;t<2;++t){k+=this.DrawText((t==0)?"start":"end",J,u,B-2*J,z,A[t],D)}this.TextScaleFactor(1.05*k/(B-2*J),this.draw_g)}}}else{this.DrawText(v.fTextAlign,J,u,B-2*J,z,c[E],D)}}}this.FinishTextDrawing(undefined,this.FinishPave);if((I>0)&&f){this.draw_g.append("svg:line").attr("x1",0).attr("y1",z.toFixed(1)).attr("x2",B).attr("y2",z.toFixed(1)).call(this.lineatt.func)}if((K>0)&&(G>1)){for(var C=K;C<p;++C){this.draw_g.append("svg:line").attr("x1",0).attr("y1",(C*z).toFixed(1)).attr("x2",B).attr("y2",(C*z).toFixed(1)).call(this.lineatt.func)}for(var r=0;r<G-1;++r){this.draw_g.append("svg:line").attr("x1",(B/G*(r+1)).toFixed(1)).attr("y1",(K*z).toFixed(1)).attr("x2",(B/G*(r+1)).toFixed(1)).attr("y2",q).call(this.lineatt.func)}}if(s){var l=Math.round(B*0.25),i=Math.round(-q*0.02),m=Math.round(B*0.5),F=Math.round(q*0.04);var e=this.draw_g.append("svg:g");e.append("rect").attr("x",l).attr("y",i).attr("width",m).attr("height",F).call(this.fillatt.func).call(this.lineatt.func);this.StartTextDrawing(v.fTextFont,F/1.5,e);this.DrawText(22,l,i,m,F,v.fLabel,L,1,e);this.FinishTextDrawing(e,this.FinishPave);this.UseTextColor=true}};a.TPavePainter.prototype.Format=function(f,c){if(!c){c="stat"}var e=this.GetObject();if(c=="stat"){c=e.fStatFormat;if(!c){c=a.gStyle.fStatFormat}}else{if(c=="fit"){c=e.fFitFormat;if(!c){c=a.gStyle.fFitFormat}}else{if(c=="entries"){if(f<1000000000){return f.toFixed(0)}c="14.7g"}else{if(c=="last"){c=this.lastformat}}}}delete this.lastformat;if(!c){c="6.4g"}var d=a.FFormat(f,c);this.lastformat=a.lastFFormat;return d};a.TPavePainter.prototype.FillContextMenu=function(e){var d=this.GetObject();e.add("header: "+d._typename+"::"+d.fName);if(this.IsStats()){e.add("Default position",function(){d.fX2NDC=a.gStyle.fStatX;d.fX1NDC=d.fX2NDC-a.gStyle.fStatW;d.fY2NDC=a.gStyle.fStatY;d.fY1NDC=d.fY2NDC-a.gStyle.fStatH;d.fInit=1;this.Redraw()});e.add("SetStatFormat",function(){var f=prompt("Enter StatFormat",d.fStatFormat);if(f!=null){d.fStatFormat=f;this.Redraw()}});e.add("SetFitFormat",function(){var f=prompt("Enter FitFormat",d.fFitFormat);if(f!=null){d.fFitFormat=f;this.Redraw()}});e.add("separator");e.add("sub:SetOptStat",function(){var f=prompt("Enter OptStat",d.fOptStat);if(f!=null){d.fOptStat=parseInt(f);this.Redraw()}});function c(h,f){var g=(h<10)?d.fOptStat:d.fOptFit;g=parseInt(parseInt(g)/parseInt(Math.pow(10,h%10)))%10;e.addchk(g,f,g*100+h,function(i){var k=(i%100<10)?d.fOptStat:d.fOptFit;var j=parseInt(i/100);k-=(j>0?j:-1)*parseInt(Math.pow(10,i%10));if(i%100<10){d.fOptStat=k}else{d.fOptFit=k}this.Redraw()})}c(0,"Histogram name");c(1,"Entries");c(2,"Mean");c(3,"Std Dev");c(4,"Underflow");c(5,"Overflow");c(6,"Integral");c(7,"Skewness");c(8,"Kurtosis");e.add("endsub:");e.add("sub:SetOptFit",function(){var f=prompt("Enter OptStat",d.fOptFit);if(f!=null){d.fOptFit=parseInt(f);this.Redraw()}});c(10,"Fit parameters");c(11,"Par errors");c(12,"Chi square / NDF");c(13,"Probability");e.add("endsub:");e.add("separator")}else{if(d.fName==="title"){e.add("Default position",function(){d.fX1NDC=0.28;d.fY1NDC=0.94;d.fX2NDC=0.72;d.fY2NDC=0.99;d.fInit=1;this.Redraw()})}}if(this.UseTextColor){this.TextAttContextMenu(e)}this.FillAttContextMenu(e);return e.size()>0};a.TPavePainter.prototype.ShowContextMenu=function(c){if(!c){b.event.stopPropagation();b.event.preventDefault();c=b.event}a.Painter.createMenu(this,function(d){d.painter.FillContextMenu(d);d.show(c)})};a.TPavePainter.prototype.IsStats=function(){return this.MatchObjectType("TPaveStats")};a.TPavePainter.prototype.FillStatistic=function(){var e=this.GetObject(),c=this.main_painter();if(e.fName!=="stats"){return false}if((c===null)||!("FillStatistic" in c)){return false}if(c.IsDummyHisto()){return true}var d=parseInt(e.fOptStat),f=parseInt(e.fOptFit);if(isNaN(d)){d=a.gStyle.fOptStat}if(isNaN(f)){f=a.gStyle.fOptFit}e.Clear();c.FillStatistic(this,d,f);return true};a.TPavePainter.prototype.UpdateObject=function(d){if(!this.MatchObjectType(d)){return false}var c=this.GetObject();if(!("modified_NDC" in c)){c.fInit=d.fInit;c.fX1=d.fX1;c.fX2=d.fX2;c.fY1=d.fY1;c.fY2=d.fY2;c.fX1NDC=d.fX1NDC;c.fX2NDC=d.fX2NDC;c.fY1NDC=d.fY1NDC;c.fY2NDC=d.fY2NDC}if(d._typename==="TPaveText"){c.fLines=a.clone(d.fLines);return true}else{if(d._typename==="TPaveLabel"){c.fLabel=d.fLabel;return true}else{if(d._typename==="TPaveStats"){c.fOptStat=d.fOptStat;c.fOptFit=d.fOptFit;return true}else{if(d._typename==="TLegend"){c.fPrimitives=d.fPrimitives;c.fNColumns=d.fNColumns;return true}}}}return false};a.TPavePainter.prototype.Redraw=function(){this.DrawPave(true)};a.Painter.drawPaveText=function(g,f,e){var d=((typeof e=="string")&&(e.indexOf("onpad:")==0))?e.substr(6):undefined;var c=new a.TPavePainter(f);c.SetDivId(g,2,d);switch(f._typename){case"TPaveLabel":c.PaveDrawFunc=c.DrawPaveLabel;break;case"TPaveStats":case"TPaveText":c.PaveDrawFunc=c.DrawPaveText;break}c.Redraw();if(!this.PaveDrawFunc){c.DrawingReady()}return c};a.TPadPainter=function(d,c){a.TObjectPainter.call(this,d);this.pad=d;this.iscan=c;this.this_pad_name="";if(!this.iscan&&(d!==null)&&("fName" in d)){this.this_pad_name=d.fName.replace(" ","_")}this.painters=[];this.has_canvas=true};a.TPadPainter.prototype=Object.create(a.TObjectPainter.prototype);a.TPadPainter.prototype.Cleanup=function(){var c=this.svg_pad();if(c){c.property("pad_painter",null);c.property("mainpainter",null)}this.painters=[];this.pad=null;this.this_pad_name="";this.has_canvas=false;a.TObjectPainter.prototype.Cleanup.call(this)};a.TPadPainter.prototype.ForEachPainterInPad=function(d,f){d(this);for(var c=0;c<this.painters.length;++c){var e=this.painters[c];if(typeof e.ForEachPainterInPad==="function"){e.ForEachPainterInPad(d,f)}else{if(!f){d(e)}}}};a.TPadPainter.prototype.ButtonSize=function(c){return Math.round((!c?1:c)*(this.iscan||!this.has_canvas?16:12))};a.TPadPainter.prototype.ToggleEventStatus=function(){if(this.enlarge_main("state")==="on"){return}this.has_event_status=!this.has_event_status;if(a.Painter.ShowStatus){this.has_event_status=false}var d=this.layout_main(this.has_event_status||this._websocket?"canvas":"simple");var f=this.select_main("footer");if(!this.has_event_status){f.html("");delete this.status_layout;delete this.ShowStatus;delete this.ShowStatusFunc}else{this.status_layout=new a.GridDisplay(f.node(),"horizx4_1213");var e=["object name","object title","mouse coordiantes","object info"];for(var c=0;c<4;++c){b.select(this.status_layout.GetFrame(c)).attr("title",e[c]).style("overflow","hidden").append("label").attr("class","jsroot_status_label")}this.ShowStatusFunc=function(g,j,h,i){if(!this.status_layout){return}$(this.status_layout.GetFrame(0)).children("label").text(g||"");$(this.status_layout.GetFrame(1)).children("label").text(j||"");$(this.status_layout.GetFrame(2)).children("label").text(i||"");$(this.status_layout.GetFrame(3)).children("label").text(h||"")};this.ShowStatus=this.ShowStatusFunc.bind(this);this.ShowStatus("canvas","title","info","")}if(d){this.CheckCanvasResize()}};a.TPadPainter.prototype.ShowCanvasMenu=function(c){b.event.stopPropagation();b.event.preventDefault();var e=b.event;function d(f){if(!this._websocket){return}console.log("click",f);if(f=="Interrupt"){this._websocket.send("GEXE:gROOT->SetInterrupt()")}if(f=="Quit ROOT"){this._websocket.send("GEXE:gApplication->Terminate(0)")}}a.Painter.createMenu(this,function(j){switch(c){case"File":j.add("Close canvas",d);j.add("separator");j.add("Save PNG",d);var i=["ps","eps","pdf","tex","gif","jpg","png","C","root"];j.add("sub:Save");for(var g in i){j.add("canvas."+i[g],d)}j.add("endsub:");j.add("separator");j.add("Interrupt",d);j.add("separator");j.add("Quit ROOT",d);break;case"Edit":j.add("Clear pad",d);j.add("Clear canvas",d);break;case"View":j.addchk(j.painter.has_event_status,"Event status",j.painter.ToggleEventStatus.bind(j.painter));var h=j.painter.frame_painter();j.addchk(h&&h.tooltip_allowed,"Tooltip info",function(){if(h){h.tooltip_allowed=!h.tooltip_allowed}});break;case"Options":var f=j.painter.main_painter();j.addchk(f&&f.ToggleStat("only-check"),"Statistic",function(){if(f){f.ToggleStat()}});j.addchk(f&&f.ToggleTitle("only-check"),"Histogram title",function(){if(f){f.ToggleTitle()}});j.addchk(f&&f.ToggleStat("fitpar-check"),"Fit parameters",function(){if(f){f.ToggleStat("fitpar-toggle")}});break;case"Tools":j.add("Inspector",d);break;case"Help":j.add("header:Basic help on...");j.add("Canvas",d);j.add("Menu",d);j.add("Browser",d);j.add("separator");j.add("About ROOT",d);break}if(j.size()>0){j.show(e)}})};a.TPadPainter.prototype.CreateCanvasMenu=function(){if(this.enlarge_main("state")==="on"){return}this.layout_main("canvas");var g=this.select_main("header");g.html("").style("background","lightgrey");var e=["File","Edit","View","Options","Tools","Help"];var c=this;for(var d in e){var f=g.append("p").attr("class","canvas_menu").text(e[d]);if(e[d]=="Help"){f.style("float","right")}f.on("click",this.ShowCanvasMenu.bind(this,e[d]))}};a.TPadPainter.prototype.CreateCanvasSvg=function(c,i){var g=null,f=null,j=5,h=null;if(c>0){f=this.svg_canvas();g=f.property("height_factor");h=this.check_main_resize(c,null,g);if(!h.changed){return false}}else{if(this._websocket){this.CreateCanvasMenu()}var d=this.select_main();if(d.style("position")=="static"){d.style("position","relative")}f=d.append("svg").attr("class","jsroot root_canvas").property("pad_painter",this).property("mainpainter",null).property("current_pad","").property("redraw_by_resize",false);f.append("svg:title").text("ROOT canvas");var e=f.append("svg:rect").attr("class","canvas_fillrect").attr("x",0).attr("y",0);if(!a.BatchMode){e.style("pointer-events","visibleFill").on("dblclick",this.EnlargePad.bind(this)).on("mouseenter",this.ShowObjectStatus.bind(this))}f.append("svg:g").attr("class","root_frame");f.append("svg:g").attr("class","subpads_layer");f.append("svg:g").attr("class","special_layer");f.append("svg:g").attr("class","text_layer");f.append("svg:g").attr("class","stat_layer");f.append("svg:g").attr("class","btns_layer");if(a.gStyle.ContextMenu){f.select(".canvas_fillrect").on("contextmenu",this.ShowContextMenu.bind(this))}g=0.66;if(this.pad&&this.pad.fCw&&this.pad.fCh&&(this.pad.fCw>0)){g=this.pad.fCh/this.pad.fCw;if((g<0.1)||(g>10)){g=0.66}}h=this.check_main_resize(2,i,g)}if(!this.fillatt||!this.fillatt.changed){this.fillatt=this.createAttFill(this.pad,1001,0)}if((h.width<=j)||(h.height<=j)){f.style("display","none");console.warn("Hide canvas while geometry too small w=",h.width," h=",h.height);h.width=200;h.height=100}else{f.style("display",null)}f.attr("x",0).attr("y",0).style("width","100%").style("height","100%").style("position","absolute").style("left",0).style("top",0).style("right",0).style("bottom",0);f.attr("viewBox","0 0 "+h.width+" "+h.height).attr("preserveAspectRatio","none").property("height_factor",g).property("draw_x",0).property("draw_y",0).property("draw_width",h.width).property("draw_height",h.height);f.select(".canvas_fillrect").attr("width",h.width).attr("height",h.height).call(this.fillatt.func);this.svg_layer("btns_layer").attr("transform","translate(2,"+(h.height-this.ButtonSize(1.25))+")").attr("display",f.property("pad_enlarged")?"none":null);return true};a.TPadPainter.prototype.EnlargePad=function(){if(b.event){b.event.preventDefault();b.event.stopPropagation()}var d=this.svg_canvas(),c=d.property("pad_enlarged");if(this.iscan||!this.has_canvas||(!c&&!this.HasObjectsToDraw())){if(!this.enlarge_main("toggle")){return}if(this.enlarge_main("state")=="off"){d.property("pad_enlarged",null)}}else{if(!c){this.enlarge_main(true);d.property("pad_enlarged",this.pad)}else{if(c===this.pad){this.enlarge_main(false);d.property("pad_enlarged",null)}else{console.error("missmatch with pad double click events")}}}this.CheckResize({force:true})};a.TPadPainter.prototype.CreatePadSvg=function(p){if(!this.has_canvas){this.CreateCanvasSvg(p?2:0);return true}var o=this.svg_canvas(),c=o.property("draw_width"),n=o.property("draw_height"),f=o.property("pad_enlarged"),m=!f||(f===this.pad),l=Math.round(this.pad.fAbsWNDC*c),i=Math.round(this.pad.fAbsHNDC*n),k=Math.round(this.pad.fAbsXlowNDC*c),j=Math.round(n*(1-this.pad.fAbsYlowNDC))-i,d=null,g=null,e=null;if(f===this.pad){l=c;i=n;k=j=0}if(p){d=this.svg_pad(this.this_pad_name);g=d.select(".root_pad_border");e=this.svg_layer("btns_layer",this.this_pad_name)}else{d=o.select(".subpads_layer").append("g").attr("class","root_pad").attr("pad",this.this_pad_name).property("pad_painter",this).property("mainpainter",null);g=d.append("svg:rect").attr("class","root_pad_border");d.append("svg:g").attr("class","root_frame");d.append("svg:g").attr("class","special_layer");d.append("svg:g").attr("class","text_layer");d.append("svg:g").attr("class","stat_layer");e=d.append("svg:g").attr("class","btns_layer");if(a.gStyle.ContextMenu){g.on("contextmenu",this.ShowContextMenu.bind(this))}if(!a.BatchMode){g.attr("pointer-events","visibleFill").on("dblclick",this.EnlargePad.bind(this)).on("mouseenter",this.ShowObjectStatus.bind(this))}if(!this.fillatt||!this.fillatt.changed){this.fillatt=this.createAttFill(this.pad,1001,0)}if(!this.lineatt||!this.lineatt.changed){this.lineatt=a.Painter.createAttLine(this.pad)}if(this.pad.fBorderMode==0){this.lineatt.color="none"}}d.attr("transform","translate("+k+","+j+")").attr("display",m?null:"none").property("draw_x",k).property("draw_y",j).property("draw_width",l).property("draw_height",i);g.attr("x",0).attr("y",0).attr("width",l).attr("height",i).call(this.fillatt.func).call(this.lineatt.func);if(d.property("can3d")===1){this.select_main().select(".draw3d_"+this.this_pad_name).style("display",m?"":"none")}e.attr("transform","translate("+(l-(e.property("nextx")||0)-this.ButtonSize(1.25))+","+(i-this.ButtonSize(1.25))+")");return m};a.TPadPainter.prototype.CheckColors=function(d){if(!d||!d.fPrimitives){return}for(var c=0;c<d.fPrimitives.arr.length;++c){var e=d.fPrimitives.arr[c];if(e==null){continue}if((e._typename=="TObjArray")&&(e.name=="ListOfColors")){a.Painter.adoptRootColors(e);d.fPrimitives.arr.splice(c,1);d.fPrimitives.opt.splice(c,1);return}}};a.TPadPainter.prototype.RemovePrimitive=function(d){if((this.pad===null)||(this.pad.fPrimitives===null)){return}var c=this.pad.fPrimitives.arr.indexOf(d);if(c>=0){this.pad.fPrimitives.RemoveAt(c)}};a.TPadPainter.prototype.FindPrimitive=function(g,f,c){if((this.pad===null)||(this.pad.fPrimitives===null)){return null}for(var d=0;d<this.pad.fPrimitives.arr.length;d++){var e=this.pad.fPrimitives.arr[d];if((g!==null)&&(e!==g)){continue}if((f!==undefined)&&(f!==null)){if(e._typename!==f){continue}}if((c!==undefined)&&(c!==null)){if(e.fName!==c){continue}}return e}return null};a.TPadPainter.prototype.HasObjectsToDraw=function(){if((this.pad===null)||!this.pad.fPrimitives||(this.pad.fPrimitives.arr.length==0)){return false}for(var c=0;c<this.pad.fPrimitives.arr.length;++c){if(this.pad.fPrimitives.arr[c]&&this.pad.fPrimitives.arr[c]._typename!="TPad"){return true}}return false};a.TPadPainter.prototype.DrawPrimitive=function(d,e){if(!this.pad||(d>=this.pad.fPrimitives.arr.length)){return a.CallBack(e)}var c=a.draw(this.divid,this.pad.fPrimitives.arr[d],this.pad.fPrimitives.opt[d],this.DrawPrimitive.bind(this,d+1,e));if(c){c._primitive=true}};a.TPadPainter.prototype.GetTooltips=function(e){var c=[],d=[];if(this.painters!==null){this.painters.forEach(function(f){if("ProcessTooltip" in f){c.push(f)}})}if(e){e.nproc=c.length}c.forEach(function(f){var g=f.ProcessTooltip(e);d.push(g);if(g&&e.painters){g.painter=f}});return d};a.TPadPainter.prototype.FillContextMenu=function(d){if(this.pad){d.add("header: "+this.pad._typename+"::"+this.pad.fName)}else{d.add("header: Canvas")}d.addchk((a.gStyle.Tooltip>0),"Enable tooltips (global)",function(){a.gStyle.Tooltip=(a.gStyle.Tooltip===0)?1:-a.gStyle.Tooltip;var f=this;if(!this.iscan&&this.has_canvas){f=this.pad_painter()}if(f&&f.ForEachPainterInPad){f.ForEachPainterInPad(function(g){if(g.tooltip_allowed!==undefined){g.tooltip_allowed=(a.gStyle.Tooltip>0)}})}});if(!this._websocket){function c(g){this.pad[g]=this.pad[g]?0:1;var f=this.svg_pad(this.this_pad_name).property("mainpainter");if(!f){return}if((g.indexOf("fGrid")==0)&&(typeof f.DrawGrids=="function")){return f.DrawGrids()}if((g.indexOf("fTick")==0)&&(typeof f.DrawAxes=="function")){return f.DrawAxes()}}d.addchk(this.pad.fGridx,"Grid x","fGridx",c);d.addchk(this.pad.fGridy,"Grid y","fGridy",c);d.addchk(this.pad.fTickx,"Tick x","fTickx",c);d.addchk(this.pad.fTicky,"Tick y","fTicky",c);this.FillAttContextMenu(d)}d.add("separator");d.addchk(this.has_event_status,"Event status",this.ToggleEventStatus.bind(this));if(this.enlarge_main()||(this.has_canvas&&this.HasObjectsToDraw())){d.addchk((this.enlarge_main("state")=="on"),"Enlarge "+(this.iscan?"canvas":"pad"),this.EnlargePad.bind(this))}var e=this.this_pad_name;if(e.length===0){e=this.iscan?"canvas":"pad"}e+=".png";d.add("Save as "+e,e,this.SaveAsPng.bind(this,false));return true};a.TPadPainter.prototype.ShowContextMenu=function(d){if(!d){var c=b.mouse(this.svg_pad(this.this_pad_name).node());if(c&&(c.length==2)&&(c[0]>0)&&(c[0]<10)&&(c[1]>0)&&c[1]<10){return}b.event.stopPropagation();b.event.preventDefault();d=b.event}a.Painter.createMenu(this,function(e){e.painter.FillContextMenu(e);e.painter.FillObjectExecMenu(e,function(){e.show(d)})})};a.TPadPainter.prototype.Redraw=function(c){var f=true;if(this.iscan){this.CreateCanvasSvg(2)}else{f=this.CreatePadSvg(true)}for(var d=0;d<this.painters.length;++d){var e=this.painters[d];if(f||e.this_pad_name){e.Redraw(c)}}};a.TPadPainter.prototype.NumDrawnSubpads=function(){if(this.painters===undefined){return 0}var c=0;for(var d=0;d<this.painters.length;++d){var e=this.painters[d].GetObject();if((e!==null)&&(e._typename==="TPad")){c++}}return c};a.TPadPainter.prototype.RedrawByResize=function(){if(this.access_3d_kind()===1){return true}for(var c=0;c<this.painters.length;++c){if(typeof this.painters[c].RedrawByResize==="function"){if(this.painters[c].RedrawByResize()){return true}}}return false};a.TPadPainter.prototype.CheckCanvasResize=function(d,e){if(!this.iscan&&this.has_canvas){return false}if(d&&(typeof d==="object")&&d.force){e=true}if(!e){e=this.RedrawByResize()}var f=this.CreateCanvasSvg(e?2:1,d);if(f){for(var c=0;c<this.painters.length;++c){this.painters[c].Redraw(e?false:true)}}return f};a.TPadPainter.prototype.UpdateObject=function(g){if(!g){return false}this.pad.fGridx=g.fGridx;this.pad.fGridy=g.fGridy;this.pad.fTickx=g.fTickx;this.pad.fTicky=g.fTicky;this.pad.fLogx=g.fLogx;this.pad.fLogy=g.fLogy;this.pad.fLogz=g.fLogz;this.pad.fUxmin=g.fUxmin;this.pad.fUxmax=g.fUxmax;this.pad.fUymin=g.fUymin;this.pad.fUymax=g.fUymax;this.pad.fLeftMargin=g.fLeftMargin;this.pad.fRightMargin=g.fRightMargin;this.pad.fBottomMargin=g.fBottomMargin;this.pad.fTopMargin=g.fTopMargin;this.pad.fFillColor=g.fFillColor;this.pad.fFillStyle=g.fFillStyle;this.pad.fLineColor=g.fLineColor;this.pad.fLineStyle=g.fLineStyle;this.pad.fLineWidth=g.fLineWidth;if(this.iscan){this.CheckColors(g)}var d=this.frame_painter();if(d){d.UpdateAttributes(!d.modified_NDC)}if(!g.fPrimitives){return false}var e=false,f=0;for(var h=0;h<g.fPrimitives.arr.length;++h){while(f<this.painters.length){var c=this.painters[f++];if(!c._primitive){continue}if(c.UpdateObject(g.fPrimitives.arr[h])){e=true}break}}return e};a.TPadPainter.prototype.DrawNextSnap=function(g,h,c,j){if(j&&g&&g.arr[h]){if(this.painters.indexOf(j)<0){this.painters.push(j)}j.snapid=g.arr[h].fObjectID}++h;if(!g||h>=g.arr.length){return a.CallBack(c,this)}var d=g.arr[h],i=null;for(var e=0;e<this.painters.length;++e){if(this.painters[e].snapid===d.fObjectID){i=this.painters[e];break}}var l=this.DrawNextSnap.bind(this,g,h,c);if(i){if(typeof i.RedrawSnap==="function"){return i.RedrawSnap(d,l)}if(d.fKind===1){if(i.UpdateObject(d.fSnapshot)){i.Redraw()}return l(i)}if(d.fKind===2){if(i.UpdateObject(d.fSnapshot)){i.Redraw()}return l(i)}return l(i)}if(d.fKind===1){var f=d.fSnapshot;if(f){f.$snapid=d.fObjectID}return a.draw(this.divid,f,d.fOption,l)}if(d.fKind===2){return a.draw(this.divid,d.fSnapshot,d.fOption,l)}l(null)};a.TPadPainter.prototype.FindSnap=function(e){if(this.snapid===e){return this}if(!this.painters){return null}for(var c=0;c<this.painters.length;++c){var d=this.painters[c];if(typeof d.FindSnap==="function"){d=d.FindSnap(e)}else{if(d.snapid!==e){d=null}}if(d){return d}}return null};a.TPadPainter.prototype.RedrawSnap=function(c,g){if(!c||!c.arr){return}var h=c.arr[0].fSnapshot;h.fPrimitives=null;if(this.snapid===undefined){this.snapid=c.arr[0].fObjectID;this.draw_object=h;this.pad=h;this.CreateCanvasSvg(0);this.SetDivId(this.divid);this.AddButton(a.ToolbarIcons.camera,"Create PNG","CanvasSnapShot","Ctrl PrintScreen");if(a.gStyle.ContextMenu){this.AddButton(a.ToolbarIcons.question,"Access context menus","PadContextMenus")}if(this.enlarge_main("verify")){this.AddButton(a.ToolbarIcons.circle,"Enlarge canvas","EnlargePad")}a.Painter.drawFrame(this.divid,null);this.DrawNextSnap(c,0,g);return}this.UpdateObject(h);if(this.iscan){this.CreateCanvasSvg(2)}else{this.CreatePadSvg(true)}for(var d=0;d<this.painters.length;++d){var f=this.painters[d];if(f.snapid===undefined){continue}for(var e=1;e<c.arr.length;++e){if(c.arr[e].fObjectID===f.snapid){f=null;break}}if(f){this.painters.splice(d--,1);f.Cleanup()}}this.DrawNextSnap(c,0,g,null)};a.TPadPainter.prototype.ItemContextMenu=function(d){var g=this.svg_pad(this.this_pad_name).node().getBoundingClientRect();var h={clientX:g.left+10,clientY:g.top+10};if(d=="pad"){return setTimeout(this.ShowContextMenu.bind(this,h),50)}var c=null,f;switch(d){case"xaxis":case"yaxis":case"zaxis":c=this.main_painter();f=d[0];break;case"frame":c=this.frame_painter();break;default:var e=parseInt(d);if(!isNaN(e)){c=this.painters[e]}}if(!c||(typeof c.FillContextMenu!=="function")){return}a.Painter.createMenu(c,function(i){if(c.FillContextMenu(i,f)){setTimeout(i.show.bind(i,h),50)}})};a.TPadPainter.prototype.SaveAsPng=function(h,d,g){if(!d){d=this.this_pad_name;if(d.length===0){d=this.iscan?"canvas":"pad"}d+=".png"}var f=h?this.svg_canvas():this.svg_pad(this.this_pad_name);if(f.empty()){return}var c=h?this.pad_painter():this;document.body.style.cursor="wait";c.ForEachPainterInPad(function(j){var i=j.main_painter(true,j.this_pad_name);if(!i||(typeof i.Render3D!=="function")){return}var n=i.access_3d_kind();if((n!==1)&&(n!==2)){return}var o=i.size_for_3d(3);var l=i.Render3D(-1111);var k=b.select(l);var m=i.svg_layer("special_layer");group=m.append("g").attr("class","temp_saveaspng").attr("transform","translate("+o.x+","+o.y+")");group.node().appendChild(l)},true);var e={name:d,removeClass:"btns_layer"};if(g){e.result="svg"}a.saveSvgAsPng(f.node(),e,function(i){if(i===null){console.warn("problem when produce image")}f.selectAll(".temp_saveaspng").remove();document.body.style.cursor="auto";if(g){a.CallBack(g,i)}})};a.TPadPainter.prototype.PadButtonClick=function(c){if(c=="CanvasSnapShot"){return this.SaveAsPng(true)}if(c=="EnlargePad"){return this.EnlargePad()}if(c=="PadSnapShot"){return this.SaveAsPng(false)}if(c=="PadContextMenus"){b.event.preventDefault();b.event.stopPropagation();if(a.Painter.closeMenu()){return}var f=this,h=b.event;a.Painter.createMenu(f,function(o){o.add("header:Menus");if(f.iscan){o.add("Canvas","pad",f.ItemContextMenu)}else{o.add("Pad","pad",f.ItemContextMenu)}if(f.frame_painter()){o.add("Frame","frame",f.ItemContextMenu)}var i=f.main_painter();if(i){o.add("X axis","xaxis",f.ItemContextMenu);o.add("Y axis","yaxis",f.ItemContextMenu);if((typeof i.Dimension==="function")&&(i.Dimension()>1)){o.add("Z axis","zaxis",f.ItemContextMenu)}}if(f.painters&&(f.painters.length>0)){o.add("separator");var l=[];for(var p=0;p<f.painters.length;++p){var j=f.painters[p];var m=j?j.GetObject():null;if(!m||(l.indexOf(m)>=0)){continue}var k=("_typename" in m)?(m._typename+"::"):"";if("fName" in m){k+=m.fName}if(k.length==0){k="item"+p}o.add(k,p,f.ItemContextMenu)}}o.show(h)});return}var e=false;for(var g=0;g<this.painters.length;++g){var d=this.painters[g];if(typeof d.PadButtonClick=="function"){d.PadButtonClick(c)}if(!e&&(typeof d.ButtonClick=="function")){e=d.ButtonClick(c)}}};a.TPadPainter.prototype.FindButton=function(e){var d=this.svg_layer("btns_layer",this.this_pad_name);if(d.empty()){return}var c="";d.selectAll("svg").each(function(){if(b.select(this).attr("key")===e){c=b.select(this).attr("name")}});return c};a.TPadPainter.prototype.toggleButtonsVisibility=function(f){var g=this.svg_layer("btns_layer",this.this_pad_name),d=g.select("[name='Toggle']");if(d.empty()){return}var e=d.property("buttons_state");if(d.property("timout_handler")){if(f!=="timeout"){clearTimeout(d.property("timout_handler"))}d.property("timout_handler",null)}var c=false;switch(f){case"enable":c=true;break;case"enterbtn":return;case"timeout":isvisible=false;break;case"toggle":e=!e;d.property("buttons_state",e);c=e;break;case"disable":case"leavebtn":if(e){return}return d.property("timout_handler",setTimeout(this.toggleButtonsVisibility.bind(this,"timeout"),500))}g.selectAll("svg").each(function(){if(this===d.node()){return}b.select(this).style("display",c?"":"none")})};a.TPadPainter.prototype.AddButton=function(d,k,e,g){if(!a.gStyle.ToolBar){return}var i=this.svg_layer("btns_layer",this.this_pad_name);if(i.empty()){return}if(!i.select("[name='"+e+"']").empty()){return}var j=this.iscan||!this.has_canvas,c;var h=i.property("nextx");if(!h){c=a.ToolbarIcons.CreateSVG(i,a.ToolbarIcons.rect,this.ButtonSize(),"Toggle tool buttons");c.attr("name","Toggle").attr("x",0).attr("y",0).attr("normalx",0).property("buttons_state",(a.gStyle.ToolBar!=="popup")).on("click",this.toggleButtonsVisibility.bind(this,"toggle")).on("mouseenter",this.toggleButtonsVisibility.bind(this,"enable")).on("mouseleave",this.toggleButtonsVisibility.bind(this,"disable"));h=j?this.ButtonSize(1.25):0}else{c=i.select("[name='Toggle']")}var f=a.ToolbarIcons.CreateSVG(i,d,this.ButtonSize(),k+(j?"":(" on pad "+this.this_pad_name))+(g?" (keyshortcut "+g+")":""));f.attr("name",e).attr("x",h).attr("y",0).attr("normalx",h).style("display",(c.property("buttons_state")?"":"none")).on("mouseenter",this.toggleButtonsVisibility.bind(this,"enterbtn")).on("mouseleave",this.toggleButtonsVisibility.bind(this,"leavebtn"));if(g){f.attr("key",g)}f.on("click",this.PadButtonClick.bind(this,e));i.property("nextx",h+this.ButtonSize(1.25));if(!j){i.attr("transform","translate("+(this.pad_width(this.this_pad_name)-i.property("nextx")-this.ButtonSize(1.25))+","+(this.pad_height(this.this_pad_name)-this.ButtonSize(1.25))+")");c.attr("x",i.property("nextx"))}if(!j&&(e.indexOf("Pad")!=0)&&(this.pad_painter()!==this)&&(e!=="EnlargePad")){this.pad_painter().AddButton(d,k,e)}};a.TPadPainter.prototype.DecodeOptions=function(c){var e=this.GetObject();if(!e){return}var f=new a.DrawOptions(c);if(f.check("WEBSOCKET")){this.OpenWebsocket()}if(f.check("WHITE")){e.fFillColor=0}if(f.check("LOGX")){e.fLogx=1}if(f.check("LOGY")){e.fLogy=1}if(f.check("LOGZ")){e.fLogz=1}if(f.check("LOG")){e.fLogx=e.fLogy=e.fLogz=1}if(f.check("GRIDX")){e.fGridx=1}if(f.check("GRIDY")){e.fGridy=1}if(f.check("GRID")){e.fGridx=e.fGridy=1}if(f.check("TICKX")){e.fTickx=1}if(f.check("TICKY")){e.fTicky=1}if(f.check("TICK")){e.fTickx=e.fTicky=1}};a.Painter.drawCanvas=function(g,f,e){var c=(f===null);if(c){f=a.Create("TCanvas")}var d=new a.TPadPainter(f,true);d.DecodeOptions(e);d.SetDivId(g,-1);d.CheckColors(f);d.CreateCanvasSvg(0);d.SetDivId(g);d.AddButton(a.ToolbarIcons.camera,"Create PNG","CanvasSnapShot","Ctrl PrintScreen");if(a.gStyle.ContextMenu){d.AddButton(a.ToolbarIcons.question,"Access context menus","PadContextMenus")}if(d.enlarge_main("verify")){d.AddButton(a.ToolbarIcons.circle,"Enlarge canvas","EnlargePad")}if(c&&e.indexOf("noframe")<0){a.Painter.drawFrame(g,null)}d.DrawPrimitive(0,function(){d.DrawingReady()});return d};a.Painter.drawPad=function(g,f,d){var c=new a.TPadPainter(f,false);c.DecodeOptions(d);c.SetDivId(g);if(c.svg_canvas().empty()){c.has_canvas=false;c.this_pad_name=""}c.CreatePadSvg();if(c.MatchObjectType("TPad")&&(!c.has_canvas||c.HasObjectsToDraw())){c.AddButton(a.ToolbarIcons.camera,"Create PNG","PadSnapShot");if((c.has_canvas&&c.HasObjectsToDraw())||c.enlarge_main("verify")){c.AddButton(a.ToolbarIcons.circle,"Enlarge pad","EnlargePad")}if(a.gStyle.ContextMenu){c.AddButton(a.ToolbarIcons.question,"Access context menus","PadContextMenus")}}var e;if(c.has_canvas){e=c.CurrentPadName(c.this_pad_name)}c.DrawPrimitive(0,function(){c.CurrentPadName(e);c.DrawingReady()});return c};a.TAxisPainter=function(d,c){a.TObjectPainter.call(this,d);this.embedded=c;this.name="yaxis";this.kind="normal";this.func=null;this.order=0;this.full_min=0;this.full_max=1;this.scale_min=0;this.scale_max=1;this.ticks=[];this.invert_side=false};a.TAxisPainter.prototype=Object.create(a.TObjectPainter.prototype);a.TAxisPainter.prototype.Cleanup=function(){this.ticks=[];this.func=null;delete this.format;delete this.range;a.TObjectPainter.prototype.Cleanup.call(this)};a.TAxisPainter.prototype.SetAxisConfig=function(e,g,h,f,d,c,i){this.name=e;this.kind=g;this.func=h;this.full_min=f;this.full_max=d;this.scale_min=c;this.scale_max=i};a.TAxisPainter.prototype.CreateFormatFuncs=function(){var e=this.GetObject(),d=(e&&e._typename==="TGaxis");delete this.format;var i=508;if(e!==null){i=Math.max(d?e.fNdiv:e.fNdivisions,4)}this.nticks=i%100;this.nticks2=(i%10000-this.nticks)/100;this.nticks3=Math.floor(i/10000);if(e&&!d&&(this.nticks>7)){this.nticks=7}var f=Math.abs(this.func.range()[1]-this.func.range()[0]);if(f<=0){f=100}if(this.kind=="time"){if(this.nticks>8){this.nticks=8}var c=this.scale_max-this.scale_min;var h=a.Painter.getTimeFormat(e);if((h.length==0)||(c<0.1*(this.full_max-this.full_min))){h=a.Painter.chooseTimeFormat(c/this.nticks,true)}var g=a.Painter.chooseTimeFormat(c/f,false);this.tfunc1=this.tfunc2=b.timeFormat(h);if(g!==h){this.tfunc2=b.timeFormat(g)}this.format=function(k,j){return j?this.tfunc1(k):this.tfunc2(k)}}else{if(this.kind=="log"){this.nticks2=1;this.noexp=e?e.TestBit(a.EAxisBits.kNoExponent):false;if((this.scale_max<300)&&(this.scale_min>0.3)){this.noexp=true}this.moreloglabels=e?e.TestBit(a.EAxisBits.kMoreLogLabels):false;this.format=function(o,j,m){var n=parseFloat(o);if(!j){var l=Math.round(n);return((l===n)&&(Math.abs(l)<1000000000))?l.toString():n.toExponential(4)}if(n<=0){return null}var k=a.log10(n);if(this.moreloglabels||(Math.abs(k-Math.round(k))<0.001)){if(!this.noexp&&!m){return a.Painter.formatExp(n.toExponential(0))}else{if(k<0){return n.toFixed(Math.round(-k+0.5))}else{return n.toFixed(0)}}}return null}}else{if(this.kind=="labels"){this.nticks=50;var c=this.scale_max-this.scale_min;if(this.nticks>c){this.nticks=Math.round(c)}this.nticks2=1;this.axis=e;this.format=function(m){var l=Math.round(parseInt(m))+1;if((l<1)||(l>this.axis.fNbins)){return null}for(var k=0;k<this.axis.fLabels.arr.length;++k){var j=this.axis.fLabels.arr[k];if(j.fUniqueID==l){return j.fString}}return null}}else{this.range=Math.abs(this.scale_max-this.scale_min);if(this.range<=0){this.ndig=-3}else{this.ndig=Math.round(a.log10(this.nticks/this.range)+0.7)}this.format=function(m,j){var l=parseFloat(m),k=Math.round(l);if(j){if(this.order===0){if(l===k){return k.toString()}if(Math.abs(l)<1e-10*this.range){return 0}l=(this.ndig>10)?l.toExponential(4):l.toFixed(this.ndig>0?this.ndig:0);if((typeof m=="string")&&(m.length<=l.length+1)){return m}return l}l=l/Math.pow(10,this.order);k=Math.round(l);if(l===k){return k.toString()}return l.toFixed(this.ndig+this.order>0?this.ndig+this.order:0)}if(l===k){return(Math.abs(k)<1000000000)?k.toString():l.toExponential(4)}return this.ndig>10?l.toExponential(4):l.toFixed(this.ndig+2>0?this.ndig+2:0)}}}}};a.TAxisPainter.prototype.CreateTicks=function(f){var e={nminor:0,nmiddle:0,nmajor:0,func:this.func};e.minor=e.middle=e.major=this.func.ticks(this.nticks);if(f){var c=e.major;var g=(this.scale_max-this.scale_min)*0.00001;if(c[0]>this.scale_min+g){c.unshift(this.scale_min)}if(c[c.length-1]<this.scale_max-g){c.push(this.scale_max)}return c}if(this.nticks2>1){e.minor=e.middle=this.func.ticks(e.major.length*this.nticks2);var d=Math.abs(this.func.range()[1]-this.func.range()[0]);if((e.middle.length<=e.major.length)||(e.middle.length>d/3.5)){e.minor=e.middle=e.major}else{if((this.nticks3>1)&&(this.kind!=="log")){e.minor=this.func.ticks(e.middle.length*this.nticks3);if((e.minor.length<=e.middle.length)||(e.minor.length>d/1.7)){e.minor=e.middle}}}}e.reset=function(){this.nminor=this.nmiddle=this.nmajor=0};e.next=function(h){if(this.nminor>=this.minor.length){return false}this.tick=this.minor[this.nminor++];this.grpos=this.func(this.tick);if(h){this.grpos=Math.round(this.grpos)}this.kind=3;if((this.nmiddle<this.middle.length)&&(Math.abs(this.grpos-this.func(this.middle[this.nmiddle]))<1)){this.nmiddle++;this.kind=2}if((this.nmajor<this.major.length)&&(Math.abs(this.grpos-this.func(this.major[this.nmajor]))<1)){this.nmajor++;this.kind=1}return true};e.last_major=function(){return(this.kind!==1)?false:this.nmajor==this.major.length};e.next_major_grpos=function(){if(this.nmajor>=this.major.length){return null}return this.func(this.major[this.nmajor])};return e};a.TAxisPainter.prototype.IsCenterLabels=function(){if(this.kind==="labels"){return true}if(this.kind==="log"){return false}var c=this.GetObject();return c&&c.TestBit(a.EAxisBits.kCenterLabels)};a.TAxisPainter.prototype.AddTitleDrag=function(f,e,n,k,h){if(!a.gStyle.MoveResize){return}var d=this,g=null,i="",o,r,q,m,l,c,p,j;if(a._test_d3_===3){i="drag";o=b.behavior.drag().origin(Object)}else{o=b.drag().subject(Object)}o.on(i+"start",function(){b.event.sourceEvent.preventDefault();b.event.sourceEvent.stopPropagation();var t=f.node().getBBox(),s=d.GetObject();m=r=f.property("shift_x");l=q=f.property("shift_y");c=e?(r>0):(q>0);if(s.TestBit(a.EAxisBits.kCenterTitle)){j=(k===e)?h:0}else{j=Math.round(h/2)}g=f.append("rect").classed("zoom",true).attr("x",t.x).attr("y",t.y).attr("width",t.width).attr("height",t.height).style("cursor","move")}).on("drag",function(){if(!g){return}b.event.sourceEvent.preventDefault();b.event.sourceEvent.stopPropagation();r+=b.event.dx;q+=b.event.dy;var t=f.property("shift_x"),s=f.property("shift_y");if(e){t=r;if(Math.abs(q-s)>Math.abs(q-j)){s=j}}else{s=q;if(Math.abs(r-t)>Math.abs(r-j)){t=j}}if(c===(e?(t>0):(s>0))){m=t;l=s;f.attr("transform","translate("+m+","+l+")")}}).on(i+"end",function(){if(!g){return}b.event.sourceEvent.preventDefault();b.event.sourceEvent.stopPropagation();f.property("shift_x",m).property("shift_y",l);var s=d.GetObject();s.fTitleOffset=(e?m:l)/n;if((e?l:m)===j){s.InvertBit(a.EAxisBits.kCenterTitle)}g.remove();g=null});f.style("cursor","move").call(o)};a.TAxisPainter.prototype.DrawAxis=function(F,i,U,ad,M,Y,s){var G=this.GetObject(),aa=(G&&G._typename==="TGaxis"),v=(this.name==="zaxis")?-1:1,ae=0,ah=i,l=10,m=100,n=100,q=this.pad_width()||10,H=this.pad_height()||10;this.vertical=F;if(!s){s=0}else{if(this.invert_side){s=-s}}if(aa){if(!this.lineatt){this.lineatt=a.Painter.createAttLine(G)}m=(F?q:H);l=Math.round(G.fTickSize*m)}else{if(!this.lineatt){this.lineatt=a.Painter.createAttLine(G.fAxisColor,1)}m=(F?U:ad);l=Math.round(G.fTickLength*m)}n=Math.min(q,H);if(!aa||(this.name==="zaxis")){ah=i.select("."+this.name+"_container");if(ah.empty()){ah=i.append("svg:g").attr("class",this.name+"_container")}else{ah.selectAll("*").remove()}if(this.invert_side){v=-v}}else{if((G.fChopt.indexOf("-")>=0)&&(G.fChopt.indexOf("+")<0)){v=-1}else{if(F&&G.fChopt=="+L"){v=-1}else{if((G.fChopt.indexOf("-")>=0)&&(G.fChopt.indexOf("+")>=0)){v=1;ae=1}}}ah.append("svg:line").attr("x1",0).attr("y1",0).attr("x1",F?0:U).attr("y1",F?ad:0).call(this.lineatt.func)}if(M!==undefined){ah.attr("transform",M)}this.CreateFormatFuncs();var W=this.IsCenterLabels(),R="",e="",g=0,ak=0,j=1,ai=0;this.ticks=[];var B=this.CreateTicks();while(B.next(true)){var L=Math.round(l/4),K=0;if(B.kind<3){L=Math.round(l/2)}if(B.kind==1){if(!("format" in this)||(this.format(B.tick,true)!==null)){L=l}this.ticks.push(B.grpos)}if(ae>0){K=-L}else{if(v<0){K=-L;L=0}else{K=0}}if(R.length==0){R=F?("M"+L+","+B.grpos):("M"+B.grpos+","+(-L));e=F?("M"+(s-L)+","+B.grpos):("M"+B.grpos+","+(s+L))}else{R+=F?("m"+(L-ak)+","+(B.grpos-g)):("m"+(B.grpos-g)+","+(ak-L));e+=F?("m"+(ak-L)+","+(B.grpos-g)):("m"+(B.grpos-g)+","+(L-ak))}R+=F?("h"+(K-L)):("v"+(L-K));e+=F?("h"+(L-K)):("v"+(K-L));g=B.grpos;ak=K}if(R.length>0){ah.append("svg:path").attr("d",R).call(this.lineatt.func)}if((s!==0)&&(e.length>0)){ah.append("svg:path").attr("d",e).call(this.lineatt.func)}var u=F?ad:0,P=(G.fLabelSize>=1)?G.fLabelSize:Math.round(G.fLabelSize*(aa?this.pad_height():ad)),p=a.Painter.getFontDetails(G.fLabelFont,P),ab=a.Painter.root_colors[G.fLabelColor],aj=3+Math.round(G.fLabelOffset*m),x=ah.append("svg:g").attr("class","axis_labels").call(p.func);this.order=0;if((this.kind=="normal")&&!G.TestBit(a.EAxisBits.kNoExponent)){var J=Math.max(Math.abs(B.major[0]),Math.abs(B.major[B.major.length-1]));for(var S=18;S>-18;S-=3){if(S===0){continue}if((S<0)&&((this.range>=0.1)||(J>=1))){break}var T=Math.pow(10,S);if((this.range>T*9.99999)||((J>T*50)&&(this.range>T*0.05))){this.order=S;break}}}for(var f=0;f<B.major.length;++f){var Q=Math.round(this.func(B.major[f])),z=this.format(B.major[f],true);if(z===null){continue}var X=x.append("svg:text").attr("fill",ab).text(z);ai=Math.max(ai,z.length);if(F){X.attr("x",-aj*v).attr("y",Q).style("text-anchor",(v>0)?"end":"start").style("dominant-baseline","middle")}else{X.attr("x",Q).attr("y",2+aj*v+ae*l).attr("dy",(v>0)?".7em":"-.3em").style("text-anchor","middle")}var E=!a.nodejs?this.GetBoundarySizes(X.node()):{height:Math.round(p.size*1.2),width:Math.round(z.length*p.size*0.4)},d=(f>0)?(Q-u):(F?ad/2:U/2),O=(f<B.major.length-1)?(Math.round(this.func(B.major[f+1]))-Q):d,ac=Math.min(Math.abs(d),Math.abs(O));if(F){if((ac>0)&&(E.height>5)&&(this.kind!=="log")){j=Math.min(j,ac/E.height)}if(W){if(Q+O/2-j*E.height/2<-10){X.remove()}else{X.attr("y",Math.round(Q+O/2))}}}else{if((ac>0)&&(E.width>10)&&(this.kind!=="log")){j=Math.min(j,ac/E.width)}if(W){if(Q+O/2-j*E.width/2>U-10){X.remove()}else{X.attr("x",Math.round(Q+O/2))}}}u=Q}if(this.order!==0){x.append("svg:text").attr("fill",ab).attr("x",F?aj:U+5).attr("y",0).style("text-anchor","start").style("dominant-baseline","middle").attr("dy","-.5em").text("\xD7"+a.Painter.formatExp(Math.pow(10,this.order).toExponential(0)))}if((j>0)&&(j<1)){if((j<0.7)&&!F&&(v>0)&&(ai>5)){x.selectAll("text").each(function(){var r=b.select(this),h=r.attr("x"),t=r.attr("y")-5;r.attr("transform","translate("+h+","+t+") rotate(25)").style("text-anchor","start").attr("x",null).attr("y",null)});j*=3.5}p.size=Math.floor(p.size*j+0.7);x.call(p.func)}if(a.gStyle.Zooming&&!this.disable_zooming){var Z=ah.append("svg:rect").attr("class","axis_zoom").style("opacity","0").style("cursor","crosshair");if(F){Z.attr("x",(v>0)?(-2*p.size-3):3).attr("y",0).attr("width",2*p.size+3).attr("height",ad)}else{Z.attr("x",0).attr("y",(v>0)?0:-p.size-3).attr("width",U).attr("height",p.size+3)}}if(G.fTitle.length>0){var o=ah.append("svg:g").attr("class","axis_title"),V=(G.fTitleSize>=1)?G.fTitleSize:Math.round(G.fTitleSize*n),af=1.6*(G.fTitleSize<1?G.fTitleSize:G.fTitleSize/n),c=G.TestBit(a.EAxisBits.kCenterTitle),ag=G.TestBit(a.EAxisBits.kRotateTitle)?-1:1,k=a.Painter.root_colors[G.fTitleColor],A=0,y=0;this.StartTextDrawing(G.fTitleFont,V,o);var I=((ag<0)&&!Y)||((ag>=0)&&Y);if(F){af*=-v*q;A=Math.round(af*G.fTitleOffset);if((this.name=="zaxis")&&aa&&("getBoundingClientRect" in ah.node())){var N=ah.node().getBoundingClientRect();if(A<N.width-l){A=Math.round(N.width-l)}}y=Math.round(c?ad/2:(Y?ad:0));this.DrawText((c?"middle":(I?"begin":"end"))+";middle",0,0,0,(ag<0?-90:-270),G.fTitle,k,1,o)}else{af*=v*H;A=Math.round(c?U/2:(Y?0:U));y=Math.round(af*G.fTitleOffset);this.DrawText((c?"middle":(I?"begin":"end"))+";middle",0,0,0,(ag<0?-180:0),G.fTitle,k,1,o)}this.FinishTextDrawing(o);o.attr("transform","translate("+A+","+y+")").property("shift_x",A).property("shift_y",y);this.AddTitleDrag(o,F,af,Y,F?ad:U)}this.position=0;if("getBoundingClientRect" in ah.node()){var D=ah.node().getBoundingClientRect(),C=this.svg_pad().node().getBoundingClientRect();this.position=D.left-C.left}};a.TAxisPainter.prototype.Redraw=function(){var i=this.GetObject(),e=this.AxisToSvg("x",i.fX1),q=this.AxisToSvg("y",i.fY1),c=this.AxisToSvg("x",i.fX2),p=this.AxisToSvg("y",i.fY2),r=c-e,l=q-p,j=r<5,g="normal",f=null,k=i.fWmin,o=i.fWmax,m=false;if(i.fChopt.indexOf("G")>=0){f=b.scaleLog();g="log"}else{f=b.scaleLinear()}f.domain([k,o]);if(j){if(l>0){f.range([l,0])}else{var n=q;q=p;p=n;l=-l;m=true;f.range([0,l])}}else{if(r>0){f.range([0,r])}else{var n=e;e=c;c=n;r=-r;m=true;f.range([r,0])}}this.SetAxisConfig(j?"yaxis":"xaxis",g,f,k,o,k,o);this.RecreateDrawG(true,"text_layer");this.DrawAxis(j,this.draw_g,r,l,"translate("+e+","+p+")",m)};a.drawGaxis=function(f,e,d){var c=new a.TAxisPainter(e,false);c.SetDivId(f);c.disable_zooming=true;c.Redraw();return c.DrawingReady()};a.THistPainter=function(c){a.TObjectPainter.call(this,c);this.histo=c;this.shrink_frame_left=0;this.draw_content=true;this.nbinsx=0;this.nbinsy=0;this.x_kind="normal";this.y_kind="normal";this.keys_handler=null;this.accept_drops=true;this.mode3d=false;this.zoom_changed_interactive=0};a.THistPainter.prototype=Object.create(a.TObjectPainter.prototype);a.THistPainter.prototype.IsDummyHisto=function(){return !this.histo||(!this.draw_content&&!this.create_stats)||(this.options.Axis>0)};a.THistPainter.prototype.IsTProfile=function(){return this.MatchObjectType("TProfile")};a.THistPainter.prototype.IsTH2Poly=function(){return this.histo&&this.histo._typename.match(/^TH2Poly/)};a.THistPainter.prototype.Cleanup=function(){if(this.keys_handler){window.removeEventListener("keydown",this.keys_handler,false);this.keys_handler=null}if(typeof this.Create3DScene==="function"){this.Create3DScene(-1)}this.histo=null;delete this.x;delete this.grx;delete this.ConvertX;delete this.RevertX;delete this.y;delete this.gry;delete this.ConvertY;delete this.RevertY;delete this.z;delete this.grz;if(this.x_handle){this.x_handle.Cleanup();delete this.x_handle}if(this.y_handle){this.y_handle.Cleanup();delete this.y_handle}if(this.z_handle){this.z_handle.Cleanup();delete this.z_handle}delete this.fPalette;delete this.fContour;delete this.options;a.TObjectPainter.prototype.Cleanup.call(this)};a.THistPainter.prototype.Dimension=function(){if(!this.histo){return 0}if(this.histo._typename.indexOf("TH2")==0){return 2}if(this.histo._typename.indexOf("TProfile2D")==0){return 2}if(this.histo._typename.indexOf("TH3")==0){return 3}return 1};a.THistPainter.prototype.DecodeOptions=function(c,l){var j={Axis:0,Bar:0,Curve:0,Hist:0,Line:0,Error:0,errorX:a.gStyle.fErrorX,Mark:0,Fill:0,Same:0,Scat:0,ScatCoef:1,Func:1,Star:0,Arrow:0,Box:0,Text:0,Char:0,Color:0,Contour:0,Lego:0,Surf:0,Off:0,Tri:0,Proj:0,AxisPos:0,Spec:0,Pie:0,List:0,Zscale:0,FrontBox:1,BackBox:1,Candle:"",GLBox:0,GLColor:0,System:a.Painter.Coord.kCARTESIAN,AutoColor:0,NoStat:0,AutoZoom:false,HighRes:0,Zero:1,Palette:0,BaseLine:false,Optimize:a.gStyle.OptimizeDraw,minimum:-1111,maximum:-1111},k=new a.DrawOptions(c?c:this.histo.fOption),i=this.Dimension(),g=this.root_pad(),m=false;if((i===1)&&(this.histo.fSumw2.length>0)){for(var f=0;f<this.histo.fSumw2.length;++f){if(this.histo.fSumw2[f]>0){j.Error=2;j.Zero=0;break}}}if(k.check("PAL",true)){j.Palette=k.partAsInt()}if(k.check("MINIMUM:",true)){j.minimum=parseFloat(k.part)}else{j.minimum=this.histo.fMinimum}if(k.check("MAXIMUM:",true)){j.maximum=parseFloat(k.part)}else{j.maximum=this.histo.fMaximum}if(k.check("NOOPTIMIZE")){j.Optimize=0}if(k.check("OPTIMIZE")){j.Optimize=2}if(k.check("AUTOCOL")){j.AutoColor=1;j.Hist=1}if(k.check("AUTOZOOM")){j.AutoZoom=1;j.Hist=1}if(k.check("NOSTAT")){j.NoStat=1}var o=null;if(k.check("NOTOOLTIP")){o=false}if(k.check("TOOLTIP")){o=true}if((o!==null)&&this.frame_painter()){this.frame_painter().tooltip_allowed=o}if(k.check("LOGX")){g.fLogx=1}if(k.check("LOGY")){g.fLogy=1}if(k.check("LOGZ")){g.fLogz=1}if(k.check("GRIDXY")){g.fGridx=g.fGridy=1}if(k.check("GRIDX")){g.fGridx=1}if(k.check("GRIDY")){g.fGridy=1}if(k.check("TICKXY")){g.fTickx=g.fTicky=1}if(k.check("TICKX")){g.fTickx=1}if(k.check("TICKY")){g.fTicky=1}if(k.check("FILL_",true)){if(k.partAsInt(1)>0){this.histo.fFillColor=k.partAsInt()}else{for(var e=0;e<8;++e){if(a.Painter.root_colors[e].toUpperCase()===k.part){this.histo.fFillColor=e}}}}if(k.check("LINE_",true)){if(k.partAsInt(1)>0){this.histo.fLineColor=k.partAsInt()}else{for(var e=0;e<8;++e){if(a.Painter.root_colors[e].toUpperCase()===k.part){this.histo.fLineColor=e}}}}if(k.check("X+")){j.AxisPos=10}if(k.check("Y+")){j.AxisPos+=1}if(k.check("SAMES")){j.Same=2}if(k.check("SAME")){j.Same=1}if(k.empty()){j.Hist=1}if(k.check("SPEC")){j.Scat=0;j.Spec=1}if(k.check("BASE0")){j.BaseLine=0}else{if(a.gStyle.fHistMinimumZero){j.BaseLine=0}}if(k.check("PIE")){j.Pie=1}if(k.check("CANDLE",true)){j.Candle=k.part}if(k.check("GLBOX",true)){j.GLBox=10+k.partAsInt()}if(k.check("GLCOL")){j.GLColor=1}k.check("GL");if(k.check("LEGO",true)){j.Scat=0;j.Lego=1;if(k.part.indexOf("0")>=0){j.Zero=0}if(k.part.indexOf("1")>=0){j.Lego=11}if(k.part.indexOf("2")>=0){j.Lego=12}if(k.part.indexOf("3")>=0){j.Lego=13}if(k.part.indexOf("4")>=0){j.Lego=14}if(k.part.indexOf("FB")>=0){j.FrontBox=0}if(k.part.indexOf("BB")>=0){j.BackBox=0}if(k.part.indexOf("Z")>=0){j.Zscale=1}}if(k.check("SURF",true)){j.Scat=0;j.Surf=k.partAsInt(10,1);if(k.part.indexOf("FB")>=0){j.FrontBox=0}if(k.part.indexOf("BB")>=0){j.BackBox=0}if(k.part.indexOf("Z")>=0){j.Zscale=1}}if(k.check("TF3",true)){if(k.part.indexOf("FB")>=0){j.FrontBox=0}if(k.part.indexOf("BB")>=0){j.BackBox=0}}if(k.check("ISO",true)){if(k.part.indexOf("FB")>=0){j.FrontBox=0}if(k.part.indexOf("BB")>=0){j.BackBox=0}}if(k.check("LIST")){j.List=1}if(k.check("CONT",true)){if(i>1){j.Scat=0;j.Contour=1;if(k.part.indexOf("Z")>=0){j.Zscale=1}if(k.part.indexOf("1")>=0){j.Contour=11}else{if(k.part.indexOf("2")>=0){j.Contour=12}else{if(k.part.indexOf("3")>=0){j.Contour=13}else{if(k.part.indexOf("4")>=0){j.Contour=14}}}}}else{j.Hist=1}}if(k.check("HBAR",true)){j.Bar=20}else{if(k.check("BAR",true)){j.Bar=10}}if(j.Bar>0){j.Hist=0;m=true;j.Bar+=k.partAsInt()}if(k.check("ARR")){if(i>1){j.Arrow=1;j.Scat=0}else{j.Hist=1}}if(k.check("BOX",true)){j.Box=10+k.partAsInt()}if(j.Box){if(i>1){j.Scat=0}else{j.Hist=1}}if(k.check("COL",true)){j.Color=1;if(k.part.indexOf("0")>=0){j.Color=11}if(k.part.indexOf("1")>=0){j.Color=11}if(k.part.indexOf("2")>=0){j.Color=12}if(k.part.indexOf("3")>=0){j.Color=13}if(k.part.indexOf("Z")>=0){j.Zscale=1}if(i==1){j.Hist=1}else{j.Scat=0}}if(k.check("CHAR")){j.Char=1;j.Scat=0}if(k.check("FUNC")){j.Func=2;j.Hist=0}if(k.check("AXIS")){j.Axis=1}if(k.check("AXIG")){j.Axis=2}if(k.check("TEXT",true)){j.Text=1;j.Scat=0;j.Hist=0;var h=Math.min(k.partAsInt(),90);if(h){j.Text=1000+h}if(k.part.indexOf("N")>=0&&this.IsTH2Poly()){j.Text=3000+h}if(k.part.indexOf("E")>=0){j.Text=2000+h}}if(k.check("SCAT=",true)){j.Scat=1;j.ScatCoef=parseFloat(k.part);if(isNaN(j.ScatCoef)||(j.ScatCoef<=0)){j.ScatCoef=1}}if(k.check("SCAT")){j.Scat=1}if(k.check("POL")){j.System=a.Painter.Coord.kPOLAR}if(k.check("CYL")){j.System=a.Painter.Coord.kCYLINDRICAL}if(k.check("SPH")){j.System=a.Painter.Coord.kSPHERICAL}if(k.check("PSR")){j.System=a.Painter.Coord.kRAPIDITY}if(k.check("TRI",true)){j.Scat=0;j.Color=0;j.Tri=1;if(k.part.indexOf("FB")>=0){j.FrontBox=0}if(k.part.indexOf("BB")>=0){j.BackBox=0}if(k.part.indexOf("ERR")>=0){j.Error=1}}if(k.check("AITOFF")){j.Proj=1}if(k.check("MERCATOR")){j.Proj=2}if(k.check("SINUSOIDAL")){j.Proj=3}if(k.check("PARABOLIC")){j.Proj=4}if(j.Proj>0){j.Scat=0;j.Contour=14}if((i==3)&&k.check("FB")){j.FrontBox=0}if((i==3)&&k.check("BB")){j.BackBox=0}if(k.check("LF2")){j.Line=2;j.Hist=-1;j.Error=0;m=true}if(k.check("L")){j.Line=1;j.Hist=-1;j.Error=0}if(k.check("A")){j.Axis=-1}if(k.check("B1")){j.Bar=1;j.BaseLine=0;j.Hist=-1;m=true}if(k.check("B")){j.Bar=1;j.Hist=-1;m=true}if(k.check("C")){j.Curve=1;j.Hist=-1}if(k.check("][")){j.Off=1;j.Hist=1}if(k.check("F")){j.Fill=1}if(k.check("P0")){j.Mark=1;j.Hist=-1;j.Zero=1}if(k.check("P")){j.Mark=1;j.Hist=-1;j.Zero=0}if(k.check("Z")){j.Zscale=1}if(k.check("*H")||k.check("*")){j.Mark=23;j.Hist=-1}if(k.check("HIST")){j.Hist=2;j.Func=0;j.Error=0}if(this.IsTH2Poly()){if(j.Fill+j.Line+j.Mark!=0){j.Scat=0}}if(k.check("E",true)){if(i==1){j.Error=1;j.Zero=0;if(!isNaN(parseInt(k.part[0]))){j.Error=10+parseInt(k.part[0])}if((j.Error===13)||(j.Error===14)){m=true}if(j.Error===10){j.Zero=1}if(k.part.indexOf("X0")>=0){j.errorX=0}}else{if(j.Error==0){j.Error=100;j.Scat=0}}}if(k.check("9")){j.HighRes=1}if(k.check("0")){j.Zero=0}if(l){if(m&&this.fillatt&&(this.fillatt.color=="none")){this.fillatt.Change(5,1001)}}return j};a.THistPainter.prototype.GetAutoColor=function(c){if(this.options.AutoColor<=0){return c}var d=this.options.AutoColor;this.options.AutoColor=d%8+1;return a.Painter.root_colors[d]};a.THistPainter.prototype.ScanContent=function(c){alert("HistPainter.prototype.ScanContent not implemented")};a.THistPainter.prototype.CheckPadRange=function(){if(!this.is_main_painter()){return}this.zoom_xmin=this.zoom_xmax=0;this.zoom_ymin=this.zoom_ymax=0;this.zoom_zmin=this.zoom_zmax=0;var h=this.Dimension(),i=this.histo.fXaxis,f=this.histo.fYaxis,d=this.histo.fXaxis;if(i.TestBit(a.EAxisBits.kAxisRange)){if((i.fFirst!==i.fLast)&&((i.fFirst>1)||(i.fLast<i.fNbins))){this.zoom_xmin=i.fFirst>1?i.GetBinLowEdge(i.fFirst):i.fXmin;this.zoom_xmax=i.fLast<i.fNbins?i.GetBinLowEdge(i.fLast+1):i.fXmax}}if((h>1)&&f.TestBit(a.EAxisBits.kAxisRange)){if((f.fFirst!==f.fLast)&&((f.fFirst>1)||(f.fLast<f.fNbins))){this.zoom_ymin=f.fFirst>1?f.GetBinLowEdge(f.fFirst):f.fXmin;this.zoom_ymax=f.fLast<f.fNbins?f.GetBinLowEdge(f.fLast+1):f.fXmax}}if((h>2)&&d.TestBit(a.EAxisBits.kAxisRange)){if((d.fFirst!==d.fLast)&&((d.fFirst>1)||(d.fLast<d.fNbins))){this.zoom_zmin=d.fFirst>1?d.GetBinLowEdge(d.fFirst):d.fXmin;this.zoom_zmax=d.fLast<d.fNbins?d.GetBinLowEdge(d.fLast+1):d.fXmax}}var g=this.root_pad();if(!g||!("fUxmin" in g)||this.create_canvas){return}var e=g.fUxmin,c=g.fUxmax;if((h<3)&&((e!==0)||(c!==1))){if(g.fLogx>0){e=Math.exp(e*Math.log(10));c=Math.exp(c*Math.log(10))}if(e!==i.fXmin||c!==i.fXmax){if(e>=i.fXmin&&c<=i.fXmax){this.zoom_xmin=e;this.zoom_xmax=c}}}e=g.fUymin;c=g.fUymax;if((h==2)&&((e!==0)||(c!==1))){if(g.fLogy>0){e=Math.exp(e*Math.log(10));c=Math.exp(c*Math.log(10))}if(e!==f.fXmin||c!==f.fXmax){if(e>=f.fXmin&&c<=f.fXmax){this.zoom_ymin=e;this.zoom_ymax=c}}}};a.THistPainter.prototype.CheckHistDrawAttributes=function(){if(!this.fillatt||!this.fillatt.changed){this.fillatt=this.createAttFill(this.histo,undefined,undefined,1)}if(!this.lineatt||!this.lineatt.changed){this.lineatt=a.Painter.createAttLine(this.histo);var c=this.main_painter();if(c){var d=c.GetAutoColor(this.lineatt.color);if(d!==this.lineatt.color){this.lineatt.color=d;this.lineatt.changed=true}}}};a.THistPainter.prototype.UpdateObject=function(h){var c=this.GetObject();if(h!==c){if(!this.MatchObjectType(h)){return false}c.fFillColor=h.fFillColor;c.fFillStyle=h.fFillStyle;c.fLineColor=h.fLineColor;c.fLineStyle=h.fLineStyle;c.fLineWidth=h.fLineWidth;c.fEntries=h.fEntries;c.fTsumw=h.fTsumw;c.fTsumwx=h.fTsumwx;c.fTsumwx2=h.fTsumwx2;c.fXaxis.fNbins=h.fXaxis.fNbins;if(this.Dimension()>1){c.fTsumwy=h.fTsumwy;c.fTsumwy2=h.fTsumwy2;c.fTsumwxy=h.fTsumwxy;c.fYaxis.fNbins=h.fYaxis.fNbins;if(this.Dimension()>2){c.fTsumwz=h.fTsumwz;c.fTsumwz2=h.fTsumwz2;c.fTsumwxz=h.fTsumwxz;c.fTsumwyz=h.fTsumwyz;c.fZaxis.fNbins=h.fZaxis.fNbins}}c.fArray=h.fArray;c.fNcells=h.fNcells;c.fTitle=h.fTitle;c.fMinimum=h.fMinimum;c.fMaximum=h.fMaximum;function d(k,j){k.fTitle=j.fTitle;k.fLabels=j.fLabels}d(c.fXaxis,h.fXaxis);d(c.fYaxis,h.fYaxis);d(c.fZaxis,h.fZaxis);if(!this.main_painter().zoom_changed_interactive){function f(k,j){k.fXmin=j.fXmin;k.fXmax=j.fXmax;k.fFirst=j.fFirst;k.fLast=j.fLast;k.fBits=j.fBits}f(c.fXaxis,h.fXaxis);f(c.fYaxis,h.fYaxis);f(c.fZaxis,h.fZaxis)}c.fSumw2=h.fSumw2;if(this.IsTProfile()){c.fBinEntries=h.fBinEntries}if(h.fFunctions&&!this.options.Same&&this.options.Func){for(var i=0;i<h.fFunctions.arr.length;++i){var g=h.fFunctions.arr[i];if(!g||!g._typename||!g.fName){continue}var e=this.FindPainterFor(null,g.fName,g._typename);if(e){e.UpdateObject(g)}}}}if(!this.zoom_changed_interactive){this.CheckPadRange()}this.ScanContent();this.histogram_updated=true;return true};a.THistPainter.prototype.CreateAxisFuncs=function(d,c){this.xmin=this.histo.fXaxis.fXmin;this.xmax=this.histo.fXaxis.fXmax;if(this.histo.fXaxis.fXbins.length==this.nbinsx+1){this.regularx=false;this.GetBinX=function(f){var g=Math.round(f);if(g<=0){return this.xmin}if(g>this.nbinsx){return this.xmax}if(g==f){return this.histo.fXaxis.fXbins[g]}var e=(f<g)?g-1:g+1;return this.histo.fXaxis.fXbins[g]*Math.abs(f-e)+this.histo.fXaxis.fXbins[e]*Math.abs(f-g)};this.GetIndexX=function(e,g){for(var f=1;f<this.histo.fXaxis.fXbins.length;++f){if(e<this.histo.fXaxis.fXbins[f]){return Math.floor(f-1+g)}}return this.nbinsx}}else{this.regularx=true;this.binwidthx=(this.xmax-this.xmin);if(this.nbinsx>0){this.binwidthx=this.binwidthx/this.nbinsx}this.GetBinX=function(e){return this.xmin+e*this.binwidthx};this.GetIndexX=function(e,f){return Math.floor((e-this.xmin)/this.binwidthx+f)}}this.ymin=this.histo.fYaxis.fXmin;this.ymax=this.histo.fYaxis.fXmax;if(!d||(this.nbinsy==0)){return}if(this.histo.fYaxis.fXbins.length==this.nbinsy+1){this.regulary=false;this.GetBinY=function(f){var g=Math.round(f);if(g<=0){return this.ymin}if(g>this.nbinsy){return this.ymax}if(g==f){return this.histo.fYaxis.fXbins[g]}var e=(f<g)?g-1:g+1;return this.histo.fYaxis.fXbins[g]*Math.abs(f-e)+this.histo.fYaxis.fXbins[e]*Math.abs(f-g)};this.GetIndexY=function(g,f){for(var e=1;e<this.histo.fYaxis.fXbins.length;++e){if(g<this.histo.fYaxis.fXbins[e]){return Math.floor(e-1+f)}}return this.nbinsy}}else{this.regulary=true;this.binwidthy=(this.ymax-this.ymin);if(this.nbinsy>0){this.binwidthy=this.binwidthy/this.nbinsy}this.GetBinY=function(e){return this.ymin+e*this.binwidthy};this.GetIndexY=function(f,e){return Math.floor((f-this.ymin)/this.binwidthy+e)}}if(!c||(this.nbinsz==0)){return}if(this.histo.fZaxis.fXbins.length==this.nbinsz+1){this.regularz=false;this.GetBinZ=function(f){var g=Math.round(f);if(g<=0){return this.zmin}if(g>this.nbinsz){return this.zmax}if(g==f){return this.histo.fZaxis.fXbins[g]}var e=(f<g)?g-1:g+1;return this.histo.fZaxis.fXbins[g]*Math.abs(f-e)+this.histo.fZaxis.fXbins[e]*Math.abs(f-g)};this.GetIndexZ=function(g,f){for(var e=1;e<this.histo.fZaxis.fXbins.length;++e){if(g<this.histo.fZaxis.fXbins[e]){return Math.floor(e-1+f)}}return this.nbinsz}}else{this.regularz=true;this.binwidthz=(this.zmax-this.zmin);if(this.nbinsz>0){this.binwidthz=this.binwidthz/this.nbinsz}this.GetBinZ=function(e){return this.zmin+e*this.binwidthz};this.GetIndexZ=function(f,e){return Math.floor((f-this.zmin)/this.binwidthz+e)}}};a.THistPainter.prototype.CreateXY=function(){if(!this.is_main_painter()){this.x=this.main_painter().x;this.y=this.main_painter().y;return}this.swap_xy=false;if(this.options.Bar>=20){this.swap_xy=true}this.logx=this.logy=false;var c=this.frame_width(),e=this.frame_height(),f=this.root_pad();if(this.histo.fXaxis.fTimeDisplay){this.x_kind="time";this.timeoffsetx=a.Painter.getTimeOffset(this.histo.fXaxis);this.ConvertX=function(g){return new Date(this.timeoffsetx+g*1000)};this.RevertX=function(g){return(this.x.invert(g)-this.timeoffsetx)/1000}}else{this.x_kind=(this.histo.fXaxis.fLabels==null)?"normal":"labels";this.ConvertX=function(g){return g};this.RevertX=function(g){return this.x.invert(g)}}this.scale_xmin=this.xmin;this.scale_xmax=this.xmax;if(this.zoom_xmin!=this.zoom_xmax){this.scale_xmin=this.zoom_xmin;this.scale_xmax=this.zoom_xmax}if(this.x_kind=="time"){this.x=b.scaleTime()}else{if(this.swap_xy?f.fLogy:f.fLogx){this.logx=true;if(this.scale_xmax<=0){this.scale_xmax=0}if((this.scale_xmin<=0)&&(this.nbinsx>0)){for(var d=0;d<this.nbinsx;++d){this.scale_xmin=Math.max(this.scale_xmin,this.GetBinX(d));if(this.scale_xmin>0){break}}}if((this.scale_xmin<=0)||(this.scale_xmin>=this.scale_xmax)){this.scale_xmin=this.scale_xmax*0.0001}this.xmin_log=this.scale_xmin;this.x=b.scaleLog()}else{this.x=b.scaleLinear()}}this.x.domain([this.ConvertX(this.scale_xmin),this.ConvertX(this.scale_xmax)]).range(this.swap_xy?[e,0]:[0,c]);if(this.x_kind=="time"){this.grx=function(g){return this.x(this.ConvertX(g))}}else{if(this.logx){this.grx=function(g){return(g<this.scale_xmin)?(this.swap_xy?this.x.range()[0]+5:-5):this.x(g)}}else{this.grx=this.x}}this.scale_ymin=this.ymin;this.scale_ymax=this.ymax;if(this.zoom_ymin!=this.zoom_ymax){this.scale_ymin=this.zoom_ymin;this.scale_ymax=this.zoom_ymax}if(this.histo.fYaxis.fTimeDisplay){this.y_kind="time";this.timeoffsety=a.Painter.getTimeOffset(this.histo.fYaxis);this.ConvertY=function(g){return new Date(this.timeoffsety+g*1000)};this.RevertY=function(g){return(this.y.invert(g)-this.timeoffsety)/1000}}else{this.y_kind=((this.Dimension()==2)&&(this.histo.fYaxis.fLabels!=null))?"labels":"normal";this.ConvertY=function(g){return g};this.RevertY=function(g){return this.y.invert(g)}}if(this.swap_xy?f.fLogx:f.fLogy){this.logy=true;if(this.scale_ymax<=0){this.scale_ymax=1}else{if((this.zoom_ymin===this.zoom_ymax)&&(this.Dimension()==1)){this.scale_ymax*=1.8}}if((this.scale_ymin<=0)&&(this.nbinsy>0)&&(this.Dimension()>1)){for(var d=0;d<this.nbinsy;++d){this.scale_ymin=Math.max(this.scale_ymin,this.GetBinY(d));if(this.scale_ymin>0){break}}}if((this.scale_ymin<=0)&&("ymin_nz" in this)&&(this.ymin_nz>0)&&(this.ymin_nz<0.01*this.ymax)){this.scale_ymin=0.3*this.ymin_nz}if((this.scale_ymin<=0)||(this.scale_ymin>=this.scale_ymax)){this.scale_ymin=0.0003*this.scale_ymax}this.ymin_log=this.scale_ymin;this.y=b.scaleLog()}else{if(this.y_kind=="time"){this.y=b.scaleTime()}else{this.y=b.scaleLinear()}}this.y.domain([this.ConvertY(this.scale_ymin),this.ConvertY(this.scale_ymax)]).range(this.swap_xy?[0,c]:[e,0]);if(this.y_kind=="time"){this.gry=function(g){return this.y(this.ConvertY(g))}}else{if(this.logy){this.gry=function(g){return(g<this.scale_ymin)?(this.swap_xy?-5:this.y.range()[0]+5):this.y(g)}}else{this.gry=this.y}}this.SetRootPadRange(f)};a.THistPainter.prototype.SetRootPadRange=function(f){if(!f){return}if(this.logx){f.fUxmin=a.log10(this.scale_xmin);f.fUxmax=a.log10(this.scale_xmax)}else{f.fUxmin=this.scale_xmin;f.fUxmax=this.scale_xmax}if(this.logy){f.fUymin=a.log10(this.scale_ymin);f.fUymax=a.log10(this.scale_ymax)}else{f.fUymin=this.scale_ymin;f.fUymax=this.scale_ymax}var e=f.fUxmax-f.fUxmin,g=1-f.fLeftMargin-f.fRightMargin,c=f.fUymax-f.fUymin,d=1-f.fBottomMargin-f.fTopMargin;f.fX1=f.fUxmin-e/g*f.fLeftMargin;f.fX2=f.fUxmax+e/g*f.fRightMargin;f.fY1=f.fUymin-c/d*f.fBottomMargin;f.fY2=f.fUymax+c/d*f.fTopMargin};a.THistPainter.prototype.DrawGrids=function(){if(!this.is_main_painter()){return}var f=this.svg_frame().select(".grid_layer");f.selectAll(".xgrid").remove();f.selectAll(".ygrid").remove();var j=this.root_pad(),g=this.frame_height(),c=this.frame_width(),e,i=a.gStyle.fGridStyle,d="black";if(a.Painter.fGridColor>0){d=a.Painter.root_colors[a.Painter.fGridColor]}if((i<0)||(i>=a.Painter.root_line_styles.length)){i=11}if(j&&j.fGridx&&this.x_handle){e="";for(var k=0;k<this.x_handle.ticks.length;++k){if(this.swap_xy){e+="M0,"+this.x_handle.ticks[k]+"h"+c}else{e+="M"+this.x_handle.ticks[k]+",0v"+g}}if(e.length>0){f.append("svg:path").attr("class","xgrid").attr("d",e).style("stroke",d).style("stroke-width",a.gStyle.fGridWidth).style("stroke-dasharray",a.Painter.root_line_styles[i])}}if(j&&j.fGridy&&this.y_handle){e="";for(var k=0;k<this.y_handle.ticks.length;++k){if(this.swap_xy){e+="M"+this.y_handle.ticks[k]+",0v"+g}else{e+="M0,"+this.y_handle.ticks[k]+"h"+c}}if(e.length>0){f.append("svg:path").attr("class","ygrid").attr("d",e).style("stroke",d).style("stroke-width",a.gStyle.fGridWidth).style("stroke-dasharray",a.Painter.root_line_styles[i])}}};a.THistPainter.prototype.DrawBins=function(){alert("HistPainter.DrawBins not implemented")};a.THistPainter.prototype.AxisAsText=function(c,d){if(c=="x"){if(this.x_kind=="time"){d=this.ConvertX(d)}if(this.x_handle&&("format" in this.x_handle)){return this.x_handle.format(d)}return d.toPrecision(4)}if(c=="y"){if(this.y_kind=="time"){d=this.ConvertY(d)}if(this.y_handle&&("format" in this.y_handle)){return this.y_handle.format(d)}return d.toPrecision(4)}return d.toPrecision(4)};a.THistPainter.prototype.DrawAxes=function(k){if(!this.is_main_painter()){return}var i=this.svg_frame().select(".axis_layer"),l=this.frame_width(),g=this.frame_height(),e=this.root_pad();this.x_handle=new a.TAxisPainter(this.histo.fXaxis,true);this.x_handle.SetDivId(this.divid,-1);this.x_handle.pad_name=this.pad_name;this.x_handle.SetAxisConfig("xaxis",(this.logx&&(this.x_kind!=="time"))?"log":this.x_kind,this.x,this.xmin,this.xmax,this.scale_xmin,this.scale_xmax);this.x_handle.invert_side=(this.options.AxisPos>=10);this.y_handle=new a.TAxisPainter(this.histo.fYaxis,true);this.y_handle.SetDivId(this.divid,-1);this.y_handle.pad_name=this.pad_name;this.y_handle.SetAxisConfig("yaxis",(this.logy&&this.y_kind!=="time")?"log":this.y_kind,this.y,this.ymin,this.ymax,this.scale_ymin,this.scale_ymax);this.y_handle.invert_side=(this.options.AxisPos%10)===1;var j=this.swap_xy?this.y_handle:this.x_handle,c=this.swap_xy?this.x_handle:this.y_handle;j.DrawAxis(false,i,l,g,j.invert_side?undefined:"translate(0,"+g+")",false,e.fTickx?-g:0);c.DrawAxis(true,i,l,g,c.invert_side?"translate("+l+",0)":undefined,false,e.fTicky?l:0);if(k){return}var f=0,d=c.position;if((-0.2*l<d)&&(d<0)){f=-d/l+0.001;this.shrink_frame_left+=f}else{if((d>0)&&(d<0.3*l)&&(this.shrink_frame_left>0)&&(d/l>this.shrink_frame_left)){f=-this.shrink_frame_left;this.shrink_frame_left=0}}if(f!=0){this.frame_painter().Shrink(f,0);this.frame_painter().Redraw();this.CreateXY();this.DrawAxes(true)}};a.THistPainter.prototype.ToggleTitle=function(c){if(!this.is_main_painter()){return false}if(c==="only-check"){return !this.histo.TestBit(a.TH1StatusBits.kNoTitle)}this.histo.InvertBit(a.TH1StatusBits.kNoTitle);this.DrawTitle()};a.THistPainter.prototype.DrawTitle=function(){if(!this.is_main_painter()){return}var d=this.FindPainterFor(null,"title");var e=(d!==null)?d.GetObject():null;if(e===null){e=this.FindInPrimitives("title")}if((e!==null)&&(e._typename!=="TPaveText")){e=null}var c=!this.histo.TestBit(a.TH1StatusBits.kNoTitle);if(e!==null){e.Clear();if(c){e.AddText(this.histo.fTitle)}if(d){d.Redraw()}}else{if(c&&!d&&(this.histo.fTitle.length>0)){e=a.Create("TPaveText");a.extend(e,{fName:"title",fX1NDC:0.28,fY1NDC:0.94,fX2NDC:0.72,fY2NDC:0.99});e.AddText(this.histo.fTitle);a.Painter.drawPaveText(this.divid,e)}}};a.THistPainter.prototype.UpdateStatWebCanvas=function(){if(!this.snapid){return}var c=this.FindStat(),d=this.FindPainterFor(c);if(d&&!d.snapid){d.Redraw()}};a.THistPainter.prototype.ToggleStat=function(c){var d=this.FindStat(),e=null;if(!c){c=""}if(d==null){if(c.indexOf("-check")>0){return false}d=this.CreateStat()}else{e=this.FindPainterFor(d)}if(c=="only-check"){return e?e.Enabled:false}if(c=="fitpar-check"){return d?d.fOptFit:false}if(c=="fitpar-toggle"){if(!d){return false}d.fOptFit=d.fOptFit?0:1111;if(e){e.Redraw()}return true}if(e){e.Enabled=!e.Enabled;e.Redraw();return e.Enabled}a.draw(this.divid,d,"onpad:"+this.pad_name);return true};a.THistPainter.prototype.IsAxisZoomed=function(c){var d=this.main_painter()||this;return d["zoom_"+c+"min"]!==d["zoom_"+c+"max"]};a.THistPainter.prototype.GetSelectIndex=function(e,l,k){var i=0,h=this.main_painter();if(!h){h=this}var f=this["nbins"+e];if(!f){f=0}if(!k){k=0}var d="GetIndex"+e.toUpperCase(),g=h["zoom_"+e+"min"],j=h["zoom_"+e+"max"];if((g!=j)&&(d in this)){if(l=="left"){i=this[d](g,k)}else{i=this[d](j,k+0.5)}}else{i=(l=="left")?0:f}var c;if(this.histo){c=this.histo["f"+e.toUpperCase()+"axis"]}if(c){if((c.fFirst===c.fLast)||!c.TestBit(a.EAxisBits.kAxisRange)||((c.fFirst<=1)&&(c.fLast>=f))){c=undefined}}if(l=="left"){if(i<0){i=0}if(c&&(c.fFirst>1)&&(i<c.fFirst)){i=c.fFirst-1}}else{if(i>f){i=f}if(c&&(c.fLast<=f)&&(i>c.fLast)){i=c.fLast}}return i};a.THistPainter.prototype.FindStat=function(){if(this.histo.fFunctions!==null){for(var c=0;c<this.histo.fFunctions.arr.length;++c){var d=this.histo.fFunctions.arr[c];if((d._typename=="TPaveStats")&&(d.fName=="stats")){return d}}}return null};a.THistPainter.prototype.CreateStat=function(e){if(!this.draw_content||!this.is_main_painter()){return null}this.create_stats=true;var d=this.FindStat();if(d){return d}var c=a.gStyle;d=a.Create("TPaveStats");a.extend(d,{fName:"stats",fOptStat:e||c.fOptStat,fOptFit:c.fOptFit,fBorderSize:1});d.fX1NDC=c.fStatX-c.fStatW;d.fY1NDC=c.fStatY-c.fStatH;d.fX2NDC=c.fStatX;d.fY2NDC=c.fStatY;d.fFillColor=c.fStatColor;d.fFillStyle=c.fStatStyle;d.fTextAngle=0;d.fTextSize=c.fStatFontSize;d.fTextAlign=12;d.fTextColor=c.fStatTextColor;d.fTextFont=c.fStatFont;if(this.histo._typename.match(/^TProfile/)||this.histo._typename.match(/^TH2/)){d.fY1NDC=0.67}d.AddText(this.histo.fName);if(!this.histo.fFunctions){this.histo.fFunctions=a.Create("TList")}this.histo.fFunctions.Add(d,"");return d};a.THistPainter.prototype.AddFunction=function(e,d){var c=this.GetObject();if(!c||!e){return}if(c.fFunctions==null){c.fFunctions=a.Create("TList")}if(d){c.fFunctions.AddFirst(e)}else{c.fFunctions.Add(e)}};a.THistPainter.prototype.FindFunction=function(e){var c=this.GetObject().fFunctions;if(c===null){return null}for(var d=0;d<c.arr.length;++d){if(c.arr[d]._typename===e){return c.arr[d]}}return null};a.THistPainter.prototype.DrawNextFunction=function(g,h){if(this.options.Same||!this.options.Func||!this.histo.fFunctions||(g>=this.histo.fFunctions.arr.length)){return a.CallBack(h)}var f=this.histo.fFunctions.arr[g],c=this.histo.fFunctions.opt[g],e=false,d=this.FindPainterFor(f);if(d===null){if(f._typename==="TPaveText"||f._typename==="TPaveStats"){e=!this.histo.TestBit(a.TH1StatusBits.kNoStats)&&(this.options.NoStat!=1)}else{if(f._typename==="TF1"){e=!f.TestBit(a.BIT(9))}else{e=(f._typename!=="TPaletteAxis")}}}if(e){return a.draw(this.divid,f,c,this.DrawNextFunction.bind(this,g+1,h))}this.DrawNextFunction(g+1,h)};a.THistPainter.prototype.UnzoomUserRange=function(i,h,g){if(!this.histo){return false}var f=false,d=this;function e(j){if(!j){return false}if(!j.TestBit(a.EAxisBits.kAxisRange)){return false}if(j.fFirst===j.fLast){return false}if((j.fFirst<=1)&&(j.fLast>=j.fNbins)){return false}j.InvertBit(a.EAxisBits.kAxisRange);return true}function c(k,j){if(d.Dimension()!==k){return false}if((d.options.minimum===-1111)&&(d.options.maximum===-1111)){return false}if(!d.draw_content){return false}d.options.minimum=d.options.maximum=-1111;d.ScanContent(true);return true}if(i&&e(this.histo.fXaxis)){f=true}if(h&&(e(this.histo.fYaxis)||c(1,this.histo))){f=true}if(g&&(e(this.histo.fZaxis)||c(2,this.histo))){f=true}return f};a.THistPainter.prototype.ToggleLog=function(e){var h=this.main_painter(),g=this.root_pad();if(!h){h=this}var f=g["fLog"+e];if(!f){var d=this[e+"_kind"];if(this.swap_xy&&e==="x"){d=this["y_kind"]}else{if(this.swap_xy&&e==="y"){d=this["x_kind"]}}if(d==="labels"){return}}var c=this.pad_painter();if(c&&c._websocket){c._websocket.send("EXEC:SetLog"+e+(f?"(0)":"(1)"))}else{g["fLog"+e]=f?0:1;h.RedrawPad()}};a.THistPainter.prototype.Zoom=function(l,m,n,q,s,t){if(l==="x"){l=m;m=n;n=undefined}else{if(l==="y"){q=n;n=m;l=m=undefined}else{if(l==="z"){s=m;t=n;l=m=n=undefined}}}var h=this.main_painter(),f=(l!==m),e=(n!==q),d=(s!==t),k=false,j=false,i=false;if(f){var p=0,r=h.xmin;if(h.logx&&h.xmin_log){r=h.xmin_log}if(l<=r){l=r;p++}if(m>=h.xmax){m=h.xmax;p++}if(p===2){f=false;k=true}}else{k=(l===m)&&(l===0)}if(e){var p=0,u=h.ymin;if(h.logy&&h.ymin_log){u=h.ymin_log}if(n<=u){n=u;p++}if(q>=h.ymax){q=h.ymax;p++}if(p===2){e=false;j=true}}else{j=(n===q)&&(n===0)}if(d){var p=0,c=h.zmin;if(s<=c){s=c;p++}if(t>=h.zmax){t=h.zmax;p++}if(p===2){d=false;i=true}}else{i=(s===t)&&(s===0)}var g=false;if(f||e||d){h.ForEachPainter(function(v){if(f&&v.CanZoomIn("x",l,m)){h.zoom_xmin=l;h.zoom_xmax=m;g=true;f=false}if(e&&v.CanZoomIn("y",n,q)){h.zoom_ymin=n;h.zoom_ymax=q;g=true;e=false}if(d&&v.CanZoomIn("z",s,t)){h.zoom_zmin=s;h.zoom_zmax=t;g=true;d=false}})}if(k||j||i){if(k){if(h.zoom_xmin!==h.zoom_xmax){g=true}h.zoom_xmin=h.zoom_xmax=0}if(j){if(h.zoom_ymin!==h.zoom_ymax){g=true}h.zoom_ymin=h.zoom_ymax=0}if(i){if(h.zoom_zmin!==h.zoom_zmax){g=true}h.zoom_zmin=h.zoom_zmax=0}if(!g){g=h.UnzoomUserRange(k,j,i);var o=this.pad_painter(true);if(o&&o.painters){o.painters.forEach(function(v){if(v&&(v!==h)&&(typeof v.UnzoomUserRange=="function")){if(v.UnzoomUserRange(k,j,i)){g=true}}})}}}if(g){this.RedrawPad()}return g};a.THistPainter.prototype.Unzoom=function(g,e,d){if(typeof g==="undefined"){g=true;e=true;d=true}else{if(typeof g==="string"){d=g.indexOf("z")>=0;e=g.indexOf("y")>=0;g=g.indexOf("x")>=0}}var c=this.zoom_changed_interactive;if(g||e||g){this.zoom_changed_interactive=2}var f=this.Zoom(g?0:undefined,g?0:undefined,e?0:undefined,e?0:undefined,d?0:undefined,d?0:undefined);if((g||e||g)&&!f){this.zoom_changed_interactive=(!isNaN(c)&&(c>0))?c-1:0}return f};a.THistPainter.prototype.clearInteractiveElements=function(){a.Painter.closeMenu();if(this.zoom_rect!=null){this.zoom_rect.remove();this.zoom_rect=null}this.zoom_kind=0;this.SwitchTooltip(true)};a.THistPainter.prototype.mouseDoubleClick=function(){b.event.preventDefault();var c=b.mouse(this.svg_frame().node());this.clearInteractiveElements();var d="xyz";if((c[0]<0)||(c[0]>this.frame_width())){d=this.swap_xy?"x":"y"}else{if((c[1]<0)||(c[1]>this.frame_height())){d=this.swap_xy?"y":"x"}}this.Unzoom(d)};a.THistPainter.prototype.startRectSel=function(){if(this.zoom_kind>100){return}if((b.event.which||b.event.button)!==1){return}b.event.preventDefault();this.clearInteractiveElements();this.zoom_origin=b.mouse(this.svg_frame().node());var c=this.frame_width(),d=this.frame_height();this.zoom_curr=[Math.max(0,Math.min(c,this.zoom_origin[0])),Math.max(0,Math.min(d,this.zoom_origin[1]))];if((this.zoom_origin[0]<0)||(this.zoom_origin[0]>c)){this.zoom_kind=3;this.zoom_origin[0]=0;this.zoom_origin[1]=this.zoom_curr[1];this.zoom_curr[0]=c;this.zoom_curr[1]+=1}else{if((this.zoom_origin[1]<0)||(this.zoom_origin[1]>d)){this.zoom_kind=2;this.zoom_origin[0]=this.zoom_curr[0];this.zoom_origin[1]=0;this.zoom_curr[0]+=1;this.zoom_curr[1]=d}else{this.zoom_kind=1;this.zoom_origin[0]=this.zoom_curr[0];this.zoom_origin[1]=this.zoom_curr[1]}}b.select(window).on("mousemove.zoomRect",this.moveRectSel.bind(this)).on("mouseup.zoomRect",this.endRectSel.bind(this),true);this.zoom_rect=null;this.SwitchTooltip(false);b.event.stopPropagation()};a.THistPainter.prototype.moveRectSel=function(){if((this.zoom_kind==0)||(this.zoom_kind>100)){return}b.event.preventDefault();var c=b.mouse(this.svg_frame().node());c[0]=Math.max(0,Math.min(this.frame_width(),c[0]));c[1]=Math.max(0,Math.min(this.frame_height(),c[1]));switch(this.zoom_kind){case 1:this.zoom_curr[0]=c[0];this.zoom_curr[1]=c[1];break;case 2:this.zoom_curr[0]=c[0];break;case 3:this.zoom_curr[1]=c[1];break}if(this.zoom_rect===null){this.zoom_rect=this.svg_frame().append("rect").attr("class","zoom").attr("pointer-events","none")}this.zoom_rect.attr("x",Math.min(this.zoom_origin[0],this.zoom_curr[0])).attr("y",Math.min(this.zoom_origin[1],this.zoom_curr[1])).attr("width",Math.abs(this.zoom_curr[0]-this.zoom_origin[0])).attr("height",Math.abs(this.zoom_curr[1]-this.zoom_origin[1]))};a.THistPainter.prototype.endRectSel=function(){if((this.zoom_kind==0)||(this.zoom_kind>100)){return}b.event.preventDefault();b.select(window).on("mousemove.zoomRect",null).on("mouseup.zoomRect",null);var e=b.mouse(this.svg_frame().node());e[0]=Math.max(0,Math.min(this.frame_width(),e[0]));e[1]=Math.max(0,Math.min(this.frame_height(),e[1]));var f=[true,true];switch(this.zoom_kind){case 1:this.zoom_curr[0]=e[0];this.zoom_curr[1]=e[1];break;case 2:this.zoom_curr[0]=e[0];f[1]=false;break;case 3:this.zoom_curr[1]=e[1];f[0]=false;break}var c,h,j,d,g=false,k=this.swap_xy?1:0,i=1-k;if(f[k]&&(Math.abs(this.zoom_curr[k]-this.zoom_origin[k])>10)){c=Math.min(this.RevertX(this.zoom_origin[k]),this.RevertX(this.zoom_curr[k]));h=Math.max(this.RevertX(this.zoom_origin[k]),this.RevertX(this.zoom_curr[k]));g=true}if(f[i]&&(Math.abs(this.zoom_curr[i]-this.zoom_origin[i])>10)){j=Math.min(this.RevertY(this.zoom_origin[i]),this.RevertY(this.zoom_curr[i]));d=Math.max(this.RevertY(this.zoom_origin[i]),this.RevertY(this.zoom_curr[i]));g=true}this.clearInteractiveElements();if(g){this.zoom_changed_interactive=2;this.Zoom(c,h,j,d)}};a.THistPainter.prototype.startTouchZoom=function(){if(this.zoom_kind!=0){b.event.preventDefault();b.event.stopPropagation();return}var d=b.touches(this.svg_frame().node());this.touch_cnt+=1;if(d.length==1){var f=new Date();var i=f.getTime()-this.last_touch.getTime();this.last_touch=f;if((i<300)&&(this.zoom_curr!=null)&&(Math.abs(this.zoom_curr[0]-d[0][0])<30)&&(Math.abs(this.zoom_curr[1]-d[0][1])<30)){b.event.preventDefault();b.event.stopPropagation();this.clearInteractiveElements();this.Unzoom("xyz");this.last_touch=new Date(0);this.svg_frame().on("touchcancel",null).on("touchend",null,true)}else{if(a.gStyle.ContextMenu){this.zoom_curr=d[0];this.svg_frame().on("touchcancel",this.endTouchSel.bind(this)).on("touchend",this.endTouchSel.bind(this));b.event.preventDefault();b.event.stopPropagation()}}}if((d.length!=2)||!a.gStyle.Zooming||!a.gStyle.ZoomTouch){return}b.event.preventDefault();b.event.stopPropagation();this.clearInteractiveElements();this.svg_frame().on("touchcancel",null).on("touchend",null);var c=d[0],j=d[1],e=this.frame_width(),g=this.frame_height();this.zoom_curr=[Math.min(c[0],j[0]),Math.min(c[1],j[1])];this.zoom_origin=[Math.max(c[0],j[0]),Math.max(c[1],j[1])];if((this.zoom_curr[0]<0)||(this.zoom_curr[0]>e)){this.zoom_kind=103;this.zoom_curr[0]=0;this.zoom_origin[0]=e}else{if((this.zoom_origin[1]>g)||(this.zoom_origin[1]<0)){this.zoom_kind=102;this.zoom_curr[1]=0;this.zoom_origin[1]=g}else{this.zoom_kind=101}}this.SwitchTooltip(false);this.zoom_rect=this.svg_frame().append("rect").attr("class","zoom").attr("id","zoomRect").attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]);b.select(window).on("touchmove.zoomRect",this.moveTouchSel.bind(this)).on("touchcancel.zoomRect",this.endTouchSel.bind(this)).on("touchend.zoomRect",this.endTouchSel.bind(this))};a.THistPainter.prototype.moveTouchSel=function(){if(this.zoom_kind<100){return}b.event.preventDefault();var d=b.touches(this.svg_frame().node());if(d.length!=2){return this.clearInteractiveElements()}var c=d[0],e=d[1];if(this.zoom_kind!=103){this.zoom_curr[0]=Math.min(c[0],e[0]);this.zoom_origin[0]=Math.max(c[0],e[0])}if(this.zoom_kind!=102){this.zoom_curr[1]=Math.min(c[1],e[1]);this.zoom_origin[1]=Math.max(c[1],e[1])}this.zoom_rect.attr("x",this.zoom_curr[0]).attr("y",this.zoom_curr[1]).attr("width",this.zoom_origin[0]-this.zoom_curr[0]).attr("height",this.zoom_origin[1]-this.zoom_curr[1]);if((this.zoom_origin[0]-this.zoom_curr[0]>10)||(this.zoom_origin[1]-this.zoom_curr[1]>10)){this.SwitchTooltip(false)}b.event.stopPropagation()};a.THistPainter.prototype.endTouchSel=function(){this.svg_frame().on("touchcancel",null).on("touchend",null);if(this.zoom_kind===0){b.event.preventDefault();var d=new Date();var k=d.getTime()-this.last_touch.getTime();if((k>500)&&(k<2000)&&!this.frame_painter().IsTooltipShown()){this.ShowContextMenu("main",{clientX:this.zoom_curr[0],clientY:this.zoom_curr[1]});this.last_touch=new Date(0)}else{this.clearInteractiveElements()}}if(this.zoom_kind<100){return}b.event.preventDefault();b.select(window).on("touchmove.zoomRect",null).on("touchend.zoomRect",null).on("touchcancel.zoomRect",null);var c,j,l,e,i=false,f=this.swap_xy?1:0,h=1-f,g=[true,true];if(this.zoom_kind===102){g[1]=false}if(this.zoom_kind===103){g[0]=false}if(g[f]&&(Math.abs(this.zoom_curr[f]-this.zoom_origin[f])>10)){c=Math.min(this.RevertX(this.zoom_origin[f]),this.RevertX(this.zoom_curr[f]));j=Math.max(this.RevertX(this.zoom_origin[f]),this.RevertX(this.zoom_curr[f]));i=true}if(g[h]&&(Math.abs(this.zoom_curr[h]-this.zoom_origin[h])>10)){l=Math.min(this.RevertY(this.zoom_origin[h]),this.RevertY(this.zoom_curr[h]));e=Math.max(this.RevertY(this.zoom_origin[h]),this.RevertY(this.zoom_curr[h]));i=true}this.clearInteractiveElements();this.last_touch=new Date(0);if(i){this.zoom_changed_interactive=2;this.Zoom(c,j,l,e)}b.event.stopPropagation()};a.THistPainter.prototype.AllowDefaultYZooming=function(){if(this.Dimension()>1){return true}if(this.draw_content){return false}var e=this.pad_painter(true);if(e&&e.painters){for(var d=0;d<e.painters.length;++d){var c=e.painters[d];if((c!==this)&&c.wheel_zoomy!==undefined){return c.wheel_zoomy}}}return false};a.THistPainter.prototype.AnalyzeMouseWheelEvent=function(c,o,e,j){o.min=o.max=undefined;o.changed=false;if(j&&o.ignore){return}var n=0,p=1,l=1;if("dleft" in o){p=o.dleft;n=1}if("dright" in o){l=o.dright;n=1}if("delta" in o){n=o.delta}else{if(c&&c.wheelDelta!==undefined){n=-c.wheelDelta}else{if(c&&c.deltaY!==undefined){n=c.deltaY}else{if(c&&c.detail!==undefined){n=c.detail}}}}if(n===0){return}n=(n<0)?-0.2:0.2;p*=n;l*=n;var d=o.min=this["scale_"+o.name+"min"],g=o.max=this["scale_"+o.name+"max"],f=this[o.name+"min"],m=this[o.name+"max"];if((o.min===o.max)&&(n<0)){o.min=f;o.max=m}if(o.min>=o.max){return}if((e>0)&&(e<1)){if(this["log"+o.name]){var k=(o.min>0)?a.log10(o.max/o.min):2;if(k>10){k=10}else{if(k<0.01){k=0.01}}o.min=o.min/Math.pow(10,k*p*e);o.max=o.max*Math.pow(10,k*l*(1-e))}else{var h=(o.max-o.min),i=h;if(p>0){h=1.001*h/(1-p)}o.min+=-p*e*h;if(l>0){i=1.001*i/(1-l)}o.max-=-l*(1-e)*i}if(o.min>=o.max){o.min=o.max=undefined}else{if(p!==l){if(((o.min<f)&&(d===f))||((o.max>m)&&(g==m))){o.min=o.max=undefined}}}}else{o.min=o.max=undefined}o.changed=((o.min!==undefined)&&(o.max!==undefined))};a.THistPainter.prototype.mouseWheel=function(){b.event.stopPropagation();b.event.preventDefault();this.clearInteractiveElements();var f={name:"x",ignore:false},e={name:"y",ignore:!this.AllowDefaultYZooming()},g=b.mouse(this.svg_frame().node()),c=this.frame_width(),d=this.frame_height();this.AnalyzeMouseWheelEvent(b.event,this.swap_xy?e:f,g[0]/c,(g[1]>=0)&&(g[1]<=d));this.AnalyzeMouseWheelEvent(b.event,this.swap_xy?f:e,1-g[1]/d,(g[0]>=0)&&(g[0]<=c));this.Zoom(f.min,f.max,e.min,e.max);if(f.changed||e.changed){this.zoom_changed_interactive=2}};a.THistPainter.prototype.ShowAxisStatus=function(f){var e=this.GetShowStatusFunc();if(!e){return}var g=this.histo?this.histo["f"+f.toUpperCase()+"axis"]:null;var j=f,d="TAxis";if(g){j=g.fName;d=g.fTitle||"histogram TAxis object"}var c=b.mouse(this.svg_frame().node());var i=(f=="x")?0:1;if(this.swap_xy){i=1-i}var h=(f=="x")?this.RevertX(c[i]):this.RevertY(c[i]);e(j,d,f+" : "+this.AxisAsText(f,h),c[0].toFixed(0)+","+c[1].toFixed(0))};a.THistPainter.prototype.AddInteractive=function(){if((!a.gStyle.Zooming&&!a.gStyle.ContextMenu)||!this.is_main_painter()){return}var c=this.svg_frame();if(c.empty()||c.property("interactive_set")){return}this.AddKeysHandler();this.last_touch=new Date(0);this.zoom_kind=0;this.zoom_rect=null;this.zoom_origin=null;this.zoom_curr=null;this.touch_cnt=0;if(a.gStyle.Zooming){if(a.gStyle.ZoomMouse){c.on("mousedown",this.startRectSel.bind(this));c.on("dblclick",this.mouseDoubleClick.bind(this))}if(a.gStyle.ZoomWheel){c.on("wheel",this.mouseWheel.bind(this))}}if(a.touches&&((a.gStyle.Zooming&&a.gStyle.ZoomTouch)||a.gStyle.ContextMenu)){c.on("touchstart",this.startTouchZoom.bind(this))}if(a.gStyle.ContextMenu){if(a.touches){c.selectAll(".xaxis_container").on("touchstart",this.startTouchMenu.bind(this,"x"));c.selectAll(".yaxis_container").on("touchstart",this.startTouchMenu.bind(this,"y"))}c.on("contextmenu",this.ShowContextMenu.bind(this));c.selectAll(".xaxis_container").on("contextmenu",this.ShowContextMenu.bind(this,"x"));c.selectAll(".yaxis_container").on("contextmenu",this.ShowContextMenu.bind(this,"y"))}c.selectAll(".xaxis_container").on("mousemove",this.ShowAxisStatus.bind(this,"x"));c.selectAll(".yaxis_container").on("mousemove",this.ShowAxisStatus.bind(this,"y"));c.property("interactive_set",true)};a.THistPainter.prototype.AddKeysHandler=function(){if(this.keys_handler||!this.is_main_painter()||a.BatchMode||(typeof window=="undefined")){return}this.keys_handler=this.ProcessKeyPress.bind(this);window.addEventListener("keydown",this.keys_handler,false)};a.THistPainter.prototype.ProcessKeyPress=function(i){var c=this.select_main();if(c.empty()){return}var h=c.attr("frame_active");if(h&&h!=="true"){return}var e="";switch(i.keyCode){case 33:e="PageUp";break;case 34:e="PageDown";break;case 37:e="ArrowLeft";break;case 38:e="ArrowUp";break;case 39:e="ArrowRight";break;case 40:e="ArrowDown";break;case 42:e="PrintScreen";break;case 106:e="*";break;default:return false}if(i.shiftKey){e="Shift "+e}if(i.altKey){e="Alt "+e}if(i.ctrlKey){e="Ctrl "+e}var g={name:"x",dleft:0,dright:0};switch(e){case"ArrowLeft":g.dleft=-1;g.dright=1;break;case"ArrowRight":g.dleft=1;g.dright=-1;break;case"Ctrl ArrowLeft":g.dleft=g.dright=-1;break;case"Ctrl ArrowRight":g.dleft=g.dright=1;break;case"ArrowUp":g.name="y";g.dleft=1;g.dright=-1;break;case"ArrowDown":g.name="y";g.dleft=-1;g.dright=1;break;case"Ctrl ArrowUp":g.name="y";g.dleft=g.dright=1;break;case"Ctrl ArrowDown":g.name="y";g.dleft=g.dright=-1;break}if(g.dleft||g.dright){if(!a.gStyle.Zooming){return false}if(this.mode3d&&(e.indexOf("Ctrl")!==0)){return false}this.AnalyzeMouseWheelEvent(null,g,0.5);this.Zoom(g.name,g.min,g.max);if(g.changed){this.zoom_changed_interactive=2}i.stopPropagation();i.preventDefault()}else{var d=this.pad_painter(true),f=d?d.FindButton(e):"";if(f){d.PadButtonClick(f);i.stopPropagation();i.preventDefault()}}return true};a.THistPainter.prototype.ShowContextMenu=function(j,r,k){if(("zoom_kind" in this)&&(this.zoom_kind>100)){return}var p=this,l=false,m=null;if(!r){b.event.preventDefault();b.event.stopPropagation();r=b.event;if(j===undefined){var d=b.mouse(this.svg_frame().node()),i=b.touches(this.svg_frame().node()),g=this.pad_painter(true),c=null,f=null;m=this.frame_painter();if(i.length===1){c={x:i[0][0],y:i[0][1],touch:true}}else{if(d.length===2){c={x:d[0],y:d[1],touch:false}}}if((c!==null)&&(g!==null)){c.painters=true;var e=g.GetTooltips(c),q=1000;for(var h=0;h<e.length;++h){if(e[h]&&e[h].menu){var o=("menu_dist" in e[h])?e[h].menu_dist:7;if(o<q){f=e[h].painter;q=o}}}}if(f!==null){p=f}else{if(m!==null){j="frame"}}if(c!==null){l=(c.x>0)&&(c.x<20)&&(c.y>0)&&(c.y<20)}}}p.ctx_menu_evnt=r;a.Painter.createMenu(p,function(s){var n=s.painter.FillContextMenu(s,j,k);if(m&&(!n||(l&&(j!=="frame")))){n=m.FillContextMenu(s)}if(n){s.painter.FillObjectExecMenu(s,function(){s.painter.SwitchTooltip(false);s.show(s.painter.ctx_menu_evnt,s.painter.SwitchTooltip.bind(s.painter,true))})}})};a.THistPainter.prototype.ChangeUserRange=function(c){var g=this.histo["f"+c+"axis"];if(!g){return}var f="[1,"+g.fNbins+"]";if(g.TestBit(a.EAxisBits.kAxisRange)){f="["+g.fFirst+","+g.fLast+"]"}var e=prompt("Enter user range for axis "+c+" like [1,"+g.fNbins+"]",f);if(e==null){return}e=JSON.parse(e);if(!e||(e.length!=2)||isNaN(e[0])||isNaN(e[1])){return}g.fFirst=parseInt(e[0]);g.fLast=parseInt(e[1]);var d=(g.fFirst<g.fLast)&&(g.fFirst>=1)&&(g.fLast<=g.fNbins);if(d!=g.TestBit(a.EAxisBits.kAxisRange)){g.InvertBit(a.EAxisBits.kAxisRange)}this.Redraw()};a.THistPainter.prototype.FillContextMenu=function(h,f,g){this.clearInteractiveElements();if((f=="x")||(f=="y")||(f=="z")){var d=this.histo.fXaxis;if(f=="y"){d=this.histo.fYaxis}else{if(f=="z"){d=g?g:this.histo.fZaxis}}h.add("header: "+f.toUpperCase()+" axis");h.add("Unzoom",this.Unzoom.bind(this,f));h.addchk(this.options["Log"+f],"SetLog"+f,this.ToggleLog.bind(this,f));h.addchk(d.TestBit(a.EAxisBits.kMoreLogLabels),"More log",function(){d.InvertBit(a.EAxisBits.kMoreLogLabels);this.RedrawPad()});h.addchk(d.TestBit(a.EAxisBits.kNoExponent),"No exponent",function(){d.InvertBit(a.EAxisBits.kNoExponent);this.RedrawPad()});if((f==="z")&&(this.options.Zscale>0)){if(this.FillPaletteMenu){this.FillPaletteMenu(h)}}if(d!=null){h.add("sub:Labels");h.addchk(d.TestBit(a.EAxisBits.kCenterLabels),"Center",function(){d.InvertBit(a.EAxisBits.kCenterLabels);this.RedrawPad()});this.AddColorMenuEntry(h,"Color",d.fLabelColor,function(i){d.fLabelColor=parseInt(i);this.RedrawPad()});this.AddSizeMenuEntry(h,"Offset",0,0.1,0.01,d.fLabelOffset,function(i){d.fLabelOffset=parseFloat(i);this.RedrawPad()});this.AddSizeMenuEntry(h,"Size",0.02,0.11,0.01,d.fLabelSize,function(i){d.fLabelSize=parseFloat(i);this.RedrawPad()});h.add("endsub:");h.add("sub:Title");h.add("SetTitle",function(){var i=prompt("Enter axis title",d.fTitle);if(i!==null){d.fTitle=i;this.RedrawPad()}});h.addchk(d.TestBit(a.EAxisBits.kCenterTitle),"Center",function(){d.InvertBit(a.EAxisBits.kCenterTitle);this.RedrawPad()});h.addchk(d.TestBit(a.EAxisBits.kRotateTitle),"Rotate",function(){d.InvertBit(a.EAxisBits.kRotateTitle);this.RedrawPad()});this.AddColorMenuEntry(h,"Color",d.fTitleColor,function(i){d.fTitleColor=parseInt(i);this.RedrawPad()});this.AddSizeMenuEntry(h,"Offset",0,3,0.2,d.fTitleOffset,function(i){d.fTitleOffset=parseFloat(i);this.RedrawPad()});this.AddSizeMenuEntry(h,"Size",0.02,0.11,0.01,d.fTitleSize,function(i){d.fTitleSize=parseFloat(i);this.RedrawPad()});h.add("endsub:")}h.add("sub:Ticks");this.AddColorMenuEntry(h,"Color",d.fLineColor,function(i){d.fLineColor=parseInt(i);this.RedrawPad()});this.AddColorMenuEntry(h,"Color",d.fAxisColor,function(i){d.fAxisColor=parseInt(i);this.RedrawPad()});this.AddSizeMenuEntry(h,"Size",-0.05,0.055,0.01,d.fTickLength,function(i){d.fTickLength=parseFloat(i);this.RedrawPad()});h.add("endsub:");return true}if(f=="frame"){var e=this.frame_painter();if(e){return e.FillContextMenu(h)}}h.add("header:"+this.histo._typename+"::"+this.histo.fName);if(this.draw_content){h.addchk(this.ToggleStat("only-check"),"Show statbox",function(){this.ToggleStat()});if(this.Dimension()==1){h.add("User range X","X",this.ChangeUserRange)}else{h.add("sub:User ranges");h.add("X","X",this.ChangeUserRange);h.add("Y","Y",this.ChangeUserRange);if(this.Dimension()>2){h.add("Z","Z",this.ChangeUserRange)}h.add("endsub:")}if(typeof this.FillHistContextMenu=="function"){this.FillHistContextMenu(h)}}if((this.options.Lego>0)||(this.options.Surf>0)||(this.Dimension()===3)){if(h.size()>0){h.add("separator")}var c=this.main_painter()||this;h.addchk(c.tooltip_allowed,"Show tooltips",function(){c.tooltip_allowed=!c.tooltip_allowed});h.addchk(c.enable_hightlight,"Hightlight bins",function(){c.enable_hightlight=!c.enable_hightlight;if(!c.enable_hightlight&&c.BinHighlight3D){c.BinHighlight3D(null)}});h.addchk(c.options.FrontBox,"Front box",function(){c.options.FrontBox=!c.options.FrontBox;if(c.Render3D){c.Render3D()}});h.addchk(c.options.BackBox,"Back box",function(){c.options.BackBox=!c.options.BackBox;if(c.Render3D){c.Render3D()}});if(this.draw_content){h.addchk(!this.options.Zero,"Suppress zeros",function(){this.options.Zero=!this.options.Zero;this.RedrawPad()});if((this.options.Lego==12)||(this.options.Lego==14)){h.addchk(this.options.Zscale,"Z scale",function(){this.ToggleColz()});if(this.FillPaletteMenu){this.FillPaletteMenu(h)}}}if(c.control&&typeof c.control.reset==="function"){h.add("Reset camera",function(){c.control.reset()})}}this.FillAttContextMenu(h);if(this.histogram_updated&&this.zoom_changed_interactive){h.add("Let update zoom",function(){this.zoom_changed_interactive=0})}return true};a.THistPainter.prototype.ButtonClick=function(c){if(!this.is_main_painter()){return false}switch(c){case"ToggleZoom":if((this.zoom_xmin!==this.zoom_xmax)||(this.zoom_ymin!==this.zoom_ymax)||(this.zoom_zmin!==this.zoom_zmax)){this.Unzoom();return true}if(this.draw_content&&(typeof this.AutoZoom==="function")){this.AutoZoom();return true}break;case"ToggleLogX":this.ToggleLog("x");break;case"ToggleLogY":this.ToggleLog("y");break;case"ToggleLogZ":this.ToggleLog("z");break;case"ToggleStatBox":this.ToggleStat();return true;break}return false};a.THistPainter.prototype.FillToolbar=function(){var c=this.pad_painter(true);if(c===null){return}c.AddButton(a.ToolbarIcons.auto_zoom,"Toggle between unzoom and autozoom-in","ToggleZoom","Ctrl *");c.AddButton(a.ToolbarIcons.arrow_right,"Toggle log x","ToggleLogX","PageDown");c.AddButton(a.ToolbarIcons.arrow_up,"Toggle log y","ToggleLogY","PageUp");if(this.Dimension()>1){c.AddButton(a.ToolbarIcons.arrow_diag,"Toggle log z","ToggleLogZ")}if(this.draw_content){c.AddButton(a.ToolbarIcons.statbox,"Toggle stat box","ToggleStatBox")}};a.TH1Painter=function(c){a.THistPainter.call(this,c)};a.TH1Painter.prototype=Object.create(a.THistPainter.prototype);a.TH1Painter.prototype.ScanContent=function(m){if(!this.nbinsx&&m){m=false}if(!m){this.nbinsx=this.histo.fXaxis.fNbins;this.nbinsy=0;this.CreateAxisFuncs(false)}var e=this.GetSelectIndex("x","left"),p=this.GetSelectIndex("x","right");if(m){if((e===this.scan_xleft)&&(p===this.scan_xright)){return}}this.scan_xleft=e;this.scan_xright=p;var f=0,c=0,n=0,k=0,l=true,d=this.IsTProfile(),o,g;for(var j=0;j<this.nbinsx;++j){o=this.histo.getBinContent(j+1);k+=d?this.histo.fBinEntries[j+1]:o;if((j<e)||(j>=p)){continue}if(o>0){if((c==0)||(o<c)){c=o}}if(l){f=n=o;l=false}g=(this.options.Error>0)?this.histo.getBinError(j+1):0;f=Math.min(f,o-g);n=Math.max(n,o+g)}if(d){k+=this.histo.fBinEntries[0]+this.histo.fBinEntries[this.nbinsx+1]}else{k+=this.histo.getBinContent(0)+this.histo.getBinContent(this.nbinsx+1)}this.stat_entries=k;if(this.histo.fEntries>1){this.stat_entries=this.histo.fEntries}this.hmin=f;this.hmax=n;this.ymin_nz=c;if((this.nbinsx==0)||((Math.abs(f)<1e-300&&Math.abs(n)<1e-300))){this.draw_content=false;f=this.ymin;n=this.ymax}else{this.draw_content=true}if(this.draw_content){if(f>=n){if(f==0){this.ymin=0;this.ymax=1}else{if(f<0){this.ymin=2*f;this.ymax=0}else{this.ymin=0;this.ymax=f*2}}}else{var q=(n-f)*0.05;this.ymin=f-q;if((this.ymin<0)&&(f>=0)){this.ymin=0}this.ymax=n+q}}f=n=null;var h=false;if(this.options.minimum!==-1111){f=this.options.minimum;if(f<this.ymin){this.ymin=f}else{h=true}}if(this.options.maximum!==-1111){n=this.options.maximum;if(n>this.ymax){this.ymax=n}else{h=true}}if(h&&this.draw_content){this.zoom_ymin=(f===null)?this.ymin:f;this.zoom_ymax=(n===null)?this.ymax:n}if(!this.options.Bar&&!this.options.Hist&&!this.options.Line&&!this.options.Error&&!this.options.Same&&!this.options.Lego&&!this.options.Text){this.draw_content=false}if(this.options.Axis>0){this.draw_content=false}};a.TH1Painter.prototype.CountStat=function(o){var e=this.IsTProfile(),d=this.GetSelectIndex("x","left"),r=this.GetSelectIndex("x","right"),f=0,l=0,q=0,k=0,j=0,h,c=0,p=0,g=null,n=null,m={meanx:0,meany:0,rmsx:0,rmsy:0,integral:0,entries:this.stat_entries,xmax:0,wmax:0};for(h=d;h<r;++h){c=this.GetBinX(h+0.5);if(o&&!o(c)){continue}if(e){p=this.histo.fBinEntries[h+1];k+=this.histo.fArray[h+1];j+=this.histo.fSumw2[h+1]}else{p=this.histo.getBinContent(h+1)}if((g===null)||(p>n)){g=c;n=p}f+=p;l+=p*c;q+=p*c*c}if(!this.IsAxisZoomed("x")&&(this.histo.fTsumw>0)){f=this.histo.fTsumw;l=this.histo.fTsumwx;q=this.histo.fTsumwx2}m.integral=f;if(f>0){m.meanx=l/f;m.meany=k/f;m.rmsx=Math.sqrt(Math.abs(q/f-m.meanx*m.meanx));m.rmsy=Math.sqrt(Math.abs(j/f-m.meany*m.meany))}if(g!==null){m.xmax=g;m.wmax=n}return m};a.TH1Painter.prototype.FillStatistic=function(w,k,x){if(!this.histo){return false}var f=w.GetObject(),A=this.CountStat(),t=k%10,g=Math.floor(k/10)%10,m=Math.floor(k/100)%10,y=Math.floor(k/1000)%10,h=Math.floor(k/10000)%10,l=Math.floor(k/100000)%10,r=Math.floor(k/1000000)%10,B=Math.floor(k/10000000)%10,u=Math.floor(k/100000000)%10;if(t>0){f.AddText(this.histo.fName)}if(this.IsTProfile()){if(g>0){f.AddText("Entries = "+w.Format(A.entries,"entries"))}if(m>0){f.AddText("Mean = "+w.Format(A.meanx));f.AddText("Mean y = "+w.Format(A.meany))}if(y>0){f.AddText("Std Dev = "+w.Format(A.rmsx));f.AddText("Std Dev y = "+w.Format(A.rmsy))}}else{if(g>0){f.AddText("Entries = "+w.Format(A.entries,"entries"))}if(m>0){f.AddText("Mean = "+w.Format(A.meanx))}if(y>0){f.AddText("Std Dev = "+w.Format(A.rmsx))}if(h>0){f.AddText("Underflow = "+w.Format((this.histo.fArray.length>0)?this.histo.fArray[0]:0,"entries"))}if(l>0){f.AddText("Overflow = "+w.Format((this.histo.fArray.length>0)?this.histo.fArray[this.histo.fArray.length-1]:0,"entries"))}if(r>0){f.AddText("Integral = "+w.Format(A.integral,"entries"))}if(B>0){f.AddText("Skew = <not avail>")}if(u>0){f.AddText("Kurt = <not avail>")}}if(x!=0){var p=this.FindFunction("TF1");if(p!=null){var c=x%10;var q=Math.floor(x/10)%10;var d=Math.floor(x/100)%10;var j=Math.floor(x/1000)%10;if(d>0){f.AddText("#chi^2 / ndf = "+w.Format(p.fChisquare,"fit")+" / "+p.fNDF)}if(j>0){f.AddText("Prob = "+(("Math" in a)?w.Format(a.Math.Prob(p.fChisquare,p.fNDF)):"<not avail>"))}if(c>0){for(var o=0;o<p.fNpar;++o){var z=p.GetParName(o);var v=p.GetParValue(o);if(v!=null){v=w.Format(Number(v),"fit")}else{v="<not avail>"}var s="";if(p.fParErrors!=null){s=w.Format(p.fParErrors[o],"last");if((Number(s)==0)&&(p.fParErrors[o]!=0)){s=w.Format(p.fParErrors[o],"4.2g")}}if((q>0)&&(s.length>0)){f.AddText(z+" = "+v+" #pm "+s)}else{f.AddText(z+" = "+v)}}}}}var i=f.fLines.arr.length,e=i*a.gStyle.StatFontSize;if((e<=0)||(a.gStyle.StatFont%10===3)){e=0.25*i*a.gStyle.StatH;f.fY1NDC=0.93-e;f.fY2NDC=0.93}return true};a.TH1Painter.prototype.DrawBars=function(p,n){this.RecreateDrawG(false,"main_layer");var e=this.GetSelectIndex("x","left",-1),x=this.GetSelectIndex("x","right",1),h=this.main_painter(),v=this.root_pad(),f=this,r,t,s,g,d,j,m,l,k,o="",u="",q="",c=(this.options.Bar>10)?this.options.Bar%10:0;if(c>4){c=4}l=h.swap_xy?0:n;if((this.options.BaseLine!==false)&&!isNaN(this.options.BaseLine)){if(this.options.BaseLine>=h.scale_ymin){l=Math.round(h.gry(this.options.BaseLine))}}for(r=e;r<x;++r){t=this.GetBinX(r);s=this.GetBinX(r+1);if(h.logx&&(s<=0)){continue}g=Math.round(h.grx(t));d=Math.round(h.grx(s));j=this.histo.getBinContent(r+1);if(h.logy&&(j<h.scale_ymin)){continue}m=Math.round(h.gry(j));k=d-g;g+=Math.round(this.histo.fBarOffset/1000*k);k=Math.round(this.histo.fBarWidth/1000*k);if(h.swap_xy){o+="M"+l+","+g+"h"+(m-l)+"v"+k+"h"+(l-m)+"z"}else{o+="M"+g+","+m+"h"+k+"v"+(l-m)+"h"+(-k)+"z"}if(c>0){d=g+k;k=Math.round(k*c/10);if(h.swap_xy){u+="M"+l+","+g+"h"+(m-l)+"v"+k+"h"+(l-m)+"z";q+="M"+l+","+d+"h"+(m-l)+"v"+(-k)+"h"+(l-m)+"z"}else{u+="M"+g+","+m+"h"+k+"v"+(l-m)+"h"+(-k)+"z";q+="M"+d+","+m+"h"+(-k)+"v"+(l-m)+"h"+k+"z"}}}if(o.length>0){this.draw_g.append("svg:path").attr("d",o).call(this.fillatt.func)}if(u.length>0){this.draw_g.append("svg:path").attr("d",u).call(this.fillatt.func).style("fill",b.rgb(this.fillatt.color).brighter(0.5).toString())}if(q.length>0){this.draw_g.append("svg:path").attr("d",q).call(this.fillatt.func).style("fill",b.rgb(this.fillatt.color).darker(0.5).toString())}};a.TH1Painter.prototype.DrawFilledErrors=function(c,t){this.RecreateDrawG(false,"main_layer");var d=this.GetSelectIndex("x","left",-1),s=this.GetSelectIndex("x","right",1),h=this.main_painter(),f,n,g,l,m,k,j,r=[],p=[];for(f=d;f<s;++f){n=this.GetBinX(f+0.5);if(h.logx&&(n<=0)){continue}g=Math.round(h.grx(n));l=this.histo.getBinContent(f+1);m=this.histo.getBinError(f+1);if(h.logy&&(l-m<h.scale_ymin)){continue}k=Math.round(h.gry(l+m));j=Math.round(h.gry(l-m));r.push({grx:g,gry:k});p.unshift({grx:g,gry:j})}var e=(this.options.Error==14)?"bezier":"line";var q=a.Painter.BuildSvgPath(e,r),o=a.Painter.BuildSvgPath("L"+e,p);this.draw_g.append("svg:path").attr("d",q.path+o.path+"Z").style("stroke","none").call(this.fillatt.func)};a.TH1Painter.prototype.DrawBins=function(){this.CheckHistDrawAttributes();var c=this.frame_width(),d=this.frame_height();if(!this.draw_content||(c<=0)||(d<=0)){return this.RemoveDrawG()}if(this.options.Bar>0){return this.DrawBars(c,d)}if((this.options.Error==13)||(this.options.Error==14)){return this.DrawFilledErrors(c,d)}this.RecreateDrawG(false,"main_layer");var h=this.GetSelectIndex("x","left",-1),ae=this.GetSelectIndex("x","right",2),D=this.main_painter(),s=this.root_pad(),F=this,P="",X=false,f,n,l,ab,O,aa,N,p,ad,S,T,ah,u,al=!this.options.Zero,g=(this.options.Error>0),J=(this.options.Mark>0),e=(this.options.Line>0),w=(this.options.Text>0),M=null,q=null,ac=null,H=null,ag="",af="",z=0,j,B,A,an,ak,Y,W,V,am="",U,k,R;if(g&&!J&&(this.histo.fMarkerStyle>1)){J=true}if(this.options.Error==12){if(this.fillatt.color=="none"){J=true}else{M=""}}else{if(this.options.Error>0){q=""}}if(e){H=""}if(J){if(!this.markeratt){this.markeratt=a.Painter.createAttMarker(this.histo,this.options.Mark-20)}if(this.markeratt.size>0){ac="";this.markeratt.reset_pos()}else{J=false}}if(w){U=a.Painter.root_colors[this.histo.fMarkerColor];k=(this.options.Text>1000)?this.options.Text%1000:0;R=20;if((this.histo.fMarkerSize!==1)&&(k!==0)){R=0.02*d*this.histo.fMarkerSize}if((k===0)&&(this.options.Text<1000)){var aj=c/(ae-h+1);if(aj<3*R){k=90;R=Math.round(aj*0.7)}}this.StartTextDrawing(42,R,this.draw_g,R)}var L=((ae-h)>3*c);if(this.options.Error==11){var I=this.lineatt.width+a.gStyle.fEndErrorSize;ag="m0,"+I+"v-"+2*I+"m0,"+I;af="m"+I+",0h-"+2*I+"m"+I+",0";z=Math.floor((this.lineatt.width-1)/2)}var ai=g||J;if(ai||w||e){L=true}for(ah=h;ah<=ae;++ah){ab=this.GetBinX(ah);if(this.logx&&(ab<=0)){continue}O=Math.round(D.grx(ab));X=(ah===ae);if(X&&(h<ae)){N=l}else{aa=this.histo.getBinContent(ah+1);N=Math.round(D.gry(aa))}if(P.length===0){u=ah;T=f=n=O;S=p=ad=l=N;P="M"+n+","+l}else{if(L){if((O===n)&&!X){if(N<p){u=ah}p=Math.min(p,N);ad=Math.max(ad,N);l=N}else{if(ai||w||e){an=this.histo.getBinContent(u+1);if(!al||(an!==0)){Y=Math.round(D.grx(this.GetBinX(u)));W=Math.round(D.grx(this.GetBinX(u+1)));V=Math.round((Y+W)/2);j=Math.round(D.gry(an));B=A=20;if(g){ak=this.histo.getBinError(u+1);B=Math.round(j-D.gry(an+ak));A=Math.round(D.gry(an-ak)-j)}if(w){var Q=an;if((this.options.Text>=2000)&&(this.options.Text<3000)&&this.IsTProfile()&&this.histo.fBinEntries){Q=this.histo.fBinEntries[u+1]}var t=Math.round(Y+(W-Y)*0.1),r=Math.round(j-2-R),o=Math.round((W-Y)*0.8),m=R,v=Math.round(Q),Z=22;if(v===Q){v=Q.toString()}else{v=a.FFormat(Q,a.gStyle.fPaintTextFormat)}if(k!==0){t=V;r=Math.round(j-2-R/5);o=0;m=k-360;Z=12}if(Q!==0){this.DrawText(Z,t,r,o,m,v,U,0)}}if(e&&(H!==null)){H+=((H.length===0)?"M":"L")+V+","+j}if(ai){if((j>=-B)&&(j<=d+A)){if(M!==null){M+="M"+Y+","+(j-B)+"h"+(W-Y)+"v"+(B+A+1)+"h-"+(W-Y)+"z"}if(ac!==null){ac+=this.markeratt.create(V,j)}if(q!==null){if(this.options.errorX>0){var E=Math.round(V-(W-Y)*this.options.errorX),C=Math.round(V+(W-Y)*this.options.errorX);q+="M"+(E+z)+","+j+ag+"h"+(C-E-2*z)+ag}q+="M"+V+","+(j-B+z)+af+"v"+(B+A-2*z)+af}}}}}if(!ai&&((p!==ad)||(S!==p))){if(T!==n){P+="h"+(n-T)}if(l===p){if(ad!==S){P+="v"+(ad-S)}if(p!==ad){P+="v"+(p-ad)}}else{if(p!==S){P+="v"+(p-S)}if(ad!==p){P+="v"+(ad-p)}if(l!==ad){P+="v"+(l-ad)}}T=n;S=l}if(X&&(T!==O)){P+="h"+(O-T)}u=ah;p=ad=l=N;n=O}}else{if((N!==l)||X){if(O!==n){P+="h"+(O-n)}if(N!==l){P+="v"+(N-l)}l=N;n=O}}}}var G="";if(!this.fillatt.empty()){var K=(d+3);if((this.hmin>=0)&&(D.gry(0)<d)){K=Math.round(D.gry(0))}G="L"+n+","+K+"L"+f+","+K+"Z";if(P.length>0){P+=G}}if(ai||e){if((M!==null)&&(M.length>0)){this.draw_g.append("svg:path").attr("d",M).call(this.fillatt.func)}if((q!==null)&&(q.length>0)){this.draw_g.append("svg:path").attr("d",q).call(this.lineatt.func)}if((H!==null)&&(H.length>0)){if(!this.fillatt.empty()){this.draw_g.append("svg:path").attr("d",this.options.Line===2?(H+G):P).attr("stroke","none").call(this.fillatt.func)}this.draw_g.append("svg:path").attr("d",H).attr("fill","none").call(this.lineatt.func)}if((ac!==null)&&(ac.length>0)){this.draw_g.append("svg:path").attr("d",ac).call(this.markeratt.func)}}else{if((P.length>0)&&(this.options.Hist>0)){this.draw_g.append("svg:path").attr("d",P).style("stroke-linejoin","miter").call(this.lineatt.func).call(this.fillatt.func)}}if(w){this.FinishTextDrawing(this.draw_g)}};a.TH1Painter.prototype.GetBinTips=function(j){var d=[],i=this.GetTipName(),e=this.main_painter(),g=this.GetObject(),h=this.GetBinX(j),f=this.GetBinX(j+1),c=g.getBinContent(j+1);if(i.length>0){d.push(i)}if((this.options.Error>0)||(this.options.Mark>0)){d.push("x = "+e.AxisAsText("x",(h+f)/2));d.push("y = "+e.AxisAsText("y",c));if(this.options.Error>0){d.push("error x = "+((f-h)/2).toPrecision(4));d.push("error y = "+this.histo.getBinError(j+1).toPrecision(4))}}else{d.push("bin = "+(j+1));if(e.x_kind==="labels"){d.push("x = "+e.AxisAsText("x",h))}else{if(e.x_kind==="time"){d.push("x = "+e.AxisAsText("x",(h+f)/2))}else{d.push("x = ["+e.AxisAsText("x",h)+", "+e.AxisAsText("x",f)+")")}}if(g["$baseh"]){c-=g["$baseh"].getBinContent(j+1)}if(c===Math.round(c)){d.push("entries = "+c)}else{d.push("entries = "+a.FFormat(c,a.gStyle.fStatFormat))}}return d};a.TH1Painter.prototype.ProcessTooltip=function(P){if((P===null)||!this.draw_content||(this.options.Lego>0)||(this.options.Surf>0)){if(this.draw_g!==null){this.draw_g.select(".tooltip_bin").remove()}this.ProvideUserTooltip(null);return null}var c=this.frame_width(),e=this.frame_height(),u=this.main_painter(),o=this.root_pad(),k=this,z=null,t=true,s,E,q,g,C,f,n=2,i=this.GetSelectIndex("x","left",-1),L=this.GetSelectIndex("x","right",2),N=i,I=L;function y(d){var l=k.GetBinX(d);return(u.logx&&(l<=0))?null:u.grx(l)}function v(d){var l=k.histo.getBinContent(d+1);if(u.logy&&(l<k.scale_ymin)){return u.swap_xy?-1000:10*e}return Math.round(u.gry(l))}var K=u.swap_xy?P.y:P.x,J=u.swap_xy?P.x:P.y;while(N<I-1){var M=Math.round((N+I)*0.5);var x=y(M);if((x===null)||(x<K-0.5)){if(u.swap_xy){I=M}else{N=M}}else{if(x>K+0.5){if(u.swap_xy){N=M}else{I=M}}else{N++;I--}}}z=I=N;s=y(z);if(u.swap_xy){while((N>i)&&(y(N-1)<s+2)){--N}while((I<L)&&(y(I+1)>s-2)){++I}}else{while((N>i)&&(y(N-1)>s-2)){--N}while((I<L)&&(y(I+1)<s+2)){++I}}if(N<I){var H=e;for(var M=N;M<=I;M++){var j=Math.abs(v(M)-J);if(j<H){H=j;z=M}}if(H>e/10){z=Math.round(N+(I-N)/e*J)}s=y(z)}s=Math.round(s);q=Math.round(y(z+1));if(this.options.Bar>0){var F=q-s;s+=Math.round(this.histo.fBarOffset/1000*F);q=s+Math.round(this.histo.fBarWidth/1000*F)}if(s>q){var Q=s;s=q;q=Q}E=Math.round((s+q)/2);C=g=f=v(z);if(this.options.Bar>0){t=true;n=0;g=Math.round(u.gry(((this.options.BaseLine!==false)&&(this.options.BaseLine>u.scale_ymin))?this.options.BaseLine:u.scale_ymin));if(g>f){var Q=g;g=f;f=Q}if(!P.touch&&(P.nproc===1)){if((J<g)||(J>f)){z=null}}}else{if((this.options.Error>0)||(this.options.Mark>0)||(this.options.Line>0)){t=true;var p=3;if(this.markeratt){p=Math.max(p,2+Math.round(this.markeratt.size*4))}if(this.options.Error>0){var B=this.histo.getBinContent(z+1),O=this.histo.getBinError(z+1);g=Math.round(u.gry(B+O));f=Math.round(u.gry(B-O));if((B==0)&&this.IsTProfile()){z=null}var h=(q-s)*this.options.errorX;s=Math.round(E-h);q=Math.round(E+h)}if(q-s<2*p){s=E-p;q=E+p}g=Math.min(g,C-p);f=Math.max(f,C+p);if(!P.touch&&(P.nproc===1)){if((J<g)||(J>f)){z=null}}}else{t=(P.nproc===1)&&(L-i<c);if(t){if((P.y<g)&&!P.touch){z=null}f=e;if((this.fillatt.color!=="none")&&(this.hmin>=0)){f=Math.round(u.gry(0));if((f>e)||(f<=g)){f=e}}}}}if(z!==null){if((z===i)&&(s>K+n)){z=null}else{if((z===L-1)&&(q<K-n)){z=null}else{if((K<s-n)||(K>q+n)){z=null}else{if(!this.options.Zero&&(this.histo.getBinContent(z+1)===0)){z=null}}}}}var D=this.draw_g.select(".tooltip_bin");if((z===null)||((f<=0)||(g>=e))){D.remove();this.ProvideUserTooltip(null);return null}var A={name:this.histo.fName,title:this.histo.fTitle,x:E,y:C,color1:this.lineatt?this.lineatt.color:"green",color2:this.fillatt?this.fillatt.color:"blue",lines:this.GetBinTips(z)};if(P.disabled){D.remove();A.changed=true}else{if(t){if(D.empty()){D=this.draw_g.append("svg:rect").attr("class","tooltip_bin h1bin").style("pointer-events","none")}A.changed=D.property("current_bin")!==z;if(A.changed){D.attr("x",u.swap_xy?g:s).attr("width",u.swap_xy?f-g:q-s).attr("y",u.swap_xy?s:g).attr("height",u.swap_xy?q-s:f-g).style("opacity","0.3").property("current_bin",z)}A.exact=(Math.abs(C-J)<=5)||((J>=g)&&(J<=f));A.menu=true;A.menu_dist=Math.sqrt((E-K)*(E-K)+(C-J)*(C-J))}else{var G=this.lineatt.width+3;if(D.empty()){D=this.draw_g.append("svg:circle").attr("class","tooltip_bin").style("pointer-events","none").attr("r",G).call(this.lineatt.func).call(this.fillatt.func)}A.exact=(Math.abs(E-P.x)<=G)&&(Math.abs(C-P.y)<=G);A.menu=A.exact;A.menu_dist=Math.sqrt((E-P.x)*(E-P.x)+(C-P.y)*(C-P.y));A.changed=D.property("current_bin")!==z;if(A.changed){D.attr("cx",E).attr("cy",C).property("current_bin",z)}}}if(this.IsUserTooltipCallback()&&A.changed){this.ProvideUserTooltip({obj:this.histo,name:this.histo.fName,bin:z,cont:this.histo.getBinContent(z+1),grx:E,gry:C})}return A};a.TH1Painter.prototype.FillHistContextMenu=function(d){d.add("Auto zoom-in",this.AutoZoom);var c=a.getDrawSettings("ROOT."+this.GetObject()._typename,"nosame");d.addDrawMenu("Draw with",c.opts,function(e){if(e==="inspect"){return a.draw(this.divid,this.GetObject(),e)}this.options=this.DecodeOptions(e,true);this.RedrawPad()})};a.TH1Painter.prototype.AutoZoom=function(){var f=this.GetSelectIndex("x","left",-1),d=this.GetSelectIndex("x","right",1),g=d-f;if(g==0){return}var c=this.histo.getBinContent(f+1);for(var e=f;e<d;++e){c=Math.min(c,this.histo.getBinContent(e+1))}if(c>0){return}while((f<d)&&(this.histo.getBinContent(f+1)<=c)){++f}while((f<d)&&(this.histo.getBinContent(d)<=c)){--d}if((f===d-1)&&(f>2)&&(d<this.nbinsx-2)){--f;++d}if((d-f<g)&&(f<d)){this.Zoom(this.GetBinX(f),this.GetBinX(d))}};a.TH1Painter.prototype.CanZoomIn=function(e,d,c){if((e=="x")&&(this.GetIndexX(c,0.5)-this.GetIndexX(d,0)>1)){return true}if((e=="y")&&(Math.abs(c-d)>Math.abs(this.ymax-this.ymin)*0.000001)){return true}return false};a.TH1Painter.prototype.CallDrawFunc=function(g,e){var f=(this.options.Lego>0)?true:false,d=this.main_painter();if((d!==this)&&(d.mode3d!==f)){f=d.mode3d;this.options.Lego=d.options.Lego}var c=f?"Draw3D":"Draw2D";this[c](g,e)};a.TH1Painter.prototype.Draw2D=function(c){if(typeof this.Create3DScene==="function"){this.Create3DScene(-1)}this.mode3d=false;this.ScanContent(true);this.CreateXY();if(typeof this.DrawColorPalette==="function"){this.DrawColorPalette(false)}this.DrawAxes();this.DrawGrids();this.DrawBins();this.DrawTitle();this.UpdateStatWebCanvas();this.AddInteractive();a.CallBack(c)};a.TH1Painter.prototype.Draw3D=function(c){this.mode3d=true;a.AssertPrerequisites("more2d;3d",function(){this.Create3DScene=a.Painter.HPainter_Create3DScene;this.PrepareColorDraw=a.TH2Painter.prototype.PrepareColorDraw;this.Draw3D=a.Painter.TH1Painter_Draw3D;this.Draw3D(c)}.bind(this))};a.THistPainter.prototype.Get3DToolTip=function(c){var d={bin:c,name:this.GetObject().fName,title:this.GetObject().fTitle};switch(this.Dimension()){case 1:d.ix=c;d.iy=1;d.value=this.histo.getBinContent(d.ix);d.error=this.histo.getBinError(c);d.lines=this.GetBinTips(c-1);break;case 2:d.ix=c%(this.nbinsx+2);d.iy=(c-d.ix)/(this.nbinsx+2);d.value=this.histo.getBinContent(d.ix,d.iy);d.error=this.histo.getBinError(c);d.lines=this.GetBinTips(d.ix-1,d.iy-1);break;case 3:d.ix=c%(this.nbinsx+2);d.iy=((c-d.ix)/(this.nbinsx+2))%(this.nbinsy+2);d.iz=(c-d.ix-d.iy*(this.nbinsx+2))/(this.nbinsx+2)/(this.nbinsy+2);d.value=this.GetObject().getBinContent(d.ix,d.iy,d.iz);d.error=this.histo.getBinError(c);d.lines=this.GetBinTips(d.ix-1,d.iy-1,d.iz-1);break}return d};a.TH1Painter.prototype.Redraw=function(c){this.CallDrawFunc(null,c)};a.Painter.drawHistogram1D=function(f,d,e){var c=new a.TH1Painter(d);c.SetDivId(f,1);c.options=c.DecodeOptions(e);if(!c.options.Lego){c.CheckPadRange()}c.ScanContent();if(a.gStyle.AutoStat&&(c.create_canvas||d.$snapid)){c.CreateStat(d.$custom_stat)}c.CallDrawFunc(function(){c.DrawNextFunction(0,function(){if(c.options.Lego===0){if(c.options.AutoZoom){c.AutoZoom()}}c.FillToolbar();c.DrawingReady()})});return c};a.Painter.drawText=function(e,d){var c=new a.TObjectPainter(d);c.SetDivId(e,2);c.Redraw=function(){var l=this.GetObject(),k=this.pad_width(),j=this.pad_height(),g=l.fX,o=l.fY,m=a.Painter.root_colors[l.fTextColor],i=true,f=0,n=1;if(l.TestBit(a.BIT(14))){g=g*k;o=(1-o)*j}else{if(this.main_painter()!==null){k=this.frame_width();j=this.frame_height();i=false;g=this.main_painter().grx(g);o=this.main_painter().gry(o)}else{if(this.root_pad()!==null){g=this.ConvertToNDC("x",g)*k;o=(1-this.ConvertToNDC("y",o))*j}else{l.fTextAlign=22;g=k/2;o=j/2;if(l.fTextSize===0){l.fTextSize=0.05}if(l.fTextColor===0){l.fTextColor=1}}}}this.RecreateDrawG(i,i?"text_layer":"upper_layer");if(l._typename=="TLatex"){f=1;n=0.9}else{if(l._typename=="TMathText"){f=2;n=0.8}}this.StartTextDrawing(l.fTextFont,Math.round(l.fTextSize*Math.min(k,j)*n));this.DrawText(l.fTextAlign,Math.round(g),Math.round(o),0,0,l.fTitle,m,f);this.FinishTextDrawing()};c.Redraw();return c.DrawingReady()};a.Painter.drawRawText=function(f,c,e){var d=new a.TBasePainter();d.txt=c;d.SetDivId(f);d.RedrawObject=function(g){this.txt=g;this.Draw();return true};d.Draw=function(){var j=this.txt.value;if(typeof j!="string"){j="<undefined>"}var l=this.txt.mathjax||(a.gStyle.MathJax>1);if(!l&&!("as_is" in this.txt)){var h=j.split("\n");j="";for(var k=0;k<h.length;++k){j+="<pre>"+h[k]+"</pre>"}}var m=this.select_main(),g=m.select("div");if(g.empty()){g=m.append("div").style("max-width","100%").style("max-height","100%").style("overflow","auto")}g.html(j);this.SetDivId(this.divid);if(l){a.AssertPrerequisites("mathjax",function(){MathJax.Hub.Typeset(m.node())})}};d.Draw();return d.DrawingReady()};a.Painter.FolderHierarchy=function(d,f){if((f==null)||!("fFolders" in f)||(f.fFolders==null)){return false}if(f.fFolders.arr.length===0){d._more=false;return true}d._childs=[];for(var c=0;c<f.fFolders.arr.length;++c){var e=f.fFolders.arr[c];d._childs.push({_name:e.fName,_kind:"ROOT."+e._typename,_obj:e})}return true};a.Painter.TaskHierarchy=function(d,f){if((f==null)||!("fTasks" in f)||(f.fTasks==null)){return false}a.Painter.ObjectHierarchy(d,f,{exclude:["fTasks","fName"]});if((f.fTasks.arr.length===0)&&(d._childs.length==0)){d._more=false;return true}for(var c=0;c<f.fTasks.arr.length;++c){var e=f.fTasks.arr[c];d._childs.push({_name:e.fName,_kind:"ROOT."+e._typename,_obj:e})}return true};a.Painter.ListHierarchy=function(d,l){if(!a.IsRootCollection(l)){return false}if((l.arr===undefined)||(l.arr.length===0)){d._more=false;return true}var c=false,g=d;while(g){if(g._do_context){c=true}g=g._parent}var p=(l._typename=="TMap"),n=[],f=[],h=[];for(var k=0;k<l.arr.length;++k){var j=p?l.arr[k].first:l.arr[k];if(!j){continue}var e=j.fName||j.name;if(!e){continue}var m=n.indexOf(e);if(m>=0){f[m]++}else{f[n.length]=h[n.length]=1;n.push(e)}}d._childs=[];for(var k=0;k<l.arr.length;++k){var j=p?l.arr[k].first:l.arr[k];var o;if(!j||!j._typename){o={_name:k.toString(),_kind:"ROOT.NULL",_title:"NULL",_value:"null",_obj:null}}else{o={_name:j.fName||j.name,_kind:"ROOT."+j._typename,_title:(j.fTitle||"")+" type:"+j._typename,_obj:j};switch(j._typename){case"TColor":o._value=a.Painter.MakeColorRGB(j);break;case"TText":o._value=j.fTitle;break;case"TLatex":o._value=j.fTitle;break;case"TObjString":o._value=j.fString;break;default:if(l.opt&&l.opt[k]&&l.opt[k].length){o._value=l.opt[k]}}if(c&&a.canDraw(j._typename)){o._direct_context=true}if(!o._name||(!isNaN(parseInt(o._name))&&(parseInt(o._name)!==k))||(l.arr.indexOf(j)<k)){o._name=k.toString()}else{var m=n.indexOf(j.fName);if((m>=0)&&(f[m]>1)){o._cycle=h[m]++;o._keyname=o._name;o._name=o._keyname+";"+o._cycle}}}d._childs.push(o)}return true};a.Painter.KeysHierarchy=function(j,h,f,k){if(h===undefined){return false}j._childs=[];for(var e=0;e<h.length;++e){var d=h[e];var g={_name:d.fName+";"+d.fCycle,_cycle:d.fCycle,_kind:"ROOT."+d.fClassName,_title:d.fTitle,_keyname:d.fName,_readobj:null,_parent:j};if(d.fObjlen>100000){g._title+=" (size: "+(d.fObjlen/1000000).toFixed(1)+"MB)"}if("fRealName" in d){g._realname=d.fRealName+";"+d.fCycle}if(d.fClassName=="TDirectory"||d.fClassName=="TDirectoryFile"){var c=null;if((k!=null)&&(f!=null)){c=f.GetDir(k+d.fName)}if(c==null){g._more=true;g._expand=function(i,l){return a.Painter.KeysHierarchy(i,l.fKeys)}}else{g._name=d.fName;a.Painter.KeysHierarchy(g,c.fKeys,f,k+d.fName+"/")}}else{if((d.fClassName=="TList")&&(d.fName=="StreamerInfo")){g._name="StreamerInfo";g._kind="ROOT.TStreamerInfoList";g._title="List of streamer infos for binary I/O";g._readobj=f.fStreamerInfos}}j._childs.push(g)}return true};a.Painter.ObjectHierarchy=function(o,m,f){if(!o||(m===null)){return false}o._childs=[];var p=Object.prototype.toString.apply(m);if(p==="[object DataView]"){var z={_parent:o,_name:"size",_value:m.byteLength.toString(),_vclass:"h_value_num"};o._childs.push(z);var j=(m.byteLength<10)?1:a.log10(m.byteLength);for(var r=0;r<m.byteLength;++r){if(r%16===0){z={_parent:o,_name:r.toString(),_value:"",_vclass:"h_value_num"};while(z._name.length<j){z._name="0"+z._name}o._childs.push(z)}var F=m.getUint8(r).toString(16);while(F.length<2){F="0"+F}if(z._value.length>0){z._value+=(r%4===0)?" | ":" "}z._value+=F}return true}var E=true,A=false,s=o;while(s){if(s._do_context){A=true}if("_nosimple" in s){E=s._nosimple;break}s=s._parent}var g=(p.lastIndexOf("Array]")==p.length-6)&&(p.indexOf("[object")==0)&&!isNaN(m.length),v=g&&(m.length>a.gStyle.HierarchyLimit),C=false;if(g&&(o._name==="Object")&&!o._parent){o._name="Array"}if(v){C=true;for(var r=0;r<m.length;++r){var B=typeof m[r];if((B==="number")||(B==="boolean")||(B=="string"&&(m[r].length<16))){continue}C=false;break}}if(!("_obj" in o)){o._obj=m}else{if(o._obj!==m){alert("object missmatch")}}if(!o._title){if(m._typename){o._title="ROOT."+m._typename}else{if(g){o._title="Array len: "+m.length}}}if(C){for(var r=0;r<m.length;){var n=Math.min(r+10,m.length),l=true,x=r;while(l){l=true;for(var y=x;y<n;++y){if(m[r]!==m[y]){l=false}}if(l){if(n===m.length){break}x=n;n=Math.min(n+10,m.length)}else{if(x!==r){n=x;l=true;break}}}var z={_parent:o,_name:r+".."+(n-1),_vclass:"h_value_num"};if(l){z._value=m[r].toString()}else{z._value="";for(var y=r;y<n;++y){z._value+=((y===r)?"[ ":", ")+m[y].toString()}z._value+=" ]"}o._childs.push(z);r=n}return true}var h,e,i,u;for(var D in m){if((D=="_typename")||(D[0]=="$")){continue}var c=m[D];if(typeof c=="function"){continue}if(f&&f.exclude&&(f.exclude.indexOf(D)>=0)){continue}if(v&&h){if(i===c){++u;e=D;continue}if(u>0){h._name+=".."+e}}var z={_parent:o,_name:D};if(v){h=z;e=D;i=c;u=0}if(c===null){z._value=z._title="null";if(!E){o._childs.push(z)}continue}var q=false;if(typeof c=="object"){p=Object.prototype.toString.apply(c);if((p.lastIndexOf("Array]")==p.length-6)&&(p.indexOf("[object")==0)){z._title="array len="+c.length;q=(p!="[object Array]");if(c.length===0){z._value="[ ]";z._more=false}else{z._value="[...]";z._more=true;z._expand=a.Painter.ObjectHierarchy;z._obj=c}}else{if(p==="[object DataView]"){z._title="DataView len="+c.byteLength;z._value="[...]";z._more=true;z._expand=a.Painter.ObjectHierarchy;z._obj=c}else{if(p==="[object Date]"){z._more=false;z._title="Date";z._value=c.toString();z._vclass="h_value_num"}else{if(c.$kind||c._typename){z._kind=z._title="ROOT."+(c.$kind||c._typename)}if(c._typename){z._title=c._typename;if(A&&a.canDraw(c._typename)){z._direct_context=true}}var w=o,t=false;while(w&&!t){t=(w._obj===c);w=w._parent}if(t){z._value="{ prnt }";q=true}else{z._obj=c;z._more=false;switch(c._typename){case"TColor":z._value=a.Painter.MakeColorRGB(c);break;case"TText":z._value=c.fTitle;break;case"TLatex":z._value=c.fTitle;break;case"TObjString":z._value=c.fString;break;default:if(a.IsRootCollection(c)&&(typeof c.arr==="object")){z._value=c.arr.length?"[...]":"[]";z._title+=", size:"+c.arr.length;if(c.arr.length>0){z._more=true}}else{z._more=true;z._value="{ }"}}}}}}}else{if((typeof c==="number")||(typeof c==="boolean")){q=true;if(D=="fBits"){z._value="0x"+c.toString(16)}else{z._value=c.toString()}z._vclass="h_value_num"}else{if(typeof c==="string"){q=true;z._value="&quot;"+c.replace(/\&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"&quot;";z._vclass="h_value_str"}else{if(typeof c==="undefined"){q=true;z._value="undefined";z._vclass="h_value_num"}else{q=true;alert("miss "+D+"  "+typeof c)}}}}if(!q||!E){o._childs.push(z)}}if(v&&h&&(u>0)){h._name+=".."+e}return true};a.hpainter=null;a.HierarchyPainter=function(c,d,e){a.TBasePainter.call(this);this.name=c;this.h=null;this.with_icons=true;this.background=e;this.files_monitoring=(d==null);this.nobrowser=(d===null);if(!this.nobrowser){this.SetDivId(d)}if(!a.hpainter){a.hpainter=this}};a.HierarchyPainter.prototype=Object.create(a.TBasePainter.prototype);a.HierarchyPainter.prototype.Cleanup=function(){this.clear(true);a.TBasePainter.prototype.Cleanup.call(this);if(a.hpainter===this){a.hpainter=null}};a.HierarchyPainter.prototype.FileHierarchy=function(d){var c=this;var e={_name:d.fFileName,_title:(d.fTitle?(d.fTitle+", path "):"")+d.fFullURL,_kind:"ROOT.TFile",_file:d,_fullurl:d.fFullURL,_localfile:d.fLocalFile,_had_direct_read:false,_get:function(g,j,i){var f=this;if(g&&g._readobj){return a.CallBack(i,g,g._readobj)}if(g!=null){j=c.itemFullName(g,f)}function h(k){if(f._file==null){f._file=k}if(k==null){return a.CallBack(i,g,null)}k.ReadObject(j,function(n){if((g==null)&&(n!=null)){var o=c.Find({name:j,top:f,last_exists:true,check_keys:true});if((o!=null)&&("last" in o)&&(o.last!=f)){var l=k.GetDir(c.itemFullName(o.last,f));if(l){o.last._name=o.last._keyname;var m=c.itemFullName(o.last,f);a.Painter.KeysHierarchy(o.last,l.fKeys,k,m+"/")}}else{a.Painter.KeysHierarchy(f,k.fKeys,k,"")}g=c.Find({name:j,top:f})}if(g!=null){g._readobj=n;if("_expand" in g){g._name=g._keyname}}a.CallBack(i,g,n)})}if(f._file){h(f._file)}else{if(f._localfile){new a.TLocalFile(f._localfile,h)}else{if(f._fullurl){new a.TFile(f._fullurl,h)}}}}};a.Painter.KeysHierarchy(e,d.fKeys,d,"");return e};a.HierarchyPainter.prototype.ForEach=function(e,d){if(d==null){d=this.h}if((d==null)||(typeof e!="function")){return}function c(f){e(f);if("_childs" in f){for(var g=0;g<f._childs.length;++g){f._childs[g]._parent=f;c(f._childs[g])}}}c(d)};a.HierarchyPainter.prototype.Find=function(c){function d(m,q){if(!q||(q.length==0)||!m){return m}var l=q.length;if(!m._parent&&(m._kind!=="TopFolder")&&(q.indexOf(m._name)===0)){if(q===m._name){return m}var k=m._name.length;if(q[k]=="/"){q=q.substr(k+1);l=q.length}}function n(s,i){if(!i){s._parent=m}if((l>=q.length-1)||(l<0)){return s}return d(s,q.substr(l+1))}while(l>0){var p=(l>=q.length)?q:q.substr(0,l);if(m._childs){for(var h=0;h<m._childs.length;++h){if(m._childs[h]._name==p){return n(m._childs[h])}}if((m._kind==="TopFolder")&&(m._childs[0]._online!==undefined)){for(var h=0;h<m._childs[0]._childs.length;++h){if(m._childs[0]._childs[h]._name==p){return n(m._childs[0]._childs[h],true)}}}if(c.check_keys){var o=null;for(var h=0;h<m._childs.length;++h){if(m._childs[h]._keyname===p){if(!o||(o._cycle<m._childs[h]._cycle)){o=m._childs[h]}}}if(o){return n(o)}}var r=c.allow_index;if((p[0]==="[")&&(p[p.length-1]==="]")&&!isNaN(parseInt(p.substr(1,p.length-2)))){r=true;p=p.substr(1,p.length-2)}if(r){var j=parseInt(p);if(!isNaN(j)&&(j>=0)&&(j<m._childs.length)){return n(m._childs[j])}}}l=q.lastIndexOf("/",l-1)}if(c.force){if(m._childs===undefined){m._childs=[]}l=q.indexOf("/");var g={_name:((l<0)?q:q.substr(0,l))};m._childs.push(g);return n(g)}return(c.last_exists&&m)?{last:m,rest:q}:null}var e=this.h,f="";if(c===null){return null}else{if(typeof c=="string"){f=c;c={}}else{if(typeof c=="object"){f=c.name;if("top" in c){e=c.top}}else{return null}}}if(f==="__top_folder__"){return e}return d(e,f)};a.HierarchyPainter.prototype.itemFullName=function(e,f,d){if(e&&e._kind==="TopFolder"){return"__top_folder__"}var c="";while(e){if((e._online!==undefined)&&!f){return c}if((e===f)||(e._kind==="TopFolder")){break}if(d&&!e._parent){break}if(c.length>0){c="/"+c}c=e._name+c;e=e._parent}return c};a.HierarchyPainter.prototype.ExecuteCommand=function(g,j){var k=this.Find(g);var c=this.GetOnlineItemUrl(k)+"/cmd.json";var d=this;var f=b.select((typeof j=="function")?undefined:j);if("_numargs" in k){for(var e=0;e<k._numargs;++e){var h="arg"+(e+1);var i=null;if(e+2<arguments.length){i=arguments[e+2]}if((i==null)&&(typeof j=="object")){i=prompt("Input argument "+h+" for command "+k._name,"")}if(i==null){return}c+=((e==0)?"?":"&")+h+"="+i}}if(!f.empty()){f.style("background","yellow");if(k&&k._title){f.attr("title","Executing "+k._title)}}a.NewHttpRequest(c,"text",function(m){if(typeof j=="function"){return j(m)}if(f.empty()){return}var l=((m!=null)&&(m!="false"))?"green":"red";if(k&&k._title){f.attr("title",k._title+" lastres="+m)}f.style("background",l);setTimeout(function(){f.style("background","")},2000);if((l=="green")&&("_hreload" in k)){d.reload()}if((l=="green")&&("_update_item" in k)){d.updateItems(k._update_item.split(";"))}}).send()};a.HierarchyPainter.prototype.RefreshHtml=function(d){if(!this.divid){return a.CallBack(d)}var c=this;a.AssertPrerequisites("jq2d",function(){c.RefreshHtml(d)})};a.HierarchyPainter.prototype.get=function(i,e,l){if(i===null){return a.CallBack(e,null,null)}var f,h,c=this;if(typeof i==="string"){f=i}else{if(typeof i==="object"){if((i._parent!==undefined)&&(i._name!==undefined)&&(i._kind!==undefined)){h=i}else{if(i.name!==undefined){f=i.name}else{if(i.arg!==undefined){f=i.arg}else{if(i.item!==undefined){h=i.item}}}}}}if(h){f=this.itemFullName(h)}else{h=this.Find({name:f,allow_index:true,check_keys:true})}var g=(h!=null)?null:this.Find({name:f,last_exists:true,check_keys:true,allow_index:true});if((g!==null)&&("last" in g)&&(g.last!==null)){var j=this.itemFullName(g.last);if((typeof i=="object")&&("rest" in i)){if((i.rest==g.rest)||(i.rest.length<=g.rest.length)){return a.CallBack(e)}}return this.expand(j,function(m){if(!m){a.CallBack(e)}var d=c.itemFullName(g.last);if(d.length>0){d+="/"}c.get({name:d+g.rest,rest:g.rest},e,l)},null,true)}if((h!==null)&&(typeof h._obj=="object")){return a.CallBack(e,h,h._obj)}var k=h;while(k!=null){if(("_get" in k)&&(typeof k._get=="function")){return k._get(h,null,e,l)}k=("_parent" in k)?k._parent:null}a.CallBack(e,h,null)};a.HierarchyPainter.prototype.draw=function(e,d,c){return a.draw(e,d,c)};a.HierarchyPainter.prototype.redraw=function(e,d,c){return a.redraw(e,d,c)};a.HierarchyPainter.prototype.player=function(h,d,g){var e=this.Find(h);if(!e||!("_player" in e)){return a.CallBack(g,null)}var f=this;var c=("_prereq" in e)?e._prereq:"";a.AssertPrerequisites(c,function(){var i=a.findFunction(e._player);if(i==null){return a.CallBack(g,null)}f.CreateDisplay(function(k){var j=null;if(k){j=i(f,h,d)}a.CallBack(g,j)})})};a.HierarchyPainter.prototype.canDisplay=function(d,c){if(!d){return false}if("_player" in d){return true}if(d._can_draw===true){return true}if(c=="inspect"){return true}var e=a.getDrawHandle(d._kind,c);return e&&(("func" in e)||("draw_field" in e))};a.HierarchyPainter.prototype.isItemDisplayed=function(d){var c=this.GetDisplay();if(!c){return false}return c.FindFrame(d)!==null};a.HierarchyPainter.prototype.display=function(j,l,d){var f=this,m=null,k=false,o=null,g=j,i=j,e="::_display_on_frame_::",c=l?l.indexOf(e):-1;if(c>=0){i=l.substr(c+e.length);l=l.substr(0,c)}function n(h){if(!k){a.progress()}if(h&&(typeof h==="object")&&(typeof h.SetItemName==="function")){h.SetItemName(g,k?null:l,f);if(o&&!o._painter){o._painter=h}}a.CallBack(d,h||m,g)}f.CreateDisplay(function(q){if(!q){return n()}o=f.Find(g);if(o&&("_player" in o)){return f.player(g,l,n)}k=(typeof(l)=="string")&&(l.indexOf("update:")==0);if(k){l=l.substr(7);if(!o||o._doing_update){return n()}o._doing_update=true}if(o&&!f.canDisplay(o,l)){return n()}var p="";if((typeof(l)=="string")&&(l.indexOf("divid:")>=0)){var h=l.indexOf("divid:");p=l.slice(h+6);l=l.slice(0,h)}if(!k){a.progress("Loading "+g)}f.get(g,function(r,s){if(!k){a.progress()}if(!o){o=r}if(k&&o){delete o._doing_update}if(!s){return n()}if(!k){a.progress("Drawing "+g)}if(p.length>0){return(k?a.redraw:a.draw)(p,s,l,n)}q.ForEachPainter(function(v,w){if(v.GetItemName()!=g){return}if(!k&&(l!=null)&&(v.GetItemDrawOpt()!=l)){return}q.ActivateFrame(w);var u=null;if(s._typename){u=a.getDrawHandle("ROOT."+s._typename)}if(u&&u.draw_field&&s[u.draw_field]){s=s[u.draw_field]}if(v.RedrawObject(s)){m=v}});if(m){return n()}if(k){a.console("something went wrong - did not found painter when doing update of "+g);return n()}var t=q.FindFrame(i,true);b.select(t).html("");q.ActivateFrame(t);a.draw(b.select(t).attr("id"),s,l,n);if(a.gStyle.DragAndDrop){f.enable_dropping(t,g)}},l)})};a.HierarchyPainter.prototype.enable_dragging=function(c,d){};a.HierarchyPainter.prototype.enable_dropping=function(c,d){};a.HierarchyPainter.prototype.dropitem=function(i,g,c,e){var d=this;if(c&&typeof c==="function"){e=c;c=""}if(c===undefined){c=""}function f(h){if(h&&(typeof h==="object")){h.SetItemName(i,null,d)}a.CallBack(e)}d.get(i,function(h,k){if(!k){return a.CallBack(e)}var j=new a.TObjectPainter();j.SetDivId(g,-1);var l=j.main_painter(true);if(l&&(typeof l.PerformDrop==="function")){return l.PerformDrop(k,i,h,c,f)}if(l&&l.accept_drops){return a.draw(g,k,"same "+c,f)}d.CleanupFrame(g);return a.draw(g,k,c,f)});return true};a.HierarchyPainter.prototype.updateItems=function(c){if((this.disp==null)||(c==null)){return}var d=[],e=[];this.disp.ForEachPainter(function(f){var g=f.GetItemName();if((g==null)||(d.indexOf(g)>=0)){return}if(typeof c=="array"){if(c.indexOf(g)<0){return}}else{if(c!=g){return}}d.push(g);e.push("update:"+f.GetItemDrawOpt())},true);if(d.length>0){this.displayAll(d,e)}};a.HierarchyPainter.prototype.updateAll=function(e,f){if(this.disp==null){return}if(e==="monitoring"){e=!this._monitoring_on}var h=[],d=[],g=this;this.disp.ForEachPainter(function(m){var n=m.GetItemName(),i=m.GetItemDrawOpt();if((n==null)||(h.indexOf(n)>=0)){return}var k=g.Find(n),j=false;if(!k||("_not_monitor" in k)||("_player" in k)){return}if("_always_monitor" in k){j=true}else{var l=a.getDrawHandle(k._kind);if(l&&("monitor" in l)){if((l.monitor===false)||(l.monitor=="never")){return}if(l.monitor==="always"){j=true}}}if(j||!e){h.push(n);d.push("update:"+i)}},true);var c=this;if(this.files_monitoring&&!e){this.ForEachRootFile(function(i){c.ForEach(function(j){delete j._readobj},i);delete i._file})}if(h.length>0){this.displayAll(h,d)}};a.HierarchyPainter.prototype.displayAll=function(p,e,q){if((p==null)||(p.length==0)){return a.CallBack(q)}var w=this;if(!e){e=[]}while(e.length<p.length){e.push("")}if((e.length==1)&&(e[0]=="iotest")){w.clear();b.select("#"+w.disp_frameid).html("<h2>Start I/O test</h2>");var g=new Date();return w.get(p[0],function(i,j){var h=new Date();b.select("#"+w.disp_frameid).append("h2").html("Item "+p[0]+" reading time = "+(h.getTime()-g.getTime())+"ms");return a.CallBack(q)})}var f=new Array(p.length),y=new Array(p.length);for(var v=0;v<p.length;++v){f[v]=y[v]=null;var z=p[v],s=true;if(z&&(z.length>1)&&(z[0]=="'")&&(z[z.length-1]=="'")){p[v]=z.substr(1,z.length-2);s=false}var x=w.Find({name:p[v],check_keys:true});if(x){p[v]=w.itemFullName(x);continue}if(s&&(p[v][0]=="[")&&(p[v][p[v].length-1]=="]")){f[v]=a.ParseAsArray(p[v]);p[v]=f[v].shift()}else{if(s&&(p[v].indexOf("+")>0)){f[v]=p[v].split("+");p[v]=f[v].shift()}}if(f[v]&&f[v].length>0){for(var u=0;u<f[v].length;++u){var l=f[v][u].indexOf("_same_");if((l>0)&&(w.Find(f[v][u])==null)){f[v][u]=f[v][u].substr(0,l)+p[v].substr(l)}x=w.Find({name:f[v][u],check_keys:true});if(x){f[v][u]=w.itemFullName(x)}}if((e[v][0]=="[")&&(e[v][e[v].length-1]=="]")){y[v]=a.ParseAsArray(e[v]);e[v]=y[v].shift()}else{if(e[v].indexOf("+")>0){y[v]=e[v].split("+");e[v]=y[v].shift()}else{y[v]=[]}}while(y[v].length<f[v].length){y[v].push("")}}var l=p[v].indexOf("_same_");if((l>0)&&!w.Find(p[v])&&(v>0)){p[v]=p[v].substr(0,l)+p[0].substr(l)}x=w.Find({name:p[v],check_keys:true});if(x){p[v]=w.itemFullName(x)}}for(var r=p.length-1;r>=0;--r){var c=w.Find(p[r]);if(!c||w.canDisplay(c,e[r])){continue}w.expand(p[r],null,null,true);p.splice(r,1);e.splice(r,1);f.splice(r,1)}if(p.length==0){return a.CallBack(q)}var m=new Array(p.length),d=new Array(p.length);for(var r=0;r<p.length;++r){d[r]=0;var A=p[r],t=0;if(p.indexOf(A)<r){d[r]=true}while(m.indexOf(A)>=0){A=p[r]+"_"+t++}m[r]=A}for(var r=0;r<p.length;++r){if(d[r]!==0){continue}var o=r;for(var t=0;t<p.length;++t){if((p[r]===p[t])&&(e[t].indexOf("main")>=0)){o=t}}for(var t=0;t<p.length;++t){if(p[r]===p[t]){d[t]=(o!=t)}}}w.CreateDisplay(function(k){if(!k){return a.CallBack(q)}for(var j=0;j<p.length;++j){if(e[j].indexOf("update:")!==0){k.CreateFrame(m[j]);e[j]+="::_display_on_frame_::"+m[j]}}function h(C,i){if(i&&f[C]&&(f[C].length>0)){return w.dropitem(f[C].shift(),i.divid,y[C].shift(),h.bind(w,C,i))}f[C]=null;p[C]=null;var B=false;for(var n=0;n<p.length;++n){if(f[n]){B=true}if(p[n]===null){continue}B=true;if(d[n]&&p.indexOf(p[n])===n){d[n]=false;w.display(p[n],e[n],h.bind(w,n))}}if(!B&&q){a.CallBack(q);q=null}}for(var j=0;j<p.length;++j){if(!d[j]){w.display(p[j],e[j],h.bind(w,j))}}})};a.HierarchyPainter.prototype.reload=function(){var c=this;if("_online" in this.h){this.OpenOnline(this.h._online,function(){c.RefreshHtml()})}};a.HierarchyPainter.prototype.UpdateTreeNode=function(){};a.HierarchyPainter.prototype.actiavte=function(d,f){if(typeof d=="string"){d=[d]}var h=[],c=this,i=[];this.ForEach(function(j){if(j._background){h.push(j);delete j._background}});function e(){if(typeof c.UpdateBackground!=="function"){return}for(var j=i.length-1;j>=0;--j){c.UpdateTreeNode(i[j])}for(var j=0;j<h.length;++j){c.UpdateBackground(h[j],f)}}function g(n,j){if(n===undefined){if(d.length==0){return e()}n=d.shift()}var k=c.Find(n);if(!k){var m=c.Find({name:n,last_exists:true,check_keys:true,allow_index:true});if(!m||!m.last){return g()}m.now_found=c.itemFullName(m.last);if(f){if((j!==undefined)&&(m.now_found===j)){return g()}return c.expand(m.now_found,function(p){if(!p){return g()}var o=c.itemFullName(m.last);if(o.length>0){o+="/"}g(o+m.rest,m.now_found)})}k=m.last}if(k){var l=k._parent;while(l){if(!l._isopen){if(f){l._isopen=true;if(i.indexOf(l)<0){i.push(l)}}else{k=l;break}}l=l._parent}k._background="grey";if(h.indexOf(k)<0){h.push(k)}}g()}if(f){if(!this.browser_kind){return this.CreateBrowser("float",true,g)}if(!this.browser_visible){this.ToggleBrowserVisisbility()}}g()};a.HierarchyPainter.prototype.expand=function(i,f,h,c){var e=this,d=this.Find(i);if(!d&&h){return a.CallBack(f)}function g(k,m,j){if(!j){j=e.itemFullName(k)}var l=k._expand?null:a.getDrawHandle(k._kind,"::expand");if(m&&l&&l.expand_item){m=m[l.expand_item];if(m&&m._typename){l=a.getDrawHandle("ROOT."+m._typename,"::expand")}}if(l&&l.expand){a.AssertPrerequisites(l.prereq,function(){k._expand=a.findFunction(l.expand);if(k._expand){return g(k,m,j)}a.CallBack(f)});return true}if(m&&k&&(typeof k._expand==="function")){if(k._expand(k,m)){k._isopen=true;if(k._parent&&!k._parent._isopen){k._parent._isopen=true;if(!c){e.UpdateTreeNode(k._parent)}}else{if(!c){e.UpdateTreeNode(k,h)}}a.CallBack(f,k);return true}}if(m&&a.Painter.ObjectHierarchy(k,m)){k._isopen=true;if(k._parent&&!k._parent._isopen){k._parent._isopen=true;if(!c){e.UpdateTreeNode(k._parent)}}else{if(!c){e.UpdateTreeNode(k,h)}}a.CallBack(f,k);return true}return false}if(d){if((d._more===false)||(!d._parent&&d._childs)){return a.CallBack(f)}if(d._childs&&d._isopen){d._isopen=false;if(!c){e.UpdateTreeNode(d,h)}return a.CallBack(f)}if(d._obj&&g(d,d._obj,i)){return}}a.progress("Loading "+i);this.get(i,function(j,k){a.progress();if(k&&g(j,k)){return}a.CallBack(f)},"hierarchy_expand")};a.HierarchyPainter.prototype.GetTopOnlineItem=function(c){if(c!=null){while((c!=null)&&(!("_online" in c))){c=c._parent}return c}if(this.h==null){return null}if("_online" in this.h){return this.h}if((this.h._childs!=null)&&("_online" in this.h._childs[0])){return this.h._childs[0]}return null};a.HierarchyPainter.prototype.ForEachJsonFile=function(d){if(this.h==null){return}if("_jsonfile" in this.h){return a.CallBack(d,this.h)}if(this.h._childs!=null){for(var e=0;e<this.h._childs.length;++e){var c=this.h._childs[e];if("_jsonfile" in c){a.CallBack(d,c)}}}};a.HierarchyPainter.prototype.OpenJsonFile=function(f,e){var d=false;this.ForEachJsonFile(function(g){if(g._jsonfile==f){d=true}});if(d){return a.CallBack(e)}var c=this;a.NewHttpRequest(f,"object",function(i){if(!i){return a.CallBack(e)}var h={_jsonfile:f,_kind:"ROOT."+i._typename,_jsontmp:i,_name:f.split("/").pop()};if(i.fTitle){h._title=i.fTitle}h._get=function(k,m,l){if(k._jsontmp){return a.CallBack(l,k,k._jsontmp)}a.NewHttpRequest(k._jsonfile,"object",function(n){k._jsontmp=n;a.CallBack(l,k,k._jsontmp)}).send()};if(c.h==null){c.h=h}else{if(c.h._kind=="TopFolder"){c.h._childs.push(h)}else{var j=c.h,g=("_jsonfile" in j)?"Files":"Items";c.h={_name:g,_kind:"TopFolder",_childs:[j,h]}}}c.RefreshHtml(e)}).send(null)};a.HierarchyPainter.prototype.ForEachRootFile=function(d){if(this.h==null){return}if((this.h._kind=="ROOT.TFile")&&(this.h._file!=null)){return a.CallBack(d,this.h)}if(this.h._childs!=null){for(var e=0;e<this.h._childs.length;++e){var c=this.h._childs[e];if((c._kind=="ROOT.TFile")&&("_fullurl" in c)){a.CallBack(d,c)}}}};a.HierarchyPainter.prototype.OpenRootFile=function(f,e){var d=false;this.ForEachRootFile(function(g){if(g._fullurl===f){d=true}});if(d){return a.CallBack(e)}var c=this;a.progress("Opening "+f+" ...");a.OpenFile(f,function(i){a.progress();if(!i){if(!b.select("#gui_fileCORS").style("background","red").empty()){setTimeout(function(){b.select("#gui_fileCORS").style("background","")},5000)}return a.CallBack(e,false)}var h=c.FileHierarchy(i);h._isopen=true;if(c.h==null){c.h=h;if(c._topname){h._name=c._topname}}else{if(c.h._kind=="TopFolder"){c.h._childs.push(h)}else{var j=c.h,g=(j._kind=="ROOT.TFile")?"Files":"Items";c.h={_name:g,_kind:"TopFolder",_childs:[j,h],_isopen:true}}}c.RefreshHtml(e)})};a.HierarchyPainter.prototype.ApplyStyle=function(c,f){if(!c){return a.CallBack(f)}if(typeof c==="object"){if(c._typename==="TStyle"){a.extend(a.gStyle,c)}return a.CallBack(f)}if(typeof c==="string"){var e=this,d=this.Find({name:c,allow_index:true,check_keys:true});if(d!==null){return this.get(d,function(g,h){e.ApplyStyle(h,f)})}if(c.indexOf(".json")>0){return a.NewHttpRequest(c,"object",function(g){e.ApplyStyle(g,f)}).send(null)}}return a.CallBack(f)};a.HierarchyPainter.prototype.GetFileProp=function(e){var c=this.Find(e);if(c==null){return null}var d=c._name;while(c._parent){c=c._parent;if("_file" in c){return{kind:"file",fileurl:c._file.fURL,itemname:d,localfile:!!c._file.fLocalFile}}if("_jsonfile" in c){return{kind:"json",fileurl:c._jsonfile,itemname:d}}d=c._name+"/"+d}return null};a.MarkAsStreamerInfo=function(c,d,e){if(e&&(e._typename=="TList")){e._typename="TStreamerInfoList"}};a.HierarchyPainter.prototype.GetOnlineItemUrl=function(d){if(typeof d=="string"){d=this.Find(d)}var c=d;while(c&&(c._online===undefined)){c=c._parent}return c?(c._online+this.itemFullName(d,c)):null};a.HierarchyPainter.prototype.isOnlineItem=function(c){return this.GetOnlineItemUrl(c)!==null};a.HierarchyPainter.prototype.GetOnlineItem=function(o,k,m,i){var d=k,g=false,l="",p="object",c=this,f=null;if(i==="hierarchy_expand"){g=true;i=undefined}if(o!=null){d=this.GetOnlineItemUrl(o);var e=null;if("_kind" in o){f=a.getDrawHandle(o._kind)}if(g){l="h.json?compact=3";o._expand=a.Painter.OnlineHierarchy}else{if("_make_request" in o){e=a.findFunction(o._make_request)}else{if((f!=null)&&("make_request" in f)){e=f.make_request}}}if(typeof e=="function"){var j=e(c,o,d,i);if(j!=null){if(typeof j=="string"){l=j}else{if("req" in j){l=j.req}if("kind" in j){p=j.kind}}}}if((l.length==0)&&(o._kind.indexOf("ROOT.")!=0)){l="item.json.gz?compact=3"}}if((k==null)&&(o!=null)&&("_cached_draw_object" in this)&&(l.length==0)){var h=this._cached_draw_object;delete this._cached_draw_object;return a.CallBack(m,o,h)}if(l.length==0){l="root.json.gz?compact=23"}if(d.length>0){d+="/"}d+=l;var n=a.NewHttpRequest(d,p,function(s){var r=null;if(!g&&(o!=null)&&("_after_request" in o)){r=a.findFunction(o._after_request)}else{if((f!=null)&&("after_request" in f)){r=f.after_request}}if(typeof r=="function"){var q=r(c,o,s,i,n);if((q!=null)&&(typeof q=="object")){s=q}}a.CallBack(m,o,s)});n.send(null)};a.Painter.OnlineHierarchy=function(c,d){if((d!=null)&&(c!=null)&&("_childs" in d)){for(var e=0;e<d._childs.length;++e){if(d._childs[e]._more||d._childs[e]._childs){d._childs[e]._expand=a.Painter.OnlineHierarchy}}c._childs=d._childs;d._childs=null;return true}return false};a.HierarchyPainter.prototype.OpenOnline=function(e,f){var c=this;function g(i){c.h=i;if(c.h==null){return}if(("_title" in c.h)&&(c.h._title!="")){document.title=c.h._title}i._isopen=true;c.h._online=e;c.h._get=function(l,n,m,k){c.GetOnlineItem(l,n,m,k)};c.h._expand=a.Painter.OnlineHierarchy;var h="",j="";c.ForEach(function(l){if("_childs" in l){l._expand=a.Painter.OnlineHierarchy}if("_autoload" in l){var k=l._autoload.split(";");for(var m=0;m<k.length;++m){if((k[m].length>3)&&((k[m].lastIndexOf(".js")==k[m].length-3)||(k[m].lastIndexOf(".css")==k[m].length-4))){if(h.indexOf(k[m])<0){h+=k[m]+";"}}else{if(j.indexOf(k[m])<0){j+=k[m]+";"}}}}});if(h.length>0){h="user:"+h}a.AssertPrerequisites(j+h,function(){c.ForEach(function(m){if(!("_drawfunc" in m)||!("_kind" in m)){return}var l="kind:"+m._kind;if(m._kind.indexOf("ROOT.")==0){l=m._kind.slice(5)}var k=m._drawopt;if(!a.canDraw(l)||(k!=null)){a.addDrawFunc({name:l,func:m._drawfunc,script:m._drawscript,opt:k})}});a.CallBack(f,c)})}if(!e){e=""}if(typeof e=="object"){var d=e;e="";return g(d)}a.NewHttpRequest(e+"h.json?compact=3","object",g).send(null)};a.HierarchyPainter.prototype.GetOnlineProp=function(e){var c=this.Find(e);if(!c){return null}var d=c._name;while(c._parent!=null){c=c._parent;if("_online" in c){return{server:c._online,itemname:d}}d=c._name+"/"+d}return null};a.HierarchyPainter.prototype.FillOnlineMenu=function(c,k,i){var l=this,d=this.Find(i),g=a.getDrawSettings(d._kind,"nosame;noinspect"),f=a.getDrawHandle(d._kind),h=("_kind" in d)?d._kind.indexOf("ROOT.")==0:false;if(g.opts){g.opts.push("inspect");c.addDrawMenu("Draw",g.opts,function(m){l.display(i,m)})}if(!d._childs&&(d._more||h||g.expand)){c.add("Expand",function(){l.expand(i)})}if(f&&("execute" in f)){c.add("Execute",function(){l.ExecuteCommand(i,c.tree_node)})}var j=k.server+k.itemname+"/draw.htm";var e="?";if(this.IsMonitoring()){j+=e+"monitoring="+this.MonitoringInterval();e="&"}if(g.opts){c.addDrawMenu("Draw in new window",g.opts,function(m){window.open(j+e+"opt="+m)})}if(g.opts&&(g.opts.length>0)&&h){c.addDrawMenu("Draw as png",g.opts,function(m){window.open(k.server+k.itemname+"/root.png?w=400&h=300&opt="+m)})}if("_player" in d){c.add("Player",function(){l.player(i)})}};a.HierarchyPainter.prototype.Adopt=function(c){this.h=c;this.RefreshHtml()};a.HierarchyPainter.prototype.SetMonitoring=function(d,c){if(d!==undefined){this._monitoring_on=false;this._monitoring_interval=3000;d=!d?0:parseInt(d);if(!isNaN(d)&&(d>0)){this._monitoring_on=true;this._monitoring_interval=Math.max(100,d)}}if(c!==undefined){this._monitoring_on=c}if(this._monitoring_handle){clearInterval(this._monitoring_handle)}this._monitoring_handle=setInterval(this.updateAll.bind(this,"monitoring"),this._monitoring_interval)};a.HierarchyPainter.prototype.MonitoringInterval=function(c){return("_monitoring_interval" in this)?this._monitoring_interval:3000};a.HierarchyPainter.prototype.EnableMonitoring=function(c){this._monitoring_on=c};a.HierarchyPainter.prototype.IsMonitoring=function(){return this._monitoring_on};a.HierarchyPainter.prototype.SetDisplay=function(d,c){if((c==null)&&(typeof d=="object")){this.disp=d;this.disp_kind="custom";this.disp_frameid=null}else{this.disp_kind=d;this.disp_frameid=c}if(!this.register_resize){this.register_resize=true;a.RegisterForResize(this)}};a.HierarchyPainter.prototype.GetLayout=function(){return this.disp_kind};a.HierarchyPainter.prototype.ClearPainter=function(c){this.ForEach(function(d){if(d._painter===c){delete d._painter}})};a.HierarchyPainter.prototype.clear=function(c){if(this.disp){this.disp.Reset();delete this.disp}var d=[];this.ForEach(function(e){delete e._painter;if(!c&&(typeof e.clear=="function")){e.clear()}if(c){d.push(e)}});if(c){if(this._monitoring_handle){clearInterval(this._monitoring_handle);delete this._monitoring_handle}this.select_main().html("");d.forEach(function(e){delete e._parent;delete e._childs;delete e._obj;delete e._d3cont});delete this.h}};a.HierarchyPainter.prototype.GetDisplay=function(){return("disp" in this)?this.disp:null};a.HierarchyPainter.prototype.CleanupFrame=function(d){var c=a.cleanup(d);if(c&&(c.length>0)){this.ForEach(function(e){if(e._painter&&c.indexOf(e._painter)>=0){delete e._painter}})}};a.HierarchyPainter.prototype.CreateDisplay=function(c){if("disp" in this){if((this.disp.NumDraw()>0)||(this.disp_kind=="custom")){return a.CallBack(c,this.disp)}this.disp.Reset();delete this.disp}if(document.getElementById(this.disp_frameid)==null){return a.CallBack(c,null)}if((this.disp_kind=="simple")||(this.disp_kind.indexOf("grid")==0)&&(this.disp_kind.indexOf("gridi")<0)){this.disp=new a.GridDisplay(this.disp_frameid,this.disp_kind)}else{return a.AssertPrerequisites("jq2d",this.CreateDisplay.bind(this,c))}if(this.disp){this.disp.CleanupFrame=this.CleanupFrame.bind(this)}a.CallBack(c,this.disp)};a.HierarchyPainter.prototype.updateOnOtherFrames=function(c,f){var g=this.disp,e=null,d=false;if(!g){return false}if(f._typename){e=a.getDrawHandle("ROOT."+f._typename)}if(e&&e.draw_field&&f[e.draw_field]){f=f[e.draw_field]}g.ForEachPainter(function(h,i){if((h===c)||(h.GetItemName()!=c.GetItemName())){return}g.ActivateFrame(i);if(h.RedrawObject(f)){d=true}});return d};a.HierarchyPainter.prototype.CheckResize=function(c){if(this.disp){this.disp.CheckMDIResize(null,c)}};a.HierarchyPainter.prototype.StartGUI=function(t,c,j){function p(C){var i=a.GetUrlOption(C,j);if((i===null)&&t&&!t.empty()&&t.node().hasAttribute(C)){i=t.attr(C)}return i}function n(D){var C=a.GetUrlOptionAsArray(D,j);if(C.length>0||!t||t.empty()){return C}while(D.length>0){var F=D.indexOf(";");var i=F>0?D.substr(0,F):D;if(F>0){D=D.substr(F+1)}else{D=""}var E=true;if(i[0]=="#"){i=i.substr(1);E=false}if(i==="files"){continue}if(!t.node().hasAttribute(i)){continue}var G=t.attr(i);if(E){C=C.concat(a.ParseAsArray(G))}else{if(G!==null){C.push(G)}}}return C}var k=this,f=p("prereq")||"",o=a.GetUrlOption("path",j)||"",A=n("#file;files"),y=p("localfile"),g=n("#json;jsons"),q=n("expand"),u=n("#item;items"),r=n("#opt;opts"),e=p("monitoring"),z=p("layout"),x=n("#style"),s=p("status"),h=p("browser"),B=p("title");if(p("float")!==null){h="float"}else{if(p("fix")!==null){h="fix"}}this.no_select=p("noselect");if(p("files_monitoring")!==null){this.files_monitoring=true}if(B){document.title=B}var m=p("load");if(m){f+=";io;2d;load:"+m}if(q.length==0&&(p("expand")==="")){q.push("")}if(o){for(var w=0;w<A.length;++w){A[w]=o+A[w]}for(var w=0;w<g.length;++w){g[w]=o+g[w]}}if((u.length==0)&&p("item")===""){u.push("")}if((g.length==1)&&(u.length==0)&&(q.length==0)){u.push("")}if(!this.disp_kind){if((typeof z=="string")&&(z.length>0)){this.disp_kind=z}else{switch(u.length){case 0:case 1:this.disp_kind="simple";break;case 2:this.disp_kind="vert2";break;case 3:this.disp_kind="vert21";break;case 4:this.disp_kind="vert22";break;case 5:this.disp_kind="vert32";break;case 6:this.disp_kind="vert222";break;case 7:this.disp_kind="vert322";break;case 8:this.disp_kind="vert332";break;case 9:this.disp_kind="vert333";break;default:this.disp_kind="flex"}}}if(s==="no"){s=null}else{if(s==="off"){this.status_disabled=true;s=null}else{if((s!==null)&&(s!=="on")){s=parseInt(s);if(isNaN(s)||(s<5)){s="on"}}}}if(this.no_select===""){this.no_select=true}if(!h){h="fix"}else{if(h==="no"){h=""}else{if(h==="off"){h="";s=null;this.exclude_browser=true}}}if(p("nofloat")!==null){this.float_browser_disabled=true}if(this.start_without_browser){h=""}if(s||h){prereg="jq2d;"+f}this._topname=p("topname");if(t){this.PrepareGuiDiv(t,this.disp_kind)}function d(i){if(h){k.CreateBrowser(h);h=""}if(s){k.CreateStatusLine(s,"toggle");s=null}if(g.length>0){k.OpenJsonFile(g.shift(),d)}else{if(A.length>0){k.OpenRootFile(A.shift(),d)}else{if((y!==null)&&(typeof k.SelectLocalFile=="function")){y=null;k.SelectLocalFile(d)}else{if(q.length>0){k.expand(q.shift(),d)}else{if(x.length>0){k.ApplyStyle(x.shift(),d)}else{k.displayAll(u,r,function(){k.RefreshHtml();k.SetMonitoring(e);a.CallBack(c)})}}}}}}function v(){if(("_monitoring" in k.h)&&!e){e=k.h._monitoring}if(("_layout" in k.h)&&(z==null)){k.disp_kind=k.h._layout}if(("_loadfile" in k.h)&&(A.length==0)){A=a.ParseAsArray(k.h._loadfile)}if(("_drawitem" in k.h)&&(u.length==0)){u=a.ParseAsArray(k.h._drawitem);r=a.ParseAsArray(k.h._drawopt)}d()}var l=null;if(this.is_online){if(typeof GetCachedHierarchy=="function"){l=GetCachedHierarchy()}if(typeof l!=="object"){l=""}}if(l!==null){k.OpenOnline(l,v)}else{if(f.length>0){a.AssertPrerequisites(f,d)}else{d()}}};a.HierarchyPainter.prototype.PrepareGuiDiv=function(c,f){this.gui_div=c.attr("id");c.append("div").attr("id",this.gui_div+"_drawing").classed("jsroot_draw_area",true).style("position","absolute").style("left",0).style("top",0).style("bottom",0).style("right",0);if(!this.exclude_browser){var d=c.append("div").classed("jsroot_browser",true);var e=d.append("div").classed("jsroot_browser_btns",true).classed("jsroot",true);e.style("position","absolute").style("left","7px").style("top","7px");if(a.touches){e.style("opacity","0.2")}a.ToolbarIcons.CreateSVG(e,a.ToolbarIcons.diamand,15,"toggle fix-pos browser").style("margin","3px").on("click",this.CreateBrowser.bind(this,"fix",true));if(!this.float_browser_disabled){a.ToolbarIcons.CreateSVG(e,a.ToolbarIcons.circle,15,"toggle float browser").style("margin","3px").on("click",this.CreateBrowser.bind(this,"float",true))}if(!this.status_disabled){a.ToolbarIcons.CreateSVG(e,a.ToolbarIcons.three_circles,15,"toggle status line").style("margin","3px").on("click",this.CreateStatusLine.bind(this,"on","toggle"))}}this.SetDisplay(f,this.gui_div+"_drawing")};a.HierarchyPainter.prototype.CreateStatusLine=function(c,e){if(!this.gui_div){return}var d=this;a.AssertPrerequisites("jq2d",function(){d.CreateStatusLine(c,e)})};a.HierarchyPainter.prototype.CreateBrowser=function(d,c,f){if(!this.gui_div){return}var e=this;a.AssertPrerequisites("jq2d",function(){e.CreateBrowser(d,c,f)})};a.BuildNobrowserGUI=function(){var c=b.select("#simpleGUI"),e=false,f=false;if(c.empty()){e=true;c=b.select("#onlineGUI");if(c.empty()){c=b.select("#drawGUI");f=true}if(c.empty()){return alert("no div for simple nobrowser gui found")}}if(c.attr("ignoreurl")==="true"){a.gStyle.IgnoreUrlOptions=true}a.Painter.readStyleFromURL();b.select("html").style("height","100%");b.select("body").style("min-height","100%").style("margin",0).style("overflow","hidden");c.style("position","absolute").style("left",0).style("top",0).style("bottom",0).style("right",0).style("padding",1);if(f&&((a.GetUrlOption("webcanvas")!==null)||(a.GetUrlOption("longpollcanvas")!==null))){console.log("Start web painter directly");var d=new a.TPadPainter(null,true);d.SetDivId(c.attr("id"),-1);d.OpenWebsocket(a.GetUrlOption("longpollcanvas")!==null);a.RegisterForResize(d);return}var g=new a.HierarchyPainter("root",null);g.is_online=e;if(f){g.exclude_browser=true}g.start_without_browser=true;g.StartGUI(c,function(){if(!f){return}var i=a.findFunction("GetCachedObject");var j=(typeof i=="function")?a.JSONR_unref(i()):null;if(j){g._cached_draw_object=j}var h=a.GetUrlOption("opt")||"";if(a.GetUrlOption("websocket")!==null){h+=";websocket"}g.display("",h)})};a.Painter.drawStreamerInfo=function(j,g){var m=new a.HierarchyPainter("sinfo",j,"white");m.h={_name:"StreamerInfo",_childs:[]};for(var f=0;f<g.arr.length;++f){var n=g.arr[f];if(n._typename=="TList"){continue}if(typeof(n.fName)=="undefined"){a.console("strange element in StreamerInfo with type "+n._typename);continue}var o={_name:n.fName+";"+n.fClassVersion,_kind:"class "+n.fName,_title:"class:"+n.fName+" version:"+n.fClassVersion+" checksum:"+n.fCheckSum,_icon:"img_class",_childs:[]};if(n.fTitle!=""){o._title+="  "+n.fTitle}m.h._childs.push(o);if(typeof n.fElements=="undefined"){continue}for(var e=0;e<n.fElements.arr.length;++e){var d=n.fElements.arr[e];if(!d||!d.fName){continue}var c=d.fTypeName+" "+d.fName,k=d.fTypeName+" type:"+d.fType;if(d.fArrayDim===1){c+="["+d.fArrayLength+"]"}else{for(var h=0;h<d.fArrayDim;++h){c+="["+d.fMaxIndex[h]+"]"}}if(d.fBaseVersion===4294967295){c+=":-1"}else{if(d.fBaseVersion!==undefined){c+=":"+d.fBaseVersion}}c+=";";if(d.fTitle!=""){c+=" // "+d.fTitle}o._childs.push({_name:c,_title:k,_kind:d.fTypeName,_icon:(d.fTypeName=="BASE")?"img_class":"img_member"})}if(o._childs.length==0){delete o._childs}}m.RefreshHtml(function(){m.SetDivId(j);m.DrawingReady()});return m};a.Painter.drawInspector=function(e,d){a.cleanup(e);var c=new a.HierarchyPainter("inspector",e,"white");c.default_by_click="expand";c.with_icons=false;c.h={_name:"Object",_title:"",_click_action:"expand",_nosimple:false,_do_context:true};if((typeof d.fTitle==="string")&&(d.fTitle.length>0)){c.h._title=d.fTitle}if(d._typename){c.h._title+="  type:"+d._typename}if((typeof d.fName==="string")&&(d.fName.length>0)){c.h._name=d.fName}c.fill_context=function(h,f){var g=a.getDrawSettings(f._kind,"nosame");if(g.opts){h.addDrawMenu("nosub:Draw",g.opts,function(i){if(!f||!f._obj){return}var j=f._obj,k=this.divid;a.cleanup(k);a.draw(k,j,i)})}};if(a.IsRootCollection(d)){c.h._name=d.name||d._typename;a.Painter.ListHierarchy(c.h,d)}else{a.Painter.ObjectHierarchy(c.h,d)}c.RefreshHtml(function(){c.SetDivId(e);c.DrawingReady()});return c};a.MDIDisplay=function(c){a.TBasePainter.call(this);this.frameid=c;this.SetDivId(c);this.select_main().property("mdi",this);this.CleanupFrame=a.cleanup;this.active_frame_title=""};a.MDIDisplay.prototype=Object.create(a.TBasePainter.prototype);a.MDIDisplay.prototype.BeforeCreateFrame=function(c){this.active_frame_title=c};a.MDIDisplay.prototype.ForEachFrame=function(c,d){console.warn("ForEachFrame not implemented in MDIDisplay")};a.MDIDisplay.prototype.ForEachPainter=function(c,d){this.ForEachFrame(function(f){var e=new a.TObjectPainter();e.SetDivId(f,-1);e.ForEachPainter(function(g){c(g,f)})},d)};a.MDIDisplay.prototype.NumDraw=function(){var c=0;this.ForEachFrame(function(){++c});return c};a.MDIDisplay.prototype.FindFrame=function(d,e){var c=null;this.ForEachFrame(function(f){if(b.select(f).attr("frame_title")==d){c=f}});if((c==null)&&e){c=this.CreateFrame(d)}return c};a.MDIDisplay.prototype.ActivateFrame=function(c){this.active_frame_title=b.select(c).attr("frame_title")};a.MDIDisplay.prototype.GetActiveFrame=function(){return this.FindFrame(this.active_frame_title)};a.MDIDisplay.prototype.CheckMDIResize=function(d,e){var c=null;this.ForEachPainter(function(f,g){if(d&&(b.select(g).attr("id")!=d)){return}if((f.GetItemName()!==null)&&(typeof f.CheckResize=="function")){if(c===g){return}f.CheckResize(e);c=g}})};a.MDIDisplay.prototype.Reset=function(){this.active_frame_title="";this.ForEachFrame(this.CleanupFrame);this.select_main().html("").property("mdi",null)};a.MDIDisplay.prototype.Draw=function(f,d,c){if(!d){return}if(!a.canDraw(d._typename,c)){return}var e=this.FindFrame(f,true);this.ActivateFrame(e);return a.redraw(e,d,c)};a.CustomDisplay=function(){a.MDIDisplay.call(this,"dummy");this.frames={}};a.CustomDisplay.prototype=Object.create(a.MDIDisplay.prototype);a.CustomDisplay.prototype.AddFrame=function(d,c){if(!(d in this.frames)){this.frames[d]=""}this.frames[d]+=(c+";")};a.CustomDisplay.prototype.ForEachFrame=function(d,g){var f=Object.keys(this.frames);for(var c=0;c<f.length;++c){var e=b.select("#"+f[c]);if(!e.empty()){a.CallBack(d,e.node())}}};a.CustomDisplay.prototype.CreateFrame=function(e){this.BeforeCreateFrame(e);var f=Object.keys(this.frames);for(var d=0;d<f.length;++d){var c=this.frames[f[d]];if(c.indexOf(e+";")>=0){return b.select("#"+f[d]).node()}}return null};a.CustomDisplay.prototype.Reset=function(){a.MDIDisplay.prototype.Reset.call(this);this.ForEachFrame(function(c){b.select(c).html("")})};a.GridDisplay=function(g,e,c){a.MDIDisplay.call(this,g);this.framecnt=0;this.getcnt=0;this.groups=[];this.vertical=e&&(e[0]=="v");this.use_separarators=!e||(e.indexOf("x")<0);this.simple_layout=false;this.select_main().style("overflow","hidden");if(e==="simple"){this.simple_layout=true;this.use_separarators=false;this.framecnt=1;return}var h=2,i=undefined,n=undefined;if((e.indexOf("grid")==0)||c){if(c){e=e+"x"+c}else{e=e.substr(4).trim()}this.use_separarators=false;if(e[0]==="i"){this.use_separarators=true;e=e.substr(1)}var d=e.indexOf("x"),l=3,j=3;if(d>0){j=parseInt(e.substr(d+1));l=parseInt(e.substr(0,d))}else{l=j=parseInt(e)}if(isNaN(l)){l=3}if(isNaN(j)){j=3}if(j>1){this.vertical=true;h=j;if(l>1){i=new Array(h);for(var f=0;f<h;++f){i[f]=l}}}else{if(l>1){this.vertical=false;h=l}else{this.simple_layout=true;this.use_separarators=false;this.framecnt=1;return}}e=""}if(e&&e.indexOf("_")>0){var m=parseInt(e.substr(e.indexOf("_")+1),10);if(!isNaN(m)&&(m>10)){e=e.substr(0,e.indexOf("_"));n=[];while(m>0){n.unshift(Math.max(m%10,1));m=Math.round((m-n[0])/10);if(n[0]===0){n[0]=1}}}}e=e?parseInt(e.replace(/^\D+/g,""),10):0;if(e&&(e>1)){if(e<10){h=e}else{i=[];while(e>0){i.unshift(e%10);e=Math.round((e-i[0])/10);if(i[0]==0){i[0]=1}}h=i.length}}if(n&&(n.length!==h)){n=undefined}if(!this.simple_layout){this.CreateGroup(this,this.select_main(),h,i,n)}};a.GridDisplay.prototype=Object.create(a.MDIDisplay.prototype);a.GridDisplay.prototype.CreateGroup=function(j,g,i,k,m){if(!m){m=new Array(i)}var h=0,f=0;for(var d=0;d<i;++d){h+=(m[d]||1)}for(var d=0;d<i;++d){m[d]=Math.round(100*(m[d]||1)/h);f+=m[d];if(d==i-1){m[d]+=(100-f)}}for(var c=0;c<i;++c){var l={id:c,drawid:-1,position:0,size:m[c]};if(c>0){l.position=j.groups[c-1].position+j.groups[c-1].size}l.position0=l.position;if(!k||!k[c]||k[c]<2){l.drawid=this.framecnt++}j.groups.push(l);var e=g.append("div").attr("groupid",l.id);if(j.vertical){e.style("float","bottom").style("height",l.size+"%").style("width","100%")}else{e.style("float","left").style("width",l.size+"%").style("height","100%")}if(l.drawid>=0){e.classed("jsroot_newgrid",true);if(typeof this.frameid==="string"){e.attr("id",this.frameid+"_"+l.drawid)}}else{e.style("display","flex").style("flex-direction",j.vertical?"row":"column")}if(k&&(k[c]>1)){l.vertical=!j.vertical;l.groups=[];e.style("overflow","hidden");this.CreateGroup(l,e,k[c])}}if(this.use_separarators&&this.CreateSeparator){for(var c=1;c<i;++c){this.CreateSeparator(j,g,j.groups[c])}}};a.GridDisplay.prototype.ForEachFrame=function(d,e){var c=this.select_main();if(this.simple_layout){d(c.node())}else{c.selectAll(".jsroot_newgrid").each(function(){d(b.select(this).node())})}};a.GridDisplay.prototype.GetActiveFrame=function(){if(this.simple_layout){return this.select_main().node()}var c=a.MDIDisplay.prototype.GetActiveFrame.call(this);if(c){return c}this.ForEachFrame(function(d){if(!c){c=d}},true);return c};a.GridDisplay.prototype.ActivateFrame=function(c){this.active_frame_title=b.select(c).attr("frame_title")};a.GridDisplay.prototype.GetFrame=function(e){var c=this.select_main();if(this.simple_layout){return c.node()}var d=null;c.selectAll(".jsroot_newgrid").each(function(){if(e--===0){d=this}});return d};a.GridDisplay.prototype.NumGridFrames=function(){return this.framecnt};a.GridDisplay.prototype.CreateFrame=function(d){this.BeforeCreateFrame(d);var c=this.GetFrame(this.getcnt);if(!this.simple_layout&&this.framecnt){this.getcnt=(this.getcnt+1)%this.framecnt}b.select(c).attr("frame_title",d);a.cleanup(c);return c};a.RegisterForResize=function(f,d){if(!f){return}var g=null,c=d?d:300;if(c<20){c=20}function e(){g=null;document.body.style.cursor="wait";if(typeof f=="function"){f()}else{if((typeof f=="object")&&(typeof f.CheckResize=="function")){f.CheckResize()}else{if(typeof f=="string"){var i=b.select("#"+f);if(!i.empty()){var j=i.property("mdi");if(j){j.CheckMDIResize()}else{a.resize(i.node())}}}}}document.body.style.cursor="auto"}function h(){if(g!==null){clearTimeout(g)}g=setTimeout(e,c)}window.addEventListener("resize",h)};a.addDrawFunc({name:"TCanvas",icon:"img_canvas",func:a.Painter.drawCanvas,opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:"fPrimitives"});a.addDrawFunc({name:"TPad",icon:"img_canvas",func:a.Painter.drawPad,opt:";grid;gridx;gridy;tick;tickx;ticky;log;logx;logy;logz",expand_item:"fPrimitives"});a.addDrawFunc({name:"TSlider",icon:"img_canvas",func:a.Painter.drawPad});a.addDrawFunc({name:"TFrame",icon:"img_frame",func:a.Painter.drawFrame});a.addDrawFunc({name:"TPaveText",icon:"img_pavetext",func:a.Painter.drawPaveText});a.addDrawFunc({name:"TPaveStats",icon:"img_pavetext",func:a.Painter.drawPaveText});a.addDrawFunc({name:"TPaveLabel",icon:"img_pavelabel",func:a.Painter.drawPaveText});a.addDrawFunc({name:"TLatex",icon:"img_text",func:a.Painter.drawText});a.addDrawFunc({name:"TMathText",icon:"img_text",func:a.Painter.drawText});a.addDrawFunc({name:"TText",icon:"img_text",func:a.Painter.drawText});a.addDrawFunc({name:/^TH1/,icon:"img_histo1d",func:a.Painter.drawHistogram1D,opt:";hist;P;P0;E;E1;E2;E3;E4;E1X0;L;LF2;B;B1;TEXT;LEGO;same",ctrl:"l"});a.addDrawFunc({name:"TProfile",icon:"img_profile",func:a.Painter.drawHistogram1D,opt:";E0;E1;E2;p;hist"});a.addDrawFunc({name:"TH2Poly",icon:"img_histo2d",prereq:"more2d",func:"JSROOT.Painter.drawHistogram2D",opt:";COL;COL0;COLZ;LCOL;LCOL0;LCOLZ;LEGO;same",expand_item:"fBins",theonly:true});a.addDrawFunc({name:"TH2PolyBin",icon:"img_histo2d",draw_field:"fPoly"});a.addDrawFunc({name:/^TH2/,icon:"img_histo2d",prereq:"more2d",func:"JSROOT.Painter.drawHistogram2D",opt:";COL;COLZ;COL0;COL1;COL0Z;COL1Z;BOX;BOX1;SCAT;TEXT;CONT;CONT1;CONT2;CONT3;CONT4;ARR;SURF;SURF1;SURF2;SURF4;SURF6;E;LEGO;LEGO0;LEGO1;LEGO2;LEGO3;LEGO4;same",ctrl:"colz"});a.addDrawFunc({name:"TProfile2D",sameas:"TH2"});a.addDrawFunc({name:/^TH3/,icon:"img_histo3d",prereq:"3d",func:"JSROOT.Painter.drawHistogram3D",opt:";SCAT;BOX;BOX2;BOX3;GLBOX1;GLBOX2;GLCOL"});a.addDrawFunc({name:"THStack",icon:"img_histo1d",prereq:"more2d",func:"JSROOT.Painter.drawHStack",expand_item:"fHists"});a.addDrawFunc({name:"TPolyMarker3D",icon:"img_histo3d",prereq:"3d",func:"JSROOT.Painter.drawPolyMarker3D"});a.addDrawFunc({name:"TGraphPolargram"});a.addDrawFunc({name:"TGraph2D",icon:"img_graph",prereq:"more2d;3d",func:"JSROOT.Painter.drawGraph2D",opt:";P;PCOL"});a.addDrawFunc({name:"TGraph2DErrors",icon:"img_graph",prereq:"more2d;3d",func:"JSROOT.Painter.drawGraph2D",opt:";P;PCOL;ERR"});a.addDrawFunc({name:/^TGraph/,icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawGraph",opt:";L;P"});a.addDrawFunc({name:"TCutG",sameas:"TGraph"});a.addDrawFunc({name:/^RooHist/,sameas:"TGraph"});a.addDrawFunc({name:/^RooCurve/,sameas:"TGraph"});a.addDrawFunc({name:"RooPlot",icon:"img_canvas",prereq:"more2d",func:"JSROOT.Painter.drawRooPlot"});a.addDrawFunc({name:"TMultiGraph",icon:"img_mgraph",prereq:"more2d",func:"JSROOT.Painter.drawMultiGraph",expand_item:"fGraphs"});a.addDrawFunc({name:"TStreamerInfoList",icon:"img_question",func:a.Painter.drawStreamerInfo});a.addDrawFunc({name:"TPaletteAxis",icon:"img_colz",prereq:"more2d",func:"JSROOT.Painter.drawPaletteAxis"});a.addDrawFunc({name:"TWebPainting",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawWebPainting"});a.addDrawFunc({name:"kind:Text",icon:"img_text",func:a.Painter.drawRawText});a.addDrawFunc({name:"TF1",icon:"img_tf1",prereq:"math;more2d",func:"JSROOT.Painter.drawFunction"});a.addDrawFunc({name:"TF2",icon:"img_tf2",prereq:"math;more2d",func:"JSROOT.Painter.drawTF2"});a.addDrawFunc({name:"TEllipse",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawEllipse"});a.addDrawFunc({name:"TLine",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawLine"});a.addDrawFunc({name:"TArrow",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawArrow"});a.addDrawFunc({name:"TPolyLine",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawPolyLine"});a.addDrawFunc({name:"TGaxis",icon:"img_graph",func:a.drawGaxis});a.addDrawFunc({name:"TLegend",icon:"img_pavelabel",prereq:"more2d",func:"JSROOT.Painter.drawLegend"});a.addDrawFunc({name:"TBox",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawBox"});a.addDrawFunc({name:"TWbox",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawBox"});a.addDrawFunc({name:"TSliderBox",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawBox"});a.addDrawFunc({name:"TMarker",icon:"img_graph",prereq:"more2d",func:"JSROOT.Painter.drawMarker"});a.addDrawFunc({name:"TGeoVolume",icon:"img_histo3d",prereq:"geom",func:"JSROOT.Painter.drawGeoObject",expand:"JSROOT.GEO.expandObject",opt:";more;all;count;projx;projz;dflt",ctrl:"dflt"});a.addDrawFunc({name:"TEveGeoShapeExtract",icon:"img_histo3d",prereq:"geom",func:"JSROOT.Painter.drawGeoObject",expand:"JSROOT.GEO.expandObject",opt:";more;all;count;projx;projz;dflt",ctrl:"dflt"});a.addDrawFunc({name:"TGeoManager",icon:"img_histo3d",prereq:"geom",expand:"JSROOT.GEO.expandObject",func:"JSROOT.Painter.drawGeoObject",opt:";more;all;count;projx;projz;dflt",dflt:"expand",ctrl:"dflt"});a.addDrawFunc({name:/^TGeo/,icon:"img_histo3d",prereq:"geom",func:"JSROOT.Painter.drawGeoObject",opt:";more;all;axis;compa;count;projx;projz;dflt",ctrl:"dflt"});a.addDrawFunc({name:"kind:Command",icon:"img_execute",execute:true});a.addDrawFunc({name:"TFolder",icon:"img_folder",icon2:"img_folderopen",noinspect:true,expand:a.Painter.FolderHierarchy});a.addDrawFunc({name:"TTask",icon:"img_task",expand:a.Painter.TaskHierarchy,for_derived:true});a.addDrawFunc({name:"TTree",icon:"img_tree",prereq:"tree",expand:"JSROOT.Painter.TreeHierarchy",func:"JSROOT.Painter.drawTree",dflt:"expand",opt:"player;testio",shift:"inspect"});a.addDrawFunc({name:"TNtuple",icon:"img_tree",prereq:"tree",expand:"JSROOT.Painter.TreeHierarchy",func:"JSROOT.Painter.drawTree",dflt:"expand",opt:"player;testio",shift:"inspect"});a.addDrawFunc({name:"TNtupleD",icon:"img_tree",prereq:"tree",expand:"JSROOT.Painter.TreeHierarchy",func:"JSROOT.Painter.drawTree",dflt:"expand",opt:"player;testio",shift:"inspect"});a.addDrawFunc({name:"TBranchFunc",icon:"img_leaf_method",prereq:"tree",func:"JSROOT.Painter.drawTree",opt:";dump",noinspect:true});a.addDrawFunc({name:/^TBranch/,icon:"img_branch",prereq:"tree",func:"JSROOT.Painter.drawTree",dflt:"expand",opt:";dump",ctrl:"dump",shift:"inspect",ignore_online:true});a.addDrawFunc({name:/^TLeaf/,icon:"img_leaf",prereq:"tree",noexpand:true,func:"JSROOT.Painter.drawTree",opt:";dump",ctrl:"dump",ignore_online:true});a.addDrawFunc({name:"TList",icon:"img_list",expand:a.Painter.ListHierarchy,dflt:"expand"});a.addDrawFunc({name:"THashList",sameas:"TList"});a.addDrawFunc({name:"TObjArray",sameas:"TList"});a.addDrawFunc({name:"TClonesArray",sameas:"TList"});a.addDrawFunc({name:"TMap",sameas:"TList"});a.addDrawFunc({name:"TColor",icon:"img_color"});a.addDrawFunc({name:"TFile",icon:"img_file",noinspect:true});a.addDrawFunc({name:"TMemFile",icon:"img_file",noinspect:true});a.addDrawFunc({name:"TStyle",icon:"img_question",noexpand:true});a.addDrawFunc({name:"Session",icon:"img_globe"});a.addDrawFunc({name:"kind:TopFolder",icon:"img_base"});a.addDrawFunc({name:"kind:Folder",icon:"img_folder",icon2:"img_folderopen",noinspect:true});a.getDrawHandle=function(e,f){if(typeof e!="string"){return null}if(f===""){f=null}var l=null;if((f===null)&&(e in a.DrawFuncs.cache)){return a.DrawFuncs.cache[e]}var n=(e.indexOf("ROOT.")==0)?e.substr(5):"kind:"+e;var d=0;for(var k=0;k<a.DrawFuncs.lst.length;++k){var m=a.DrawFuncs.lst[k];if(typeof m.name=="string"){if(m.name!=n){continue}}else{if(!n.match(m.name)){continue}}if(m.sameas!==undefined){return a.getDrawHandle("ROOT."+m.sameas,f)}if(f==null){if(!(e in a.DrawFuncs.cache)){a.DrawFuncs.cache[e]=m}return m}else{if(typeof f=="string"){if(!l){l=m}if(f=="::expand"){if(("expand" in m)||("expand_item" in m)){return m}}else{if("opt" in m){var c=m.opt.split(";");for(var g=0;g<c.length;++g){c[g]=c[g].toLowerCase()}if(c.indexOf(f.toLowerCase())>=0){return m}}}}else{if(f===d){return m}}}++d}return l};a.addStreamerInfos=function(d){if(d===null){return}function c(n,m){if(n.fElements==null){return null}if(m>10){return null}for(var l=0;l<n.fElements.arr.length;++l){var o=n.fElements.arr[l];if(o.fTypeName!=="BASE"){continue}var p=a.getDrawHandle("ROOT."+o.fName);if(p&&!p.for_derived){p=null}if(p===null){for(var i=0;i<d.arr.length;++i){if(d.arr[i].fName===o.fName){p=c(d.arr[i],m+1);break}}}if(p&&p.for_derived){return p}}return null}for(var h=0;h<d.arr.length;++h){var e=d.arr[h];if(a.getDrawHandle("ROOT."+e.fName)!==null){continue}var f=c(e,0);if(!f){continue}var g=a.extend({},f);g.name=e.fName;a.DrawFuncs.lst.push(g)}};a.getDrawSettings=function(e,f){var m={opts:null,inspect:false,expand:false,draw:false,handle:null};if(typeof e!="string"){return m}var g=null,k=false,n=false,o=false;if(typeof f!=="string"){f=""}for(var d=0;d<1000;++d){var l=a.getDrawHandle(e,d);if(!l){break}if(!m.handle){m.handle=l}if(l.noinspect){n=true}if(l.expand||l.expand_item||l.can_expand){o=true}if(!("func" in l)){break}k=true;if(!("opt" in l)){continue}var c=l.opt.split(";");for(var j=0;j<c.length;++j){c[j]=c[j].toLowerCase();if((f.indexOf("nosame")>=0)&&(c[j].indexOf("same")==0)){continue}if(m.opts===null){m.opts=[]}if(m.opts.indexOf(c[j])<0){m.opts.push(c[j])}}if(l.theonly){break}}if(f.indexOf("noinspect")>=0){n=true}if(k&&(m.opts===null)){m.opts=[""]}if(!k&&(e.indexOf("ROOT.")==0)&&!n){m.opts=[]}if(!n&&m.opts){m.opts.push("inspect")}m.inspect=!n;m.expand=o;m.draw=m.opts&&(m.opts.length>0);return m};a.getDrawOptions=function(d,c){return a.getDrawSettings(d).opts};a.canDraw=function(c){return a.getDrawSettings("ROOT."+c).opts!==null};a.draw=function(j,h,e,m){function c(n){if(n&&m&&(typeof n.WhenReady=="function")){n.WhenReady(m)}else{a.CallBack(m,n)}return n}if((h===null)||(typeof h!=="object")){return c(null)}if(e=="inspect"){return c(a.Painter.drawInspector(j,h))}var i=null,k=null;if("_typename" in h){i=a.getDrawHandle("ROOT."+h._typename,e)}else{if("_kind" in h){i=a.getDrawHandle(h._kind,e)}}if(!i){return c(null)}if(i.draw_field&&h[i.draw_field]){return a.draw(j,h[i.draw_field],e,m)}if(!i.func){return c(null)}function d(){if(!k&&("painter_kind" in i)){k=(i.painter_kind=="base")?new a.TBasePainter():new a.TObjectPainter(h)}if(!k){k=i.func(j,h,e)}else{k=i.func.bind(k)(j,h,e,k)}return c(k)}if(typeof i.func=="function"){return d()}var g="",l="";if(typeof i.func=="object"){if("func" in i.func){g=i.func.func}if("script" in i.func){l="user:"+i.func.script}}else{if(typeof i.func=="string"){g=i.func;if(("prereq" in i)&&(typeof i.prereq=="string")){l=i.prereq}if(("script" in i)&&(typeof i.script=="string")){l+=";user:"+i.script}}}if(g.length===0){return c(null)}if((i.painter_kind===undefined)&&(l.length>0)){i.painter_kind=(g.indexOf("JSROOT.Painter")==0)?"object":"base"}var f=a.findFunction(g);if(f){i.func=f;return d()}if(l.length===0){return c(null)}k=(i.painter_kind=="base")?new a.TBasePainter():new a.TObjectPainter(h);a.AssertPrerequisites(l,function(){var n=a.findFunction(g);if(!n){alert("Fail to find function "+g+" after loading "+l);return c(null)}i.func=n;if(d()!==k){alert("Painter function "+g+" do not follow rules of dynamicaly loaded painters")}});return k};a.redraw=function(j,f,c,l){if(!f){return a.CallBack(l,null)}var d=new a.TObjectPainter();d.SetDivId(j,-1);var e=d.pad_painter();var h=null;if(f._typename){h=a.getDrawHandle("ROOT."+f._typename)}if(h&&h.draw_field&&f[h.draw_field]){f=f[h.draw_field]}if(e){if(f._typename==="TCanvas"){e.RedrawObject(f);a.CallBack(l,e);return e}for(var g=0;g<e.painters.length;++g){var k=e.painters[g];if(k.MatchObjectType(f._typename)){if(k.UpdateObject(f)){e.RedrawPad();a.CallBack(l,k);return k}}}}if(e){a.console("Cannot find painter to update object of type "+f._typename)}a.cleanup(j);return a.draw(j,f,c,l)};a.MakeSVG=function(d,f){if(!d){d={}}if(!d.object){return a.CallBack(f,null)}if(!d.width){d.width=1200}if(!d.height){d.height=800}function e(g){g.attr("width",d.width).attr("height",d.height);g.style("width",d.width+"px").style("height",d.height+"px");a.svg_workaround=undefined;a.draw(g.node(),d.object,d.option||"",function(h){g.select("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("width",d.width).attr("height",d.height).attr("style","").attr("style",null).attr("class",null).attr("x",null).attr("y",null);var j=g.html();if(a.svg_workaround){for(var i=0;i<a.svg_workaround.length;++i){j=j.replace('<path jsroot_svg_workaround="'+i+'"></path>',a.svg_workaround[i])}a.svg_workaround=undefined}j=j.replace(/url\(\&quot\;\#(\w+)\&quot\;\)/g,"url(#$1)");g.remove();a.CallBack(f,j)})}if(!a.nodejs){e(b.select(window.document).append("div").style("visible","hidden"))}else{if(a.nodejs_document){e(a.nodejs_window.d3.select("body").append("div"))}else{var c=require("jsdom");c.env({html:"",features:{QuerySelector:true},done:function(h,g){g.d3=b.select(g.document);a.nodejs_window=g;a.nodejs_document=g.document;e(g.d3.select("body").append("div"))}})}}};a.resize=function(f,c){if(c===true){c={force:true}}else{if(typeof c!=="object"){c=null}}var e=new a.TObjectPainter(),d=false;e.SetDivId(f,-1);e.ForEachPainter(function(g){if(!d&&typeof g.CheckResize=="function"){d=g.CheckResize(c)}});return d};a.CheckElementResize=a.resize;a.cleanup=function(f){var d=new a.TObjectPainter(),c=[];d.SetDivId(f,-1);d.ForEachPainter(function(g){if(c.indexOf(g)<0){c.push(g)}});for(var e=0;e<c.length;++e){c[e].Cleanup()}d.select_main().html("");return c};a.progress=function(e,d){if(a.BatchMode||!document){return}var f="jsroot_progressbox",c=b.select("#"+f);if(!a.gStyle.ProgressBox){return c.remove()}if((arguments.length==0)||!e){if((d!==-1)||(!c.empty()&&c.property("with_timeout"))){c.remove()}return}if(c.empty()){c=b.select(document.body).append("div").attr("id",f);c.append("p")}c.property("with_timeout",false);if(typeof e==="string"){c.select("p").html(e)}else{c.html("");c.node().appendChild(e)}if(!isNaN(d)&&(d>0)){c.property("with_timeout",true);setTimeout(a.progress.bind(a,"",-1),d)}};a.Painter.createRootColors();return a}));