(function(a){if(typeof define==="function"&&define.amd){define(["jquery","jquery-ui","d3","JSRootPainter"],a)}else{if(typeof jQuery=="undefined"){throw new Error("jQuery not defined","JSRootPainter.jquery.js")}if(typeof jQuery.ui=="undefined"){throw new Error("jQuery-ui not defined","JSRootPainter.jquery.js")}if(typeof d3!="object"){throw new Error("This extension requires d3.v3.js","JSRootPainter.jquery.js")}if(typeof JSROOT=="undefined"){throw new Error("JSROOT is not defined","JSRootPainter.jquery.js")}if(typeof JSROOT.Painter!="object"){throw new Error("JSROOT.Painter not defined","JSRootPainter.jquery.js")}a(jQuery,jQuery.ui,d3,JSROOT)}}(function(c,d,b,a){a.sources.push("jq2d");if(typeof define==="function"&&define.amd){a.loadScript("$$$style/jquery-ui.css")}a.Painter.createMenu=function(e,f){var g="root_ctx_menu";if(!f&&typeof e==="function"){f=e;e=null}var h={painter:e,element:null,code:"",cnt:1,funcs:{},separ:false};h.add=function(j,i,n){if(j=="separator"){this.code+="<li>-</li>";this.separ=true;return}if(j.indexOf("header:")==0){this.code+="<li class='ui-widget-header' style='padding:3px; padding-left:5px;'>"+j.substr(7)+"</li>";return}if(j=="endsub:"){this.code+="</ul></li>";return}var m="</li>",k="";if(j.indexOf("sub:")==0){j=j.substr(4);m="<ul>"}if(typeof i=="function"){n=i;i=j}var l="";if(j.indexOf("chk:")==0){l="<span class='ui-icon ui-icon-check' style='margin:1px'></span>";j=j.substr(4)}else{if(j.indexOf("unk:")==0){l="<span class='ui-icon ui-icon-blank' style='margin:1px'></span>";j=j.substr(4)}}if((c.ui.version.indexOf("1.10")==0)||(c.ui.version.indexOf("1.9")==0)){l='<a href="#">'+l+j+"</a>"}else{if(c.ui.version.indexOf("1.11")==0){l+=j}else{l="<div>"+l+j+"</div>"}}this.code+="<li cnt='"+this.cnt+"' arg='"+i+"' style='"+k+"'>"+l+m;if(typeof n=="function"){this.funcs[this.cnt]=n}this.cnt++};h.addchk=function(j,k,i,l){return this.add((j?"chk:":"unk:")+k,i,l)};h.size=function(){return this.cnt-1};h.addDrawMenu=function(r,o,p){if(!o){o=[]}if(o.length==0){o.push("")}var j=false;if(r.indexOf("nosub:")==0){j=true;r=r.substr(6)}if(o.length===1){if(o[0]==="inspect"){r=r.replace("Draw","Inspect")}return this.add(r,o[0],p)}if(!j){this.add("sub:"+r,o[0],p)}for(var n=0;n<o.length;++n){var m=o[n];if(m==""){m="&lt;dflt&gt;"}var q=n+1;if((o.length>5)&&(m.length>0)){while((q<o.length)&&(o[q].indexOf(m)==0)){q++}}if(j){m=r+" "+m}if(q<n+2){this.add(m,o[n],p)}else{this.add("sub:"+m,o[n],p);for(var l=n+1;l<q;++l){this.add(o[l],o[l],p)}this.add("endsub:");n=q-1}}if(!j){this.add("endsub:")}};h.remove=function(){if(this.element!==null){this.element.remove();if(this.close_callback){this.close_callback()}document.body.removeEventListener("click",this.remove_bind)}this.element=null};h.remove_bind=h.remove.bind(h);h.show=function(k,m){this.remove();if(typeof m=="function"){this.close_callback=m}document.body.addEventListener("click",this.remove_bind);var j=document.getElementById(g);if(j){j.parentNode.removeChild(j)}c(document.body).append('<ul class="jsroot_ctxmenu">'+this.code+"</ul>");this.element=c(".jsroot_ctxmenu");var i=this;this.element.attr("id",g).css("left",k.clientX+window.pageXOffset).css("top",k.clientY+window.pageYOffset).css("position","absolute").menu({items:"> :not(.ui-widget-header)",select:function(r,s){var o=s.item.attr("arg"),p=s.item.attr("cnt"),q=p?i.funcs[p]:null;i.remove();if(typeof q=="function"){if("painter" in h){q.bind(i.painter)(o)}else{q(o)}}}});var n=null,l=null;if(k.clientX+this.element.width()>c(window).width()){n=c(window).width()-this.element.width()-20}if(k.clientY+this.element.height()>c(window).height()){l=c(window).height()-this.element.height()-20}if(n!==null){this.element.css("left",(n>0?n:0)+window.pageXOffset)}if(l!==null){this.element.css("top",(l>0?l:0)+window.pageYOffset)}};a.CallBack(f,h);return h};a.HierarchyPainter.prototype.isLastSibling=function(f){if(!f||!f._parent||!f._parent._childs){return false}var e=f._parent._childs,g=e.indexOf(f);if(g<0){return false}while(++g<e.length){if(!("_hidden" in e[g])){return false}}return true};a.HierarchyPainter.prototype.addItemHtml=function(e,n,k){if(!e||("_hidden" in e)){return true}var p=(e===this.h),j=("_childs" in e),D=a.getDrawHandle(e._kind),H="",G="",w=false,v=false,A,r=this.itemFullName(e);if(D!==null){if("icon" in D){H=D.icon}if("icon2" in D){G=D.icon2}if((H.length==0)&&(typeof D.icon_get=="function")){H=D.icon_get(e,this)}if(("func" in D)||("execute" in D)||("aslink" in D)||(("expand" in D)&&(e._more!==false))){w=true}}if("_icon" in e){H=e._icon}if("_icon2" in e){G=e._icon2}if((H.length==0)&&("_online" in e)){e._icon=H="img_globe"}if((H.length==0)&&p){e._icon=H="img_base"}if(e._more||("_expand" in e)||("_player" in e)){w=true}var C=w;if(!C&&(typeof e._kind=="string")&&(e._kind.indexOf("ROOT.")==0)){C=w=true}if(G.length==0){G=H}if(H.length==0){H=(j||e._more)?"img_folder":"img_page"}if(G.length==0){G=(j||e._more)?"img_folderopen":"img_page"}if(k==="update"){n.selectAll("*").remove();A=n}else{A=n.append("div");if(k&&(k>=(e._parent._show_limit||a.gStyle.HierarchyLimit))){v=true}}e._d3cont=A.node();A.attr("item",r);var g=A.append("div").attr("class","h_line");var x=p?null:e._parent;while(x&&(x!==this.h)){g.insert("div",":first-child").attr("class",this.isLastSibling(x)?"img_empty":"img_line");x=x._parent}var f="",o=false;if(p){}else{if(j&&!v){f=e._isopen?"img_minus":"img_plus";o=true}else{f="img_join"}}var z=this;if(f.length>0){if(v||this.isLastSibling(e)){f+="bottom"}var q=g.append("div").attr("class",f);if(o){q.style("cursor","pointer").on("click",function(){z.tree_click(this,"plusminus")})}}if(this.with_icons&&!v){var B=e._isopen?G:H;var m;if(B.indexOf("img_")==0){m=g.append("div").attr("class",B).attr("title",e._kind)}else{m=g.append("img").attr("src",B).attr("alt","").attr("title",e._kind).style("vertical-align","top").style("width","18px").style("height","18px")}if(("_icon_click" in e)||(D&&("icon_click" in D))){m.on("click",function(){z.tree_click(this,"icon")})}}var t=g.append("a");if(w||j||v){t.attr("class","h_item").on("click",function(){z.tree_click(this)})}if(v){e._break_point=true;t.attr("title","there are "+(e._parent._childs.length-k)+" more items").text("...more...");return false}if("disp_kind" in z){if(a.gStyle.DragAndDrop&&w){this.enable_dragging(t.node(),r)}if(a.gStyle.ContextMenu&&C){t.on("contextmenu",function(){z.tree_contextmenu(this)})}t.on("mouseover",function(){z.tree_mouseover(true,this)}).on("mouseleave",function(){z.tree_mouseover(false,this)})}else{if(e._direct_context&&a.gStyle.ContextMenu){t.on("contextmenu",function(){z.direct_contextmenu(this)})}}var s=e._name,u="";if("_realname" in e){s=e._realname}if("_title" in e){u=e._title}if("_fullname" in e){u+="  fullname: "+e._fullname}if(!u){u=s}t.attr("title",u).text(s+("_value" in e?":":"")).style("background",e._background?e._background:null);if("_value" in e){var l=g.append("p");if("_vclass" in e){l.attr("class",e._vclass)}if(!e._isopen){l.html(e._value)}}if(j&&(p||e._isopen)){var F=A.append("div").attr("class","h_childs");for(var y=0;y<e._childs.length;++y){var E=e._childs[y];E._parent=e;if(!this.addItemHtml(E,F,y)){break}}}return true};a.HierarchyPainter.prototype.toggleOpenState=function(j,g){var e=g?g:this.h;if(!("_childs" in e)){if(!j||this.with_icons||(!e._expand&&(e._more!==true))){return false}this.expand(this.itemFullName(e));if(e._childs){e._isopen=true}return true}if((e!=this.h)&&j&&!e._isopen){e._isopen=true;return true}var k=false;for(var f=0;f<e._childs.length;++f){if(this.toggleOpenState(j,e._childs[f])){k=true}}if((e!=this.h)&&!j&&e._isopen&&!k){delete e._isopen;return true}if(!g){this.RefreshHtml()}return false};a.HierarchyPainter.prototype.RefreshHtml=function(p){if(!this.divid){return a.CallBack(p)}var l=this.select_main();l.html("").style("overflow","hidden").style("display","flex").style("flex-direction","column");var k=this,o=[],e=null;this.ForEach(function(h){delete h._d3cont;if(("_fastcmd" in h)&&(h._kind=="Command")){o.push(h)}if(("_status" in h)&&(e==null)){e=h}});if((this.h==null)||l.empty()){return a.CallBack(p)}if(o.length){var q=l.append("div").attr("class","jsroot");for(var i=0;i<o.length;++i){var g=q.append("button").text("").attr("class","fast_command").attr("item",this.itemFullName(o[i])).attr("title",o[i]._title).on("click",function(){k.ExecuteCommand(b.select(this).attr("item"),this)});if("_icon" in o[i]){g.append("img").attr("src",o[i]._icon)}}}var m=l.append("p").attr("class","jsroot").style("margin-bottom","3px").style("margin-top",0);m.append("a").attr("class","h_button").text("open all").attr("title","open all items in the browser").on("click",k.toggleOpenState.bind(k,true));m.append("text").text(" | ");m.append("a").attr("class","h_button").text("close all").attr("title","close all items in the browser").on("click",k.toggleOpenState.bind(k,false));if("_online" in this.h){m.append("text").text(" | ");m.append("a").attr("class","h_button").text("reload").attr("title","reload object list from the server").on("click",k.reload.bind(k))}if("disp_kind" in this){m.append("text").text(" | ");m.append("a").attr("class","h_button").text("clear").attr("title","clear all drawn objects").on("click",k.clear.bind(k,false))}var f=l.append("div").attr("class","jsroot").style("font-size",this.with_icons?"12px":"15px").style("overflow","auto").style("flex","1");if(this.background){f.style("background-color",this.background).style("margin","2px").style("padding","2px")}this.addItemHtml(this.h,f.append("div").attr("class","h_tree"));if(e&&!this.status_disabled&&(a.GetUrlOption("nostatus")===null)){var j=a.findFunction(e._status);var r=(typeof j=="function")?this.CreateStatusLine("on"):null;if(r){j(r,this.itemFullName(e))}}a.CallBack(p)};a.HierarchyPainter.prototype.UpdateTreeNode=function(f,g){if((g===undefined)||g.empty()){g=b.select(f._d3cont?f._d3cont:null);var e=this.itemFullName(f);if(g.empty()){g=this.select_main().select("[item='"+e+"']")}if(g.empty()&&("_cycle" in f)){g=this.select_main().select("[item='"+e+";"+f._cycle+"']")}if(g.empty()){return}}this.addItemHtml(f,g,"update");if(this.browser_kind==="float"){this.AdjustFloatBrowserSize(null,true)}};a.HierarchyPainter.prototype.UpdateBackground=function(f,g){if(!f||!f._d3cont){return}var h=b.select(f._d3cont);if(h.empty()){return}var e=h.select(".h_item");e.style("background",f._background?f._background:null);if(g&&f._background){e.node().scrollIntoView(false)}};a.HierarchyPainter.prototype.tree_click=function(p,j){if(!p){return}var s=b.select(p.parentNode.parentNode);var l=s.attr("item");if(!l){return}var f=this.Find(l);if(!f){return}if(f._break_point){delete f._break_point;this.addItemHtml(f,s,"update");var r=f._parent,x=r._childs.indexOf(f),v=b.select(s.node().parentNode);if(x<0){return console.error("internal error")}r._show_limit=(r._show_limit||a.gStyle.HierarchyLimit)*2;for(var o=x+1;o<r._childs.length;++o){var u=r._childs[o];u._parent=r;if(!this.addItemHtml(u,v,o)){break}}return}var r=f,m=undefined;while(r){if((m=r._click_action)!==undefined){break}r=r._parent}if(!j||(j=="")){j="item"}var e=a.getDrawSettings(f._kind),t=e.handle;if(j=="icon"){var h=null;if(typeof f._icon_click=="function"){h=f._icon_click}else{if(t&&typeof t.icon_click=="function"){h=t.icon_click}}if(h&&h(f,this)){this.UpdateTreeNode(f,s)}return}if((j=="item")&&("_expand" in f)&&!b.event.ctrlKey&&!b.event.shiftKey){j="plusminus"}if(((j=="plusminus")&&!("_childs" in f)&&f._more)||((j=="item")&&(m==="expand"))){return this.expand(l,null,s)}if(j=="item"){if("_player" in f){return this.player(l)}if(t&&t.aslink){return window.open(l+"/")}if(t&&t.execute){return this.ExecuteCommand(l,p.parentNode)}if(t&&t.ignore_online&&this.isOnlineItem(f)){return}var g=f._can_draw,k=f._more,i=(this.default_by_click==="expand"),q="";if(b.event.shiftKey){q=(t&&t.shift)?t.shift:"inspect";if((q==="inspect")&&t&&t.noinspect){q=""}}if(t&&t.ctrl&&b.event.ctrlKey){q=t.ctrl}if(!q){for(var w=f._parent;w;w=w._parent){if(w._painter){g=false;if(k===undefined){k=false}break}}}if(f._childs){k=false}if(g===undefined){g=e.draw}if(k===undefined){k=e.expand}if(g&&k&&!q){if(i||(t&&(t.dflt==="expand"))){g=false}else{if(this.isItemDisplayed(l)){g=false}}}if(g){return this.display(l,q)}if(k||i){return this.expand(l,null,s)}if((typeof f._kind==="string")&&(f._kind.indexOf("ROOT.")===0)&&e.inspect&&(g!==false)){return this.display(l,"inspect")}if(!f._childs||(f===this.h)){return}}if(f._isopen){delete f._isopen}else{f._isopen=true}this.UpdateTreeNode(f,s)};a.HierarchyPainter.prototype.tree_mouseover=function(f,i){var j=b.select(i.parentNode.parentNode).attr("item");var g=this.Find(j);if(!g){return}var e,h=g;while(h&&!e){e=h._painter;h=h._parent}if(e&&typeof e.MouseOverHierarchy==="function"){e.MouseOverHierarchy(f,j,g)}};a.HierarchyPainter.prototype.direct_contextmenu=function(f){b.event.preventDefault();var g=b.select(f.parentNode.parentNode).attr("item");var e=this.Find(g);if(!e){return}if(typeof this.fill_context!=="function"){return}a.Painter.createMenu(this,function(h){h.painter.fill_context(h,e);if(h.size()>0){h.tree_node=f.parentNode;h.show(b.event)}})};a.HierarchyPainter.prototype.tree_contextmenu=function(g){b.event.preventDefault();var k=b.select(g.parentNode.parentNode).attr("item");var f=this.Find(k);if(!f){return}var e=this,j=e.GetOnlineProp(k),i=e.GetFileProp(k);function h(l){function n(o){return o.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")}var m=document.createElement("div");m.innerHTML='<a href="'+n(l)+'">x</a>';return m.firstChild.href}a.Painter.createMenu(e,function(n){if((k=="")&&!("_jsonfile" in f)){var s="",o=0;function p(){return o++>0?"&":"?"}var m=[];e.ForEachRootFile(function(u){m.push(u._file.fFullURL)});if(e.GetTopOnlineItem()==null){s=a.source_dir+"index.htm"}if(e.IsMonitoring()){s+=p()+"monitoring="+e.MonitoringInterval()}if(m.length==1){s+=p()+"file="+m[0]}else{if(m.length>1){s+=p()+"files="+JSON.stringify(m)}}if(e.disp_kind){s+=p()+"layout="+e.disp_kind.replace(/ /g,"")}var r=[];if(e.disp){e.disp.ForEachPainter(function(u){if(u.GetItemName()!=null){r.push(u.GetItemName())}})}if(r.length==1){s+=p()+"item="+r[0]}else{if(r.length>1){s+=p()+"items="+JSON.stringify(r)}}n.add("Direct link",function(){window.open(s)});n.add("Only items",function(){window.open(s+"&nobrowser")})}else{if(j!=null){e.FillOnlineMenu(n,j,k)}else{var q=a.getDrawSettings(f._kind,"nosame");if(f._can_draw){if(!q.opts){q.opts=[""]}if(q.opts.indexOf("")<0){q.opts.unshift("")}}if(q.opts){n.addDrawMenu("Draw",q.opts,function(u){this.display(k,u)})}if(i&&q.opts&&!i.localfile){var t=h(i.fileurl);if(t.indexOf(a.source_dir)==0){t=t.slice(a.source_dir.length)}t=i.kind+"="+t;if(i.itemname.length>0){var l=i.itemname;if(l.search(/\+| |\,/)>=0){l="'"+l+"'"}t+="&item="+l}n.addDrawMenu("Draw in new tab",q.opts,function(u){window.open(a.source_dir+"index.htm?nobrowser&"+t+"&opt="+u)})}if(q.expand&&!("_childs" in f)&&(f._more||!("_more" in f))){n.add("Expand",function(){e.expand(k)})}if(f._kind==="ROOT.TStyle"){n.add("Apply",function(){e.ApplyStyle(k)})}}}if(typeof f._menu=="function"){f._menu(n,f,e)}if(n.size()>0){n.tree_node=g.parentNode;if(n.separ){n.add("separator")}n.add("Close");n.show(b.event)}});return false};a.HierarchyPainter.prototype.CreateDisplay=function(e){if("disp" in this){if(this.disp.NumDraw()>0){return a.CallBack(e,this.disp)}this.disp.Reset();delete this.disp}if(document.getElementById(this.disp_frameid)==null){return a.CallBack(e,null)}if(this.disp_kind=="tabs"){this.disp=new a.TabsDisplay(this.disp_frameid)}else{if(this.disp_kind.indexOf("flex")==0){this.disp=new a.FlexibleDisplay(this.disp_frameid)}else{if(this.disp_kind.indexOf("coll")==0){this.disp=new a.CollapsibleDisplay(this.disp_frameid)}else{this.disp=new a.GridDisplay(this.disp_frameid,this.disp_kind)}}}if(this.disp){this.disp.CleanupFrame=this.CleanupFrame.bind(this)}a.CallBack(e,this.disp)};a.HierarchyPainter.prototype.enable_dragging=function(e,f){c(e).draggable({revert:"invalid",appendTo:"body",helper:"clone"})};a.HierarchyPainter.prototype.enable_dropping=function(f,g){var e=this;c(f).droppable({hoverClass:"ui-state-active",accept:function(j){var i=j.parent().parent().attr("item");if((i==g)||(i==null)){return false}var h=e.Find(i);if((h==null)||(!("_kind" in h))){return false}return h._kind.indexOf("ROOT.")==0},drop:function(i,j){var h=j.draggable.parent().parent().attr("item");if(h==null){return false}return e.dropitem(h,c(this).attr("id"))}})};a.HierarchyPainter.prototype.SetButtonsPosition=function(){if(!this.gui_div){return}var j=c("#"+this.gui_div+" .jsroot_browser"),i=7,h=7;if(this.browser_visible){var e=j.find(".jsroot_browser_area"),g=j.offset(),f=e.offset();i=f.top-g.top+7;h=f.left-g.left+e.innerWidth()-27}j.find(".jsroot_browser_btns").css("left",h+"px").css("top",i+"px")};a.HierarchyPainter.prototype.AdjustFloatBrowserSize=function(k,h){if(!k){if(!this.gui_div){return}k=c("#"+this.gui_div+" .jsroot_browser")}if(!k.length){return}var i=k.find(".jsroot_browser_area"),e=k.find(".jsroot_browser_hierarchy"),j=e.children(":first");if(h){if(i.parent().innerHeight()-10<i.innerHeight()){i.css("bottom","0px").css("top","0px")}return}if(!j.length){return}var g=e.innerHeight(),f=j.innerHeight();if((f!==undefined)&&(f<g*0.7)){i.css("bottom","")}};a.HierarchyPainter.prototype.ToggleBrowserKind=function(g){if(!this.gui_div){return}if(!g){if(!this.browser_kind){return}g=(this.browser_kind==="float")?"fix":"float"}var e=b.select("#"+this.gui_div+" .jsroot_browser"),j=c(e.node()),h=j.find(".jsroot_browser_area"),i=this;if(this.browser_kind==="float"){h.css("bottom","0px").css("top","0px").css("width","").css("height","").toggleClass("jsroot_float_browser",false).resizable("destroy").draggable("destroy")}else{if(this.browser_kind==="fix"){e.select(".jsroot_v_separator").remove();h.css("left","0px");b.select("#"+this.gui_div+"_drawing").style("left","0px");e.select(".jsroot_h_separator").style("left","0px");b.select("#"+this.gui_div+"_status").style("left","0px");this.CheckResize()}}this.browser_kind=g;this.browser_visible=true;if(g==="float"){h.css("bottom","40px").toggleClass("jsroot_float_browser",true).resizable({containment:"parent",minWidth:100,resize:function(k,l){i.SetButtonsPosition()},stop:function(l,m){var k=c(this).parent().innerHeight()-m.position.top-m.size.height;if(k<7){c(this).css("height","").css("bottom",0)}}}).draggable({containment:"parent",handle:c("#"+this.gui_div).find(".jsroot_browser_title"),snap:true,snapMode:"inner",snapTolerance:10,drag:function(k,l){i.SetButtonsPosition()},stop:function(l,m){var k=c(this).parent().innerHeight()-c(this).offset().top-c(this).outerHeight();if(k<7){c(this).css("height","").css("bottom",0)}}});this.AdjustFloatBrowserSize(j)}else{h.css("left",0).css("top",0).css("bottom",0).css("height","");var f=e.append("div").classed("jsroot_separator",true).classed("jsroot_v_separator",true).style("position","absolute").style("top",0).style("bottom",0);c(f.node()).draggable({axis:"x",cursor:"ew-resize",containment:"parent",helper:function(){return c(this).clone().css("background-color","grey")},drag:function(k,l){i.SetButtonsPosition();i.AdjustSeparator(l.position.left,null)},stop:function(k,l){i.CheckResize()}});this.AdjustSeparator(250,null,true,true)}this.SetButtonsPosition()};a.HierarchyPainter.prototype.ToggleBrowserVisisbility=function(){if(!this.gui_div||(typeof this.browser_visible==="string")){return}var i=b.select("#"+this.gui_div+" .jsroot_browser");var e=i.select(".jsroot_browser_area");if(e.empty()){return}var j=i.select(".jsroot_v_separator"),l=b.select("#"+this.gui_div+"_drawing"),h=e.property("last_left"),f=e.property("last_vsepar"),m=e.property("last_drawing");if(!this.browser_visible){e.property("last_left",null).property("last_vsepar",null).property("last_drawing",null)}else{e.property("last_left",e.style("left"));if(!j.empty()){e.property("last_vsepar",j.style("left"));e.property("last_drawing",l.style("left"))}h=(-c(e.node()).outerWidth(true)-10).toString()+"px";var k=c(i.node()).outerWidth(true);if(j.empty()&&(c(e.node()).offset().left>k/2)){h=(k+10)+"px"}f="-10px";m="0px"}var g=this,n=!this.browser_visible;this.browser_visible="changing";e.transition().style("left",h).duration(700).on("end",function(){g.browser_visible=n;if(n){g.SetButtonsPosition()}});if(!n){i.select(".jsroot_browser_btns").transition().style("left","7px").style("top","7px").duration(700)}if(!j.empty()){j.transition().style("left",f).duration(700);l.transition().style("left",m).duration(700).on("end",this.CheckResize.bind(this))}};a.HierarchyPainter.prototype.CreateBrowser=function(g,q,p){if(!this.gui_div||this.exclude_browser){return false}var t=b.select("#"+this.gui_div+" .jsroot_browser"),l=c(t.node());if(t.empty()){return false}if((g==="float")&&this.float_browser_disabled){g="fix"}if(!t.select(".jsroot_browser_area").empty()){if(q&&(this.browser_visible!=="changing")){if(g===this.browser_kind){this.ToggleBrowserVisisbility()}else{this.ToggleBrowserKind(g)}}a.CallBack(p);return true}var m="<div style='overflow:hidden'><p class=\"jsroot_browser_title\"></p><p class='jsroot_browser_version'><a href='https://root.cern/js/'>JSROOT</a> version <span style='color:green'><b>"+a.version+"</b></span></p>";if(this.is_online){m+='<p> Hierarchy in <a href="h.json">json</a> and <a href="h.xml">xml</a> format</p><div style="display:flex;flex-direction:row;"><label style="margin-right:5px; vertical-align:middle;"><input style="vertical-align:middle;" type="checkbox" name="monitoring" class="gui_monitoring"/>Monitoring</label>'}else{if(!this.no_select){var h=b.select("#"+this.gui_div),f=h.attr("files")||"../files/hsimple.root",w=a.GetUrlOption("path")||h.attr("path")||"",o=f.split(";");m+='<input type="text" value="" style="width:95%; margin:5px;border:2px;" class="gui_urlToLoad" title="input file name"/><div style="display:flex;flex-direction:row;padding-top:5px"><select class="gui_selectFileName" style="flex:1;padding:2px;" title="select file name"<option value="" selected="selected"></option>';for(var v in o){m+='<option value = "'+w+o[v]+'">'+o[v]+"</option>"}m+='</select><input type="file" class="gui_localFile" accept=".root" style="display:none"/><output id="list" style="display:none"></output><input type="button" value="..." class="gui_fileBtn" style="min-width:3em;padding:3px;margin-left:5px;margin-right:5px;" title="select local file for reading"/><br/></div><p id="gui_fileCORS"><small><a href="https://github.com/root-project/jsroot/blob/master/docs/JSROOT.md#reading-root-files-from-other-servers">Read docu</a> how to open files from other servers.</small></p><div style="display:flex;flex-direction:row"><input style="padding:3px;margin-right:5px;"       class="gui_ReadFileBtn" type="button" title="Read the Selected File" value="Load"/><input style="padding:3px;margin-right:5px;"       class="gui_ResetUIBtn" type="button" title="Close all opened files and clear drawings" value="Reset"/>'}else{if(this.no_select=="file"){m+='<div style="display:flex;flex-direction:row">'}}}if(this.is_online||!this.no_select||this.no_select=="file"){m+='<select style="padding:2px;margin-right:5px;" title="layout kind" class="gui_layout"></select></div>'}m+="</div>";m+='<div id="'+this.gui_div+'_browser_hierarchy" class="jsroot_browser_hierarchy"></div>';t.insert("div",".jsroot_browser_btns").classed("jsroot_browser_area",true).style("position","absolute").style("left",0).style("top",0).style("bottom",0).style("width","250px").style("padding-left","5px").style("display","flex").style("flex-direction","column").html(m);t.select(".jsroot_browser_title").text(this.is_online?"ROOT online server":"Read a ROOT file");var n=this,s=null;if(!this.is_online&&!this.no_select){this.ReadSelectedFile=function(){var i=t.select(".gui_urlToLoad").property("value").trim();if(!i){return}if((i.toLowerCase().lastIndexOf(".json")==i.length-5)){this.OpenJsonFile(i)}else{this.OpenRootFile(i)}};l.find(".gui_selectFileName").val("").change(function(){l.find(".gui_urlToLoad").val(c(this).val())});l.find(".gui_fileBtn").button().click(function(){l.find(".gui_localFile").click()});l.find(".gui_ReadFileBtn").button().click(function(){n.ReadSelectedFile()});l.find(".gui_ResetUIBtn").button().click(function(){n.clear(true)});l.find(".gui_urlToLoad").keyup(function(i){if(i.keyCode==13){n.ReadSelectedFile()}});l.find(".gui_localFile").change(function(y){var i=y.target.files;for(var x=0;x<i.length;++x){var k=i[x];t.select(".gui_urlToLoad").property("value",k.name);if(n){n.OpenRootFile(k,s)}}s=null});this.SelectLocalFile=function(i){s=i;c("#"+this.gui_div+" .jsroot_browser").find(".gui_localFile").click()}}var e=l.find(".gui_layout");if(e.length){var u=["simple","vert2","vert3","vert231","horiz2","horiz32","flex","grid 2x2","grid 1x3","grid 2x3","grid 3x3","grid 4x4","collapsible","tabs"];for(var r=0;r<u.length;++r){var j=document.createElement("option");j.value=u[r];j.innerHTML=u[r];e.get(0).appendChild(j)}e.change(function(){n.SetDisplay(c(this).val()||"collapsible",n.gui_div+"_drawing")})}this.SetDivId(this.gui_div+"_browser_hierarchy");if(q){this.RefreshHtml();this.InitializeBrowser()}this.ToggleBrowserKind(g||"fix");a.CallBack(p);return true};a.HierarchyPainter.prototype.InitializeBrowser=function(){var j=b.select("#"+this.gui_div+" .jsroot_browser");if(j.empty()){return}var e=c(j.node()),h=this;if(this.browser_kind==="float"){this.AdjustFloatBrowserSize(e)}var l=j.select(".gui_layout").node();if(l){var m=false;for(var k in l.options){var n=l.options[k].text;if(typeof n!=="string"){continue}if((n==this.GetLayout())||(n.replace(/ /g,"")==this.GetLayout())){l.selectedIndex=k;m=true;break}}if(!m){var f=document.createElement("option");f.innerHTML=f.value=this.GetLayout();l.appendChild(f);l.selectedIndex=l.options.length-1}}if(this.is_online){if(this.h&&this.h._toptitle){j.select(".jsroot_browser_title").text(this.h._toptitle)}e.find(".gui_monitoring").prop("checked",this.IsMonitoring()).click(function(){h.EnableMonitoring(this.checked);h.updateAll(!this.checked)})}else{if(!this.no_select){var g="";this.ForEachRootFile(function(i){if(!g){g=i._fullurl}});e.find(".gui_urlToLoad").val(g)}}};a.HierarchyPainter.prototype.CreateStatusLine=function(o,n){if(this.status_disabled||!this.gui_div){return""}var j=b.select("#"+this.gui_div+" .jsroot_browser");if(j.empty()){return""}var e=this.gui_div+"_status",p=b.select("#"+e),f;if(!p.empty()){if(this.status_layout==="app"){return !n?e:false}f=j.select(".jsroot_h_separator");c(f.node()).draggable("destroy");f.remove();p.remove();delete this.status_layout;if(this.status_handler&&(a.Painter.ShowStatus===this.status_handler)){delete a.Painter.ShowStatus;delete this.status_handler}this.AdjustSeparator(null,0,true);return""}var m=b.select("#"+this.gui_div+"_drawing").style("left");p=j.insert("div",".jsroot_browser_area").attr("id",e).classed("jsroot_status_area",true).style("position","absolute").style("left",m).style("height","20px").style("bottom",0).style("right",0).style("margin",0).style("border",0);f=j.insert("div",".jsroot_browser_area").classed("jsroot_separator",true).classed("jsroot_h_separator",true).style("position","absolute").style("left",m).style("right",0).style("bottom","20px").style("height","5px");var g=this;c(f.node()).draggable({axis:"y",cursor:"ns-resize",containment:"parent",helper:function(){return c(this).clone().css("background-color","grey")},drag:function(k,q){g.AdjustSeparator(null,-q.position.top)},stop:function(k,q){g.CheckResize()}});if(!o||(typeof o==="string")){o=this.last_hsepar_height||20}var l=(n==="toggle")&&(o===this.last_hsepar_height);this.AdjustSeparator(null,o,true);if(!n){this.status_layout="app";return e}this.status_layout=new a.GridDisplay(e,"horizx4_1213");if(l){this.status_layout.first_check=true}var h=["object name","object title","mouse coordiantes","object info"];for(var i=0;i<4;++i){b.select(this.status_layout.GetFrame(i)).attr("title",h[i]).style("overflow","hidden").append("label").attr("class","jsroot_status_label")}this.status_handler=this.ShowStatus.bind(this);a.Painter.ShowStatus=this.status_handler;return true};a.HierarchyPainter.prototype.ShowStatus=function(f,i,g,h){if(!this.status_layout){return}c(this.status_layout.GetFrame(0)).children("label").text(f||"");c(this.status_layout.GetFrame(1)).children("label").text(i||"");c(this.status_layout.GetFrame(2)).children("label").text(h||"");c(this.status_layout.GetFrame(3)).children("label").text(g||"");if(!this.status_layout.first_check){this.status_layout.first_check=true;var e=0;for(var j=0;j<4;++j){e=Math.max(e,c(this.status_layout.GetFrame(j)).children("label").outerHeight())}if((e>5)&&((e>this.last_hsepar_height)||(e<this.last_hsepar_height+5))){this.AdjustSeparator(null,e,true)}}};a.HierarchyPainter.prototype.AdjustSeparator=function(g,h,l,k){if(!this.gui_div){return}var e=b.select("#"+this.gui_div+" .jsroot_browser"),f=5;if((h===null)&&k&&!e.select(".jsroot_h_separator").empty()){h=e.select(".jsroot_h_separator").style("bottom");if((typeof h=="string")&&(h.indexOf("px")==h.length-2)){h=h.substr(0,h.length-2)}else{h=null}}if(h!==null){h=parseInt(h);var i=e.select(".jsroot_h_separator"),j=0;if(!i.empty()){if(h<0){h+=(c(e.node()).outerHeight(true)-f)}if(h<5){h=5}this.last_hsepar_height=h;i.style("bottom",h+"px").style("height",f+"px");b.select("#"+this.gui_div+"_status").style("height",h+"px");j=(h+f)+"px"}b.select("#"+this.gui_div+"_drawing").style("bottom",j)}if(g!==null){g=parseInt(g);if(g<50){g=50}e.select(".jsroot_browser_area").style("width",(g-5)+"px");b.select("#"+this.gui_div+"_drawing").style("left",(g+f)+"px");e.select(".jsroot_h_separator").style("left",(g+f)+"px");b.select("#"+this.gui_div+"_status").style("left",(g+f)+"px");e.select(".jsroot_v_separator").style("left",g+"px").style("width",f+"px")}if(l){this.CheckResize()}};a.BuildGUI=function(){var e=b.select("#simpleGUI"),f=false;if(e.empty()){e=b.select("#onlineGUI");if(e.empty()){return alert("no div for gui found")}f=true}if(e.attr("ignoreurl")==="true"){a.gStyle.IgnoreUrlOptions=true}if((a.GetUrlOption("nobrowser")!==null)||(e.attr("nobrowser")&&e.attr("nobrowser")!=="false")){return a.BuildNobrowserGUI()}a.Painter.readStyleFromURL();var g=new a.HierarchyPainter("root",null);g.is_online=f;g.StartGUI(e,g.InitializeBrowser.bind(g))};a.CollapsibleDisplay=function(e){a.MDIDisplay.call(this,e);this.cnt=0};a.CollapsibleDisplay.prototype=Object.create(a.MDIDisplay.prototype);a.CollapsibleDisplay.prototype.ForEachFrame=function(f,g){var e=this.frameid+"_collapsible";if(document.getElementById(e)==null){return}if(typeof f!="function"){return}c("#"+e+" .collapsible_draw").each(function(){if(g&&c(this).is(":hidden")){return}f(c(this).get(0))})};a.CollapsibleDisplay.prototype.GetActiveFrame=function(){var e=a.MDIDisplay.prototype.GetActiveFrame.call(this);if(e&&!c(e).is(":hidden")){return e}e=null;this.ForEachFrame(function(f){if(!e){e=f}},true);return e};a.CollapsibleDisplay.prototype.ActivateFrame=function(e){if(c(e).is(":hidden")){c(e).prev().toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideDown(0)}c(e).prev()[0].scrollIntoView();this.active_frame_title=b.select(e).attr("frame_title")};a.CollapsibleDisplay.prototype.CreateFrame=function(i){this.BeforeCreateFrame(i);var g=this.frameid+"_collapsible";if(document.getElementById(g)==null){c("#"+this.frameid).append('<div id="'+g+'" class="jsroot ui-accordion ui-accordion-icons ui-widget ui-helper-reset" style="overflow:auto; overflow-y:scroll; height:100%; padding-left: 2px; padding-right: 2px"></div>')}var j=this,f=g+"_sub"+this.cnt++,h=f+"h",e='<h5 id="'+h+"\"><span class='ui-icon ui-icon-triangle-1-e'></span><a> "+i+"</a>&nbsp; <button type='button' class='jsroot_collaps_closebtn' style='float:right; width:1.4em' title='close canvas'/> </h5>\n<div class='collapsible_draw' id='"+f+"'></div>\n";c("#"+g).append(e);c("#"+h).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){c(this).toggleClass("ui-state-hover")}).click(function(){c(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);var l=c(this).next(),k=l.is(":hidden");l.attr("frame_active",k?"false":"true").css("display",k?"none":"");if(!k){a.resize(l.attr("id"))}}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();c("#"+h).find(" .jsroot_collaps_closebtn").button({icons:{primary:"ui-icon-close"},text:false}).click(function(){j.CleanupFrame(c(this).parent().next().attr("id"));c(this).parent().next().remove();c(this).parent().remove()});c("#"+h).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(0);return c("#"+f).attr("frame_title",i).css("overflow","hidden").attr("can_resize","height").css("position","relative").get(0)};a.TabsDisplay=function(e){a.MDIDisplay.call(this,e);this.cnt=0};a.TabsDisplay.prototype=Object.create(a.MDIDisplay.prototype);a.TabsDisplay.prototype.ForEachFrame=function(f,i){var e=this.frameid+"_tabs";if(document.getElementById(e)==null){return}if(typeof f!="function"){return}var g=-1;var h=c("#"+e).tabs("option","active");c("#"+e+"> .tabs_draw").each(function(){g++;if(!i||(g==h)){f(c(this).get(0))}})};a.TabsDisplay.prototype.GetActiveFrame=function(){var e=null;this.ForEachFrame(function(f){if(!e){e=f}},true);return e};a.TabsDisplay.prototype.ActivateFrame=function(f){var e=0,g=-1;this.ForEachFrame(function(h){if(c(h).attr("id")==c(f).attr("id")){g=e}e++});c("#"+this.frameid+"_tabs").tabs("option","active",g);this.active_frame_title=b.select(f).attr("frame_title")};a.TabsDisplay.prototype.CreateFrame=function(j){this.BeforeCreateFrame(j);var k=this,h=this.frameid+"_tabs",g=h+"_sub"+this.cnt++,f='<li><a href="#'+g+'">'+j+'</a><span class="ui-icon ui-icon-close" style="float: left; margin: 0.4em 0.2em 0 0; cursor: pointer;" role="presentation">Remove Tab</span></li>',e='<div class="tabs_draw" id="'+g+'"></div>';if(document.getElementById(h)==null){c("#"+this.frameid).append('<div id="'+h+'" class="jsroot"> <ul>'+f+" </ul>"+e+"</div>");var i=c("#"+h).css("overflow","hidden").tabs({heightStyle:"fill",activate:function(l,m){console.log("tabs activate");c(m.oldPanel).attr("frame_active","false");c(m.newPanel).css("overflow","hidden").attr("frame_active","true");a.resize(c(m.newPanel).attr("id"))}});i.delegate("span.ui-icon-close","click",function(){var l=c(this).closest("li").remove().attr("aria-controls");k.CleanupFrame(l);c("#"+l).remove();i.tabs("refresh");if(c("#"+h+"> .tabs_draw").length==0){c("#"+h).remove()}})}else{c("#"+h).find("> .ui-tabs-nav").append(f);c("#"+h).append(e);c("#"+h).tabs("refresh");c("#"+h).tabs("option","active",-1)}c("#"+g).empty().css("overflow","hidden").attr("frame_active","true").attr("frame_title",j);return c("#"+g).get(0)};a.TabsDisplay.prototype.CheckMDIResize=function(f,e){c("#"+this.frameid+"_tabs").tabs("refresh");a.MDIDisplay.prototype.CheckMDIResize.call(this,f,e)};a.FlexibleDisplay=function(e){a.MDIDisplay.call(this,e);this.cnt=0};a.FlexibleDisplay.prototype=Object.create(a.MDIDisplay.prototype);a.FlexibleDisplay.prototype.ForEachFrame=function(f,g){var e=this.frameid+"_flex";if(document.getElementById(e)==null){return}if(typeof f!="function"){return}c("#"+e+" .flex_draw").each(function(){if(g&&c(this).is(":hidden")){return}f(c(this).get(0))})};a.FlexibleDisplay.prototype.GetActiveFrame=function(){var e=a.MDIDisplay.prototype.GetActiveFrame.call(this);if(e&&!c(e).is(":hidden")){return e}e=null;this.ForEachFrame(function(f){if(!e){e=f}},true);return e};a.FlexibleDisplay.prototype.ActivateFrame=function(e){this.active_frame_title=b.select(e).attr("frame_title")};a.FlexibleDisplay.prototype.CreateFrame=function(j){this.BeforeCreateFrame(j);var f=this.frameid+"_flex";if(document.getElementById(f)==null){c("#"+this.frameid).append('<div id="'+f+'" class="jsroot" style="overflow:none; height:100%; width:100%"></div>')}var e=this,i=c("#"+f),m=i.width(),g=i.height(),n=f+"_frame"+this.cnt;var l='<div id="'+n+'" class="flex_frame" style="position:absolute"><div class="ui-widget-header flex_header"><p>'+j+'</p><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/><button type="button" style="float:right; width:1.4em"/></div><div id="'+n+'_cont" class="flex_draw"></div></div>';i.append(l);function k(h,o){var p=h.prop("state");if(!p){p="normal"}h.prop("state",o);if(o==p){return}if(p=="normal"){h.prop("original_height",h.height());h.prop("original_width",h.width());h.prop("original_top",h.css("top"));h.prop("original_left",h.css("left"))}h.find(".jsroot_minbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-s",o!="minimal").toggleClass("ui-icon-triangle-2-n-s",o=="minimal");h.find(".jsroot_maxbutton").find(".ui-icon").toggleClass("ui-icon-triangle-1-n",o!="maximal").toggleClass("ui-icon-triangle-2-n-s",o=="maximal");switch(o){case"minimal":h.height(h.find(".flex_header").height()).width("auto");h.find(".flex_draw").css("display","none");h.find(".ui-resizable-handle").css("display","none");break;case"maximal":h.height("100%").width("100%").css("left","").css("top","");h.find(".flex_draw").css("display","");h.find(".ui-resizable-handle").css("display","none");break;default:h.find(".flex_draw").css("display","");h.find(".ui-resizable-handle").css("display","");h.height(h.prop("original_height")).width(h.prop("original_width"));if(p!="minimal"){h.css("left",h.prop("original_left")).css("top",h.prop("original_top"))}}h.find(".flex_draw").attr("frame_active",o!=="minimal"?"true":"false");if(o!=="minimal"){a.resize(h.find(".flex_draw").get(0))}}c("#"+n).css("left",parseInt(m*(this.cnt%5)/10)).css("top",parseInt(g*(this.cnt%5)/10)).width(Math.round(m*0.58)).height(Math.round(g*0.58)).resizable({helper:"jsroot-flex-resizable-helper",start:function(h,o){c(this).appendTo(c(this).parent())},stop:function(o,p){var h={width:p.size.width-1,height:p.size.height-c(this).find(".flex_header").height()-1};a.resize(c(this).find(".flex_draw").get(0),h)}}).draggable({containment:"parent",start:function(o,q){c(this).appendTo(c(this).parent());var p=c(this).find(".flex_draw");var r=document.elementFromPoint(o.clientX,o.clientY);var h=false;c(r).parents().map(function(){if(c(this).get(0)===p.get(0)){h=true}});if(h){return false}}}).find(".flex_header").click(function(){var h=c(this).parent();h.appendTo(h.parent())}).find("button").first().attr("title","close canvas").button({icons:{primary:"ui-icon-close"},text:false}).click(function(){var h=c(this).parent().parent();e.CleanupFrame(h.find(".flex_draw").get(0));h.remove()}).next().attr("title","maximize canvas").addClass("jsroot_maxbutton").button({icons:{primary:"ui-icon-triangle-1-n"},text:false}).click(function(){var h=c(this).parent().parent();var o=c(this).find(".ui-icon").hasClass("ui-icon-triangle-1-n");k(h,o?"maximal":"normal")}).next().attr("title","minimize canvas").addClass("jsroot_minbutton").button({icons:{primary:"ui-icon-triangle-1-s"},text:false}).click(function(){var h=c(this).parent().parent();var o=c(this).find(".ui-icon").hasClass("ui-icon-triangle-1-s");k(h,o?"minimal":"normal")});c("#"+n).find(".ui-resizable-handle").css("z-index","");this.cnt++;return c("#"+n+"_cont").attr("frame_title",j).get(0)};a.GridDisplay.prototype.CreateSeparator=function(g,e,h){var f=c(e.append("div").node());f.toggleClass("jsroot_separator",true).toggleClass(g.vertical?"jsroot_hline":"jsroot_vline",true).prop("handle",g).attr("separator-id",h.id).css("position","absolute").css(g.vertical?"top":"left","calc("+h.position+"% - 2px)").css(g.vertical?"width":"height",(g.size||100)+"%").css(g.vertical?"height":"width","5px").css("cursor",g.vertical?"ns-resize":"ew-resize");f.bind("changePosition",function(m,j){var k=c(this).prop("handle"),o=parseInt(c(this).attr("separator-id")),n=k.groups[o].position;if(j==="restore"){n=k.groups[o].position0}else{if(j&&j.offset){if(k.vertical){n=Math.round((j.offset.top+2-c(this).parent().offset().top)/c(this).parent().innerHeight()*100)}else{n=Math.round((j.offset.left+2-c(this).parent().offset().left)/c(this).parent().innerWidth()*100)}}}var l=k.groups[o].position-n;if(Math.abs(l)<0.3){return}if(Math.min(k.groups[o-1].size-l,k.groups[o].size+l)<5){return}k.groups[o-1].size-=l;k.groups[o].size+=l;k.groups[o].position=n;function i(s,r){var p=k.vertical?"height":"width",q=k.groups[r].size+"%";s.children("[groupid='"+r+"']").css(p,q).children(".jsroot_separator").css(p,q)}c(this).css(k.vertical?"top":"left","calc("+n+"% - 2px)");i(c(this).parent(),o-1);i(c(this).parent(),o);if(j==="restore"){c(this).trigger("resizeGroup",o-1);c(this).trigger("resizeGroup",o)}});f.bind("resizeGroup",function(k,i){var j=c(this).parent().children("[groupid='"+i+"']");if(!j.hasClass("jsroot_newgrid")){j=j.find(".jsroot_newgrid")}j.each(function(){a.resize(c(this).get(0))})});f.dblclick(function(){c(this).trigger("changePosition","restore")});f.draggable({axis:g.vertical?"y":"x",cursor:g.vertical?"ns-resize":"ew-resize",containment:"parent",helper:function(){return c(this).clone().css("background-color","grey")},start:function(i,k){var j=c(this).prop("handle"),l=parseInt(c(this).attr("separator-id"));j.groups[l].startpos=j.groups[l].position},drag:function(i,j){c(this).trigger("changePosition",j)},stop:function(i,k){var j=c(this).prop("handle"),l=parseInt(c(this).attr("separator-id"));if(Math.abs(j.groups[l].startpos-j.groups[l].position)<0.5){return}c(this).trigger("resizeGroup",l-1);c(this).trigger("resizeGroup",l)}})};a.CreateTreePlayer=function(e){e.draw_first=true;e.ConfigureOnline=function(i,g,h,f){this.SetItemName(i,"",this);this.url=g;this.root_version=f;this.askey=h};e.ConfigureTree=function(f){this.local_tree=f};e.KeyUp=function(f){if(f.keyCode==13){this.PerformDraw()}};e.ShowExtraButtons=function(h){var f=c("#"+this.divid);f.find(".treedraw_buttons").append(" Cut: <input class='treedraw_cut ui-corner-all ui-widget' style='width:8em;margin-left:5px' title='cut expression'></input> Opt: <input class='treedraw_opt ui-corner-all ui-widget' style='width:5em;margin-left:5px' title='histogram draw options'></input> Num: <input class='treedraw_number' style='width:7em;margin-left:5px' title='number of entries to process (default all)'></input> First: <input class='treedraw_first' style='width:7em;margin-left:5px' title='first entry to process (default first)'></input> <button class='treedraw_clear' title='Clear drawing'>Clear</button>");var i=1000,g=undefined,j=this;if(this.local_tree){g=this.local_tree.fEntries||0}f.find(".treedraw_cut").val(h&&h.parse_cut?h.parse_cut:"").keyup(this.keyup);f.find(".treedraw_opt").val(h&&h.drawopt?h.drawopt:"").keyup(this.keyup);f.find(".treedraw_number").val(h&&h.numentries?h.numentries:"").spinner({numberFormat:"n",min:0,page:1000,max:g}).keyup(this.keyup);f.find(".treedraw_first").val(h&&h.firstentry?h.firstentry:"").spinner({numberFormat:"n",min:0,page:1000,max:g}).keyup(this.keyup);f.find(".treedraw_clear").button().click(function(){a.cleanup(j.drawid)})};e.Show=function(j,g){this.drawid=j+"_draw";this.keyup=this.KeyUp.bind(this);var h=g&&(g.parse_cut||g.numentries||g.firstentry);var f=c("#"+j);f.html("<div class='treedraw_buttons' style='padding-left:0.5em'><button class='treedraw_exe' title='Execute draw expression'>Draw</button> Expr:<input class='treedraw_varexp ui-corner-all ui-widget' style='width:12em;margin-left:5px' title='draw expression'></input> "+(h?"":"<button class='treedraw_more'>More</button>")+"</div><hr/><div id='"+this.drawid+"' style='width:100%'></div>");this.SetDivId(j);var i=this;if(this.local_tree){f.find(".treedraw_buttons").attr("title","Tree draw player for: "+this.local_tree.fName)}f.find(".treedraw_exe").button().click(function(){i.PerformDraw()});f.find(".treedraw_varexp").val(g&&g.parse_expr?g.parse_expr:"px:py").keyup(this.keyup);if(h){this.ShowExtraButtons(g)}else{f.find(".treedraw_more").button().click(function(){c(this).remove();i.ShowExtraButtons()})}this.CheckResize()};e.PerformLocalDraw=function(){if(!this.local_tree){return}var h=c(this.select_main().node());var f={expr:h.find(".treedraw_varexp").val()};if(h.find(".treedraw_more").length==0){f.cut=h.find(".treedraw_cut").val();if(!f.cut){delete f.cut}f.drawopt=h.find(".treedraw_opt").val();if(f.drawopt==="dump"){f.dump=true;f.drawopt=""}if(!f.drawopt){delete f.drawopt}f.numentries=parseInt(h.find(".treedraw_number").val());if(isNaN(f.numentries)){delete f.numentries}f.firstentry=parseInt(h.find(".treedraw_first").val());if(isNaN(f.firstentry)){delete f.firstentry}}var g=this;if(f.drawopt){a.cleanup(g.drawid)}g.local_tree.Draw(f,function(j,i,k){a.redraw(g.drawid,j,i)})};e.PerformDraw=function(){if(this.local_tree){return this.PerformLocalDraw()}var h=c(this.select_main().node());var g=this.url+"/exe.json.gz?compact=3&method=Draw",p=h.find(".treedraw_varexp").val(),f="h_tree_draw",i="",m=p.indexOf(">>");if(m<0){p+=">>"+f}else{f=p.substr(m+2);if(f[0]=="+"){f=f.substr(1)}var n=f.indexOf("(");if(n>0){f=f.substr(0,n)}}if(h.find(".treedraw_more").length==0){var o=h.find(".treedraw_cut").val(),l=h.find(".treedraw_number").val(),k=h.find(".treedraw_first").val();i=h.find(".treedraw_opt").val();g+='&prototype="const char*,const char*,Option_t*,Long64_t,Long64_t"&varexp="'+p+'"&selection="'+o+'"';if(l==""){l=(this.root_version>=394499)?"TTree::kMaxEntries":"1000000000"}if(k==""){k="0"}g+='&option="'+i+'"&nentries='+l+"&firstentry="+k}else{g+='&prototype="Option_t*"&opt="'+p+'"'}g+="&_ret_object_="+f;var q=this;function j(){a.NewHttpRequest(g,"object",function(r){if(r==null){return}a.cleanup(q.drawid);a.draw(q.drawid,r,i)}).send()}if(this.askey){this.askey=false;a.NewHttpRequest(this.url+"/root.json","text",j).send()}else{j()}};e.CheckResize=function(g){var f=c(this.select_main().node());c("#"+this.drawid).width(f.width());var k=f.height(),j=f.find(".treedraw_buttons").outerHeight(true),i=f.find("hr").outerHeight(true);c("#"+this.drawid).height(k-j-i-2);a.resize(this.drawid)};return e};a.drawTreePlayer=function(h,k,j){var e=h.GetOnlineItemUrl(k);if(!e){return null}var m=h.GetTopOnlineItem(h.Find(k));if(!m){return null}var f=("_root_version" in m)?m._root_version:336417;var i=h.GetDisplay();if(i==null){return null}var g=i.FindFrame(k,true);if(g==null){return null}var l=b.select(g).attr("id");var n=new a.TBasePainter();a.CreateTreePlayer(n);n.ConfigureOnline(k,e,j,f);n.Show(l);return n};a.drawTreePlayerKey=function(e,f){return a.drawTreePlayer(e,f,true)};a.Painter.ConfigureVSeparator=function(e){};a.Painter.AdjustLayout=function(g,e,f){if(a.hpainter){a.hpainter.AdjustSeparator(g,e,true)}};a.Painter.ConfigureHSeparator=function(e){if(!a.hpainter){return""}return a.hpainter.CreateStatusLine(e)};return a.Painter}));